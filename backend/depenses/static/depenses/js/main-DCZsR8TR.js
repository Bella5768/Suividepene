import{r as e,b as t,a as r,u as s,L as n,O as a,N as i,c as o,d as l,B as d,e as c,f as u}from"./vendor-BXX24kVF.js";import{u as m,a as p,b as h,Q as f,c as x}from"./forms-BCkRIklq.js";import"./charts-AGzJhYYi.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var g={exports:{}},v={},j=e,b=Symbol.for("react.element"),y=Symbol.for("react.fragment"),N=Object.prototype.hasOwnProperty,w=j.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,_={key:!0,ref:!0,__self:!0,__source:!0};function C(e,t,r){var s,n={},a=null,i=null;for(s in void 0!==r&&(a=""+r),void 0!==t.key&&(a=""+t.key),void 0!==t.ref&&(i=t.ref),t)N.call(t,s)&&!_.hasOwnProperty(s)&&(n[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps)void 0===n[s]&&(n[s]=t[s]);return{$$typeof:b,type:e,key:a,ref:i,props:n,_owner:w.current}}v.Fragment=y,v.jsx=C,v.jsxs=C,g.exports=v;var S=g.exports,E={},T=t;function k(e){var t,r,s="";if("string"==typeof e||"number"==typeof e)s+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(r=k(e[t]))&&(s&&(s+=" "),s+=r);else for(t in e)e[t]&&(s&&(s+=" "),s+=t);return s}function A(){for(var e,t,r=0,s="";r<arguments.length;)(e=arguments[r++])&&(t=k(e))&&(s&&(s+=" "),s+=t);return s}E.createRoot=T.createRoot,E.hydrateRoot=T.hydrateRoot;const R=e=>"number"==typeof e&&!isNaN(e),O=e=>"string"==typeof e,M=e=>"function"==typeof e,D=e=>O(e)||M(e)?e:null,P=t=>e.isValidElement(t)||O(t)||M(t)||R(t);function L(t){let{enter:s,exit:n,appendPosition:a=!1,collapse:i=!0,collapseDuration:o=300}=t;return function(t){let{children:l,position:d,preventExitTransition:c,done:u,nodeRef:m,isIn:p}=t;const h=a?`${s}--${d}`:s,f=a?`${n}--${d}`:n,x=e.useRef(0);return e.useLayoutEffect(()=>{const e=m.current,t=h.split(" "),r=s=>{s.target===m.current&&(e.dispatchEvent(new Event("d")),e.removeEventListener("animationend",r),e.removeEventListener("animationcancel",r),0===x.current&&"animationcancel"!==s.type&&e.classList.remove(...t))};e.classList.add(...t),e.addEventListener("animationend",r),e.addEventListener("animationcancel",r)},[]),e.useEffect(()=>{const e=m.current,t=()=>{e.removeEventListener("animationend",t),i?function(e,t,r){void 0===r&&(r=300);const{scrollHeight:s,style:n}=e;requestAnimationFrame(()=>{n.minHeight="initial",n.height=s+"px",n.transition=`all ${r}ms`,requestAnimationFrame(()=>{n.height="0",n.padding="0",n.margin="0",setTimeout(t,r)})})}(e,u,o):u()};p||(c?t():(x.current=1,e.className+=` ${f}`,e.addEventListener("animationend",t)))},[p]),r.createElement(r.Fragment,null,l)}}function U(e,t){return null!=e?{content:e.content,containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,status:t}:{}}const I={list:new Map,emitQueue:new Map,on(e,t){return this.list.has(e)||this.list.set(e,[]),this.list.get(e).push(t),this},off(e,t){if(t){const r=this.list.get(e).filter(e=>e!==t);return this.list.set(e,r),this}return this.list.delete(e),this},cancelEmit(e){const t=this.emitQueue.get(e);return t&&(t.forEach(clearTimeout),this.emitQueue.delete(e)),this},emit(e){this.list.has(e)&&this.list.get(e).forEach(t=>{const r=setTimeout(()=>{t(...[].slice.call(arguments,1))},0);this.emitQueue.has(e)||this.emitQueue.set(e,[]),this.emitQueue.get(e).push(r)})}},z=e=>{let{theme:t,type:s,...n}=e;return r.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:"colored"===t?"currentColor":`var(--toastify-icon-color-${s})`,...n})},B={info:function(e){return r.createElement(z,{...e},r.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(e){return r.createElement(z,{...e},r.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(e){return r.createElement(z,{...e},r.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(e){return r.createElement(z,{...e},r.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return r.createElement("div",{className:"Toastify__spinner"})}};function F(e){return e.targetTouches&&e.targetTouches.length>=1?e.targetTouches[0].clientX:e.clientX}function q(e){return e.targetTouches&&e.targetTouches.length>=1?e.targetTouches[0].clientY:e.clientY}function W(e){let{closeToast:t,theme:s,ariaLabel:n="close"}=e;return r.createElement("button",{className:`Toastify__close-button Toastify__close-button--${s}`,type:"button",onClick:e=>{e.stopPropagation(),t(e)},"aria-label":n},r.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},r.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function $(e){let{delay:t,isRunning:s,closeToast:n,type:a="default",hide:i,className:o,style:l,controlledProgress:d,progress:c,rtl:u,isIn:m,theme:p}=e;const h=i||d&&0===c,f={...l,animationDuration:`${t}ms`,animationPlayState:s?"running":"paused",opacity:h?0:1};d&&(f.transform=`scaleX(${c})`);const x=A("Toastify__progress-bar",d?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${p}`,`Toastify__progress-bar--${a}`,{"Toastify__progress-bar--rtl":u}),g=M(o)?o({rtl:u,type:a,defaultClassName:x}):A(x,o);return r.createElement("div",{role:"progressbar","aria-hidden":h?"true":"false","aria-label":"notification timer",className:g,style:f,[d&&c>=1?"onTransitionEnd":"onAnimationEnd"]:d&&c<1?null:()=>{m&&n()}})}const V=t=>{const{isRunning:s,preventExitTransition:n,toastRef:a,eventHandlers:i}=function(t){const[r,s]=e.useState(!1),[n,a]=e.useState(!1),i=e.useRef(null),o=e.useRef({start:0,x:0,y:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,boundingRect:null,didMove:!1}).current,l=e.useRef(t),{autoClose:d,pauseOnHover:c,closeToast:u,onClick:m,closeOnClick:p}=t;function h(e){if(t.draggable){"touchstart"===e.nativeEvent.type&&e.nativeEvent.preventDefault(),o.didMove=!1,document.addEventListener("mousemove",v),document.addEventListener("mouseup",j),document.addEventListener("touchmove",v),document.addEventListener("touchend",j);const r=i.current;o.canCloseOnClick=!0,o.canDrag=!0,o.boundingRect=r.getBoundingClientRect(),r.style.transition="",o.x=F(e.nativeEvent),o.y=q(e.nativeEvent),"x"===t.draggableDirection?(o.start=o.x,o.removalDistance=r.offsetWidth*(t.draggablePercent/100)):(o.start=o.y,o.removalDistance=r.offsetHeight*(80===t.draggablePercent?1.5*t.draggablePercent:t.draggablePercent/100))}}function f(e){if(o.boundingRect){const{top:r,bottom:s,left:n,right:a}=o.boundingRect;"touchend"!==e.nativeEvent.type&&t.pauseOnHover&&o.x>=n&&o.x<=a&&o.y>=r&&o.y<=s?g():x()}}function x(){s(!0)}function g(){s(!1)}function v(e){const s=i.current;o.canDrag&&s&&(o.didMove=!0,r&&g(),o.x=F(e),o.y=q(e),o.delta="x"===t.draggableDirection?o.x-o.start:o.y-o.start,o.start!==o.x&&(o.canCloseOnClick=!1),s.style.transform=`translate${t.draggableDirection}(${o.delta}px)`,s.style.opacity=""+(1-Math.abs(o.delta/o.removalDistance)))}function j(){document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",j),document.removeEventListener("touchmove",v),document.removeEventListener("touchend",j);const e=i.current;if(o.canDrag&&o.didMove&&e){if(o.canDrag=!1,Math.abs(o.delta)>o.removalDistance)return a(!0),void t.closeToast();e.style.transition="transform 0.2s, opacity 0.2s",e.style.transform=`translate${t.draggableDirection}(0)`,e.style.opacity="1"}}e.useEffect(()=>{l.current=t}),e.useEffect(()=>(i.current&&i.current.addEventListener("d",x,{once:!0}),M(t.onOpen)&&t.onOpen(e.isValidElement(t.children)&&t.children.props),()=>{const t=l.current;M(t.onClose)&&t.onClose(e.isValidElement(t.children)&&t.children.props)}),[]),e.useEffect(()=>(t.pauseOnFocusLoss&&(document.hasFocus()||g(),window.addEventListener("focus",x),window.addEventListener("blur",g)),()=>{t.pauseOnFocusLoss&&(window.removeEventListener("focus",x),window.removeEventListener("blur",g))}),[t.pauseOnFocusLoss]);const b={onMouseDown:h,onTouchStart:h,onMouseUp:f,onTouchEnd:f};return d&&c&&(b.onMouseEnter=g,b.onMouseLeave=x),p&&(b.onClick=e=>{m&&m(e),o.canCloseOnClick&&u()}),{playToast:x,pauseToast:g,isRunning:r,preventExitTransition:n,toastRef:i,eventHandlers:b}}(t),{closeButton:o,children:l,autoClose:d,onClick:c,type:u,hideProgressBar:m,closeToast:p,transition:h,position:f,className:x,style:g,bodyClassName:v,bodyStyle:j,progressClassName:b,progressStyle:y,updateId:N,role:w,progress:_,rtl:C,toastId:S,deleteToast:E,isIn:T,isLoading:k,iconOut:R,closeOnClick:O,theme:D}=t,P=A("Toastify__toast",`Toastify__toast-theme--${D}`,`Toastify__toast--${u}`,{"Toastify__toast--rtl":C},{"Toastify__toast--close-on-click":O}),L=M(x)?x({rtl:C,position:f,type:u,defaultClassName:P}):A(P,x),U=!!_||!d,I={closeToast:p,type:u,theme:D};let z=null;return!1===o||(z=M(o)?o(I):e.isValidElement(o)?e.cloneElement(o,I):W(I)),r.createElement(h,{isIn:T,done:E,position:f,preventExitTransition:n,nodeRef:a},r.createElement("div",{id:S,onClick:c,className:L,...i,style:g,ref:a},r.createElement("div",{...T&&{role:w},className:M(v)?v({type:u}):A("Toastify__toast-body",v),style:j},null!=R&&r.createElement("div",{className:A("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!k})},R),r.createElement("div",null,l)),z,r.createElement($,{...N&&!U?{key:`pb-${N}`}:{},rtl:C,theme:D,delay:d,isRunning:s,isIn:T,closeToast:p,hide:m,type:u,style:y,className:b,controlledProgress:U,progress:_||0})))},H=function(e,t){return void 0===t&&(t=!1),{enter:`Toastify--animate Toastify__${e}-enter`,exit:`Toastify--animate Toastify__${e}-exit`,appendPosition:t}},J=L(H("bounce",!0));L(H("slide",!0)),L(H("zoom")),L(H("flip"));const G=e.forwardRef((t,s)=>{const{getToastToRender:n,containerRef:a,isToastActive:i}=function(t){const[,r]=e.useReducer(e=>e+1,0),[s,n]=e.useState([]),a=e.useRef(null),i=e.useRef(new Map).current,o=e=>-1!==s.indexOf(e),l=e.useRef({toastKey:1,displayedToast:0,count:0,queue:[],props:t,containerId:null,isToastActive:o,getToast:e=>i.get(e)}).current;function d(e){let{containerId:t}=e;const{limit:r}=l.props;!r||t&&l.containerId!==t||(l.count-=l.queue.length,l.queue=[])}function c(e){n(t=>null==e?[]:t.filter(t=>t!==e))}function u(){const{toastContent:e,toastProps:t,staleId:r}=l.queue.shift();p(e,t,r)}function m(t,s){let{delay:n,staleId:o,...d}=s;if(!P(t)||(m=d,!a.current||l.props.enableMultiContainer&&m.containerId!==l.props.containerId||i.has(m.toastId)&&null==m.updateId))return;var m;const{toastId:h,updateId:f,data:x}=d,{props:g}=l,v=()=>c(h),j=null==f;j&&l.count++;const b={...g,style:g.toastStyle,key:l.toastKey++,...Object.fromEntries(Object.entries(d).filter(e=>{let[t,r]=e;return null!=r})),toastId:h,updateId:f,data:x,closeToast:v,isIn:!1,className:D(d.className||g.toastClassName),bodyClassName:D(d.bodyClassName||g.bodyClassName),progressClassName:D(d.progressClassName||g.progressClassName),autoClose:!d.isLoading&&(y=d.autoClose,N=g.autoClose,!1===y||R(y)&&y>0?y:N),deleteToast(){const e=U(i.get(h),"removed");i.delete(h),I.emit(4,e);const t=l.queue.length;if(l.count=null==h?l.count-l.displayedToast:l.count-1,l.count<0&&(l.count=0),t>0){const e=null==h?l.props.limit:1;if(1===t||1===e)l.displayedToast++,u();else{const r=e>t?t:e;l.displayedToast=r;for(let e=0;e<r;e++)u()}}else r()}};var y,N;b.iconOut=function(t){let{theme:r,type:s,isLoading:n,icon:a}=t,i=null;const o={theme:r,type:s};return!1===a||(M(a)?i=a(o):e.isValidElement(a)?i=e.cloneElement(a,o):O(a)||R(a)?i=a:n?i=B.spinner():s in B&&(i=B[s](o))),i}(b),M(d.onOpen)&&(b.onOpen=d.onOpen),M(d.onClose)&&(b.onClose=d.onClose),b.closeButton=g.closeButton,!1===d.closeButton||P(d.closeButton)?b.closeButton=d.closeButton:!0===d.closeButton&&(b.closeButton=!P(g.closeButton)||g.closeButton);let w=t;e.isValidElement(t)&&!O(t.type)?w=e.cloneElement(t,{closeToast:v,toastProps:b,data:x}):M(t)&&(w=t({closeToast:v,toastProps:b,data:x})),g.limit&&g.limit>0&&l.count>g.limit&&j?l.queue.push({toastContent:w,toastProps:b,staleId:o}):R(n)?setTimeout(()=>{p(w,b,o)},n):p(w,b,o)}function p(e,t,r){const{toastId:s}=t;r&&i.delete(r);const a={content:e,props:t};i.set(s,a),n(e=>[...e,s].filter(e=>e!==r)),I.emit(4,U(a,null==a.props.updateId?"added":"updated"))}return e.useEffect(()=>(l.containerId=t.containerId,I.cancelEmit(3).on(0,m).on(1,e=>a.current&&c(e)).on(5,d).emit(2,l),()=>{i.clear(),I.emit(3,l)}),[]),e.useEffect(()=>{l.props=t,l.isToastActive=o,l.displayedToast=s.length}),{getToastToRender:function(e){const r=new Map,s=Array.from(i.values());return t.newestOnTop&&s.reverse(),s.forEach(e=>{const{position:t}=e.props;r.has(t)||r.set(t,[]),r.get(t).push(e)}),Array.from(r,t=>e(t[0],t[1]))},containerRef:a,isToastActive:o}}(t),{className:o,style:l,rtl:d,containerId:c}=t;function u(e){const t=A("Toastify__toast-container",`Toastify__toast-container--${e}`,{"Toastify__toast-container--rtl":d});return M(o)?o({position:e,rtl:d,defaultClassName:t}):A(t,D(o))}return e.useEffect(()=>{s&&(s.current=a.current)},[]),r.createElement("div",{ref:a,className:"Toastify",id:c},n((e,t)=>{const s=t.length?{...l}:{...l,pointerEvents:"none"};return r.createElement("div",{className:u(e),style:s,key:`container-${e}`},t.map((e,s)=>{let{content:n,props:a}=e;return r.createElement(V,{...a,isIn:i(a.toastId),style:{...a.style,"--nth":s+1,"--len":t.length},key:`toast-${a.key}`},n)}))}))});G.displayName="ToastContainer",G.defaultProps={position:"top-right",transition:J,autoClose:5e3,closeButton:W,pauseOnHover:!0,pauseOnFocusLoss:!0,closeOnClick:!0,draggable:!0,draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light"};let Y,Q=new Map,X=[],K=1;function Z(){return""+K++}function ee(e){return e&&(O(e.toastId)||R(e.toastId))?e.toastId:Z()}function te(e,t){return Q.size>0?I.emit(0,e,t):X.push({content:e,options:t}),t.toastId}function re(e,t){return{...t,type:t&&t.type||e,toastId:ee(t)}}function se(e){return(t,r)=>te(t,re(e,r))}function ne(e,t){return te(e,re("default",t))}function ae(e,t){return function(){return e.apply(t,arguments)}}ne.loading=(e,t)=>te(e,re("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...t})),ne.promise=function(e,t,r){let s,{pending:n,error:a,success:i}=t;n&&(s=O(n)?ne.loading(n,r):ne.loading(n.render,{...r,...n}));const o={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},l=(e,t,n)=>{if(null==t)return void ne.dismiss(s);const a={type:e,...o,...r,data:n},i=O(t)?{render:t}:t;return s?ne.update(s,{...a,...i}):ne(i.render,{...a,...i}),n},d=M(e)?e():e;return d.then(e=>l("success",i,e)).catch(e=>l("error",a,e)),d},ne.success=se("success"),ne.info=se("info"),ne.error=se("error"),ne.warning=se("warning"),ne.warn=ne.warning,ne.dark=(e,t)=>te(e,re("default",{theme:"dark",...t})),ne.dismiss=e=>{Q.size>0?I.emit(1,e):X=X.filter(t=>null!=e&&t.options.toastId!==e)},ne.clearWaitingQueue=function(e){return void 0===e&&(e={}),I.emit(5,e)},ne.isActive=e=>{let t=!1;return Q.forEach(r=>{r.isToastActive&&r.isToastActive(e)&&(t=!0)}),t},ne.update=function(e,t){void 0===t&&(t={}),setTimeout(()=>{const r=function(e,t){let{containerId:r}=t;const s=Q.get(r||Y);return s&&s.getToast(e)}(e,t);if(r){const{props:s,content:n}=r,a={delay:100,...s,...t,toastId:t.toastId||e,updateId:Z()};a.toastId!==e&&(a.staleId=e);const i=a.render||n;delete a.render,te(i,a)}},0)},ne.done=e=>{ne.update(e,{progress:1})},ne.onChange=e=>(I.on(4,e),()=>{I.off(4,e)}),ne.POSITION={TOP_LEFT:"top-left",TOP_RIGHT:"top-right",TOP_CENTER:"top-center",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",BOTTOM_CENTER:"bottom-center"},ne.TYPE={INFO:"info",SUCCESS:"success",WARNING:"warning",ERROR:"error",DEFAULT:"default"},I.on(2,e=>{Y=e.containerId||e,Q.set(Y,e),X.forEach(e=>{I.emit(0,e.content,e.options)}),X=[]}).on(3,e=>{Q.delete(e.containerId||e),0===Q.size&&I.off(0).off(1).off(5)});const{toString:ie}=Object.prototype,{getPrototypeOf:oe}=Object,{iterator:le,toStringTag:de}=Symbol,ce=(e=>t=>{const r=ie.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),ue=e=>(e=e.toLowerCase(),t=>ce(t)===e),me=e=>t=>typeof t===e,{isArray:pe}=Array,he=me("undefined");function fe(e){return null!==e&&!he(e)&&null!==e.constructor&&!he(e.constructor)&&ve(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const xe=ue("ArrayBuffer");const ge=me("string"),ve=me("function"),je=me("number"),be=e=>null!==e&&"object"==typeof e,ye=e=>{if("object"!==ce(e))return!1;const t=oe(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||de in e||le in e)},Ne=ue("Date"),we=ue("File"),_e=ue("Blob"),Ce=ue("FileList"),Se=ue("URLSearchParams"),[Ee,Te,ke,Ae]=["ReadableStream","Request","Response","Headers"].map(ue);function Re(e,t,{allOwnKeys:r=!1}={}){if(null==e)return;let s,n;if("object"!=typeof e&&(e=[e]),pe(e))for(s=0,n=e.length;s<n;s++)t.call(null,e[s],s,e);else{if(fe(e))return;const n=r?Object.getOwnPropertyNames(e):Object.keys(e),a=n.length;let i;for(s=0;s<a;s++)i=n[s],t.call(null,e[i],i,e)}}function Oe(e,t){if(fe(e))return null;t=t.toLowerCase();const r=Object.keys(e);let s,n=r.length;for(;n-- >0;)if(s=r[n],t===s.toLowerCase())return s;return null}const Me="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,De=e=>!he(e)&&e!==Me;const Pe=(e=>t=>e&&t instanceof e)("undefined"!=typeof Uint8Array&&oe(Uint8Array)),Le=ue("HTMLFormElement"),Ue=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),Ie=ue("RegExp"),ze=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),s={};Re(r,(r,n)=>{let a;!1!==(a=t(r,n,e))&&(s[n]=a||r)}),Object.defineProperties(e,s)};const Be=ue("AsyncFunction"),Fe=(qe="function"==typeof setImmediate,We=ve(Me.postMessage),qe?setImmediate:We?($e=`axios@${Math.random()}`,Ve=[],Me.addEventListener("message",({source:e,data:t})=>{e===Me&&t===$e&&Ve.length&&Ve.shift()()},!1),e=>{Ve.push(e),Me.postMessage($e,"*")}):e=>setTimeout(e));var qe,We,$e,Ve;const He="undefined"!=typeof queueMicrotask?queueMicrotask.bind(Me):"undefined"!=typeof process&&process.nextTick||Fe,Je={isArray:pe,isArrayBuffer:xe,isBuffer:fe,isFormData:e=>{let t;return e&&("function"==typeof FormData&&e instanceof FormData||ve(e.append)&&("formdata"===(t=ce(e))||"object"===t&&ve(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&xe(e.buffer),t},isString:ge,isNumber:je,isBoolean:e=>!0===e||!1===e,isObject:be,isPlainObject:ye,isEmptyObject:e=>{if(!be(e)||fe(e))return!1;try{return 0===Object.keys(e).length&&Object.getPrototypeOf(e)===Object.prototype}catch(t){return!1}},isReadableStream:Ee,isRequest:Te,isResponse:ke,isHeaders:Ae,isUndefined:he,isDate:Ne,isFile:we,isBlob:_e,isRegExp:Ie,isFunction:ve,isStream:e=>be(e)&&ve(e.pipe),isURLSearchParams:Se,isTypedArray:Pe,isFileList:Ce,forEach:Re,merge:function e(){const{caseless:t,skipUndefined:r}=De(this)&&this||{},s={},n=(n,a)=>{const i=t&&Oe(s,a)||a;ye(s[i])&&ye(n)?s[i]=e(s[i],n):ye(n)?s[i]=e({},n):pe(n)?s[i]=n.slice():r&&he(n)||(s[i]=n)};for(let a=0,i=arguments.length;a<i;a++)arguments[a]&&Re(arguments[a],n);return s},extend:(e,t,r,{allOwnKeys:s}={})=>(Re(t,(t,s)=>{r&&ve(t)?e[s]=ae(t,r):e[s]=t},{allOwnKeys:s}),e),trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,r,s)=>{e.prototype=Object.create(t.prototype,s),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},toFlatObject:(e,t,r,s)=>{let n,a,i;const o={};if(t=t||{},null==e)return t;do{for(n=Object.getOwnPropertyNames(e),a=n.length;a-- >0;)i=n[a],s&&!s(i,e,t)||o[i]||(t[i]=e[i],o[i]=!0);e=!1!==r&&oe(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},kindOf:ce,kindOfTest:ue,endsWith:(e,t,r)=>{e=String(e),(void 0===r||r>e.length)&&(r=e.length),r-=t.length;const s=e.indexOf(t,r);return-1!==s&&s===r},toArray:e=>{if(!e)return null;if(pe(e))return e;let t=e.length;if(!je(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},forEachEntry:(e,t)=>{const r=(e&&e[le]).call(e);let s;for(;(s=r.next())&&!s.done;){const r=s.value;t.call(e,r[0],r[1])}},matchAll:(e,t)=>{let r;const s=[];for(;null!==(r=e.exec(t));)s.push(r);return s},isHTMLForm:Le,hasOwnProperty:Ue,hasOwnProp:Ue,reduceDescriptors:ze,freezeMethods:e=>{ze(e,(t,r)=>{if(ve(e)&&-1!==["arguments","caller","callee"].indexOf(r))return!1;const s=e[r];ve(s)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")}))})},toObjectSet:(e,t)=>{const r={},s=e=>{e.forEach(e=>{r[e]=!0})};return pe(e)?s(e):s(String(e).split(t)),r},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,t,r){return t.toUpperCase()+r}),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:Oe,global:Me,isContextDefined:De,isSpecCompliantForm:function(e){return!!(e&&ve(e.append)&&"FormData"===e[de]&&e[le])},toJSONObject:e=>{const t=new Array(10),r=(e,s)=>{if(be(e)){if(t.indexOf(e)>=0)return;if(fe(e))return e;if(!("toJSON"in e)){t[s]=e;const n=pe(e)?[]:{};return Re(e,(e,t)=>{const a=r(e,s+1);!he(a)&&(n[t]=a)}),t[s]=void 0,n}}return e};return r(e,0)},isAsyncFn:Be,isThenable:e=>e&&(be(e)||ve(e))&&ve(e.then)&&ve(e.catch),setImmediate:Fe,asap:He,isIterable:e=>null!=e&&ve(e[le])};function Ge(e,t,r,s,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),s&&(this.request=s),n&&(this.response=n,this.status=n.status?n.status:null)}Je.inherits(Ge,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Je.toJSONObject(this.config),code:this.code,status:this.status}}});const Ye=Ge.prototype,Qe={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Qe[e]={value:e}}),Object.defineProperties(Ge,Qe),Object.defineProperty(Ye,"isAxiosError",{value:!0}),Ge.from=(e,t,r,s,n,a)=>{const i=Object.create(Ye);Je.toFlatObject(e,i,function(e){return e!==Error.prototype},e=>"isAxiosError"!==e);const o=e&&e.message?e.message:"Error",l=null==t&&e?e.code:t;return Ge.call(i,o,l,r,s,n),e&&null==i.cause&&Object.defineProperty(i,"cause",{value:e,configurable:!0}),i.name=e&&e.name||"Error",a&&Object.assign(i,a),i};function Xe(e){return Je.isPlainObject(e)||Je.isArray(e)}function Ke(e){return Je.endsWith(e,"[]")?e.slice(0,-2):e}function Ze(e,t,r){return e?e.concat(t).map(function(e,t){return e=Ke(e),!r&&t?"["+e+"]":e}).join(r?".":""):t}const et=Je.toFlatObject(Je,{},null,function(e){return/^is[A-Z]/.test(e)});function tt(e,t,r){if(!Je.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const s=(r=Je.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(e,t){return!Je.isUndefined(t[e])})).metaTokens,n=r.visitor||d,a=r.dots,i=r.indexes,o=(r.Blob||"undefined"!=typeof Blob&&Blob)&&Je.isSpecCompliantForm(t);if(!Je.isFunction(n))throw new TypeError("visitor must be a function");function l(e){if(null===e)return"";if(Je.isDate(e))return e.toISOString();if(Je.isBoolean(e))return e.toString();if(!o&&Je.isBlob(e))throw new Ge("Blob is not supported. Use a Buffer instead.");return Je.isArrayBuffer(e)||Je.isTypedArray(e)?o&&"function"==typeof Blob?new Blob([e]):Buffer.from(e):e}function d(e,r,n){let o=e;if(e&&!n&&"object"==typeof e)if(Je.endsWith(r,"{}"))r=s?r:r.slice(0,-2),e=JSON.stringify(e);else if(Je.isArray(e)&&function(e){return Je.isArray(e)&&!e.some(Xe)}(e)||(Je.isFileList(e)||Je.endsWith(r,"[]"))&&(o=Je.toArray(e)))return r=Ke(r),o.forEach(function(e,s){!Je.isUndefined(e)&&null!==e&&t.append(!0===i?Ze([r],s,a):null===i?r:r+"[]",l(e))}),!1;return!!Xe(e)||(t.append(Ze(n,r,a),l(e)),!1)}const c=[],u=Object.assign(et,{defaultVisitor:d,convertValue:l,isVisitable:Xe});if(!Je.isObject(e))throw new TypeError("data must be an object");return function e(r,s){if(!Je.isUndefined(r)){if(-1!==c.indexOf(r))throw Error("Circular reference detected in "+s.join("."));c.push(r),Je.forEach(r,function(r,a){!0===(!(Je.isUndefined(r)||null===r)&&n.call(t,r,Je.isString(a)?a.trim():a,s,u))&&e(r,s?s.concat(a):[a])}),c.pop()}}(e),t}function rt(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(e){return t[e]})}function st(e,t){this._pairs=[],e&&tt(e,this,t)}const nt=st.prototype;function at(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function it(e,t,r){if(!t)return e;const s=r&&r.encode||at;Je.isFunction(r)&&(r={serialize:r});const n=r&&r.serialize;let a;if(a=n?n(t,r):Je.isURLSearchParams(t)?t.toString():new st(t,r).toString(s),a){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+a}return e}nt.append=function(e,t){this._pairs.push([e,t])},nt.toString=function(e){const t=e?function(t){return e.call(this,t,rt)}:rt;return this._pairs.map(function(e){return t(e[0])+"="+t(e[1])},"").join("&")};class ot{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Je.forEach(this.handlers,function(t){null!==t&&e(t)})}}const lt={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},dt={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:st,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},ct="undefined"!=typeof window&&"undefined"!=typeof document,ut="object"==typeof navigator&&navigator||void 0,mt=ct&&(!ut||["ReactNative","NativeScript","NS"].indexOf(ut.product)<0),pt="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,ht=ct&&window.location.href||"http://localhost",ft={...Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ct,hasStandardBrowserEnv:mt,hasStandardBrowserWebWorkerEnv:pt,navigator:ut,origin:ht},Symbol.toStringTag,{value:"Module"})),...dt};function xt(e){function t(e,r,s,n){let a=e[n++];if("__proto__"===a)return!0;const i=Number.isFinite(+a),o=n>=e.length;if(a=!a&&Je.isArray(s)?s.length:a,o)return Je.hasOwnProp(s,a)?s[a]=[s[a],r]:s[a]=r,!i;s[a]&&Je.isObject(s[a])||(s[a]=[]);return t(e,r,s[a],n)&&Je.isArray(s[a])&&(s[a]=function(e){const t={},r=Object.keys(e);let s;const n=r.length;let a;for(s=0;s<n;s++)a=r[s],t[a]=e[a];return t}(s[a])),!i}if(Je.isFormData(e)&&Je.isFunction(e.entries)){const r={};return Je.forEachEntry(e,(e,s)=>{t(function(e){return Je.matchAll(/\w+|\[(\w*)]/g,e).map(e=>"[]"===e[0]?"":e[1]||e[0])}(e),s,r,0)}),r}return null}const gt={transitional:lt,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const r=t.getContentType()||"",s=r.indexOf("application/json")>-1,n=Je.isObject(e);n&&Je.isHTMLForm(e)&&(e=new FormData(e));if(Je.isFormData(e))return s?JSON.stringify(xt(e)):e;if(Je.isArrayBuffer(e)||Je.isBuffer(e)||Je.isStream(e)||Je.isFile(e)||Je.isBlob(e)||Je.isReadableStream(e))return e;if(Je.isArrayBufferView(e))return e.buffer;if(Je.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(n){if(r.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return tt(e,new ft.classes.URLSearchParams,{visitor:function(e,t,r,s){return ft.isNode&&Je.isBuffer(e)?(this.append(t,e.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)},...t})}(e,this.formSerializer).toString();if((a=Je.isFileList(e))||r.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return tt(a?{"files[]":e}:e,t&&new t,this.formSerializer)}}return n||s?(t.setContentType("application/json",!1),function(e,t,r){if(Je.isString(e))try{return(t||JSON.parse)(e),Je.trim(e)}catch(s){if("SyntaxError"!==s.name)throw s}return(r||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||gt.transitional,r=t&&t.forcedJSONParsing,s="json"===this.responseType;if(Je.isResponse(e)||Je.isReadableStream(e))return e;if(e&&Je.isString(e)&&(r&&!this.responseType||s)){const r=!(t&&t.silentJSONParsing)&&s;try{return JSON.parse(e,this.parseReviver)}catch(n){if(r){if("SyntaxError"===n.name)throw Ge.from(n,Ge.ERR_BAD_RESPONSE,this,null,this.response);throw n}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ft.classes.FormData,Blob:ft.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Je.forEach(["delete","get","head","post","put","patch"],e=>{gt.headers[e]={}});const vt=Je.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),jt=Symbol("internals");function bt(e){return e&&String(e).trim().toLowerCase()}function yt(e){return!1===e||null==e?e:Je.isArray(e)?e.map(yt):String(e)}function Nt(e,t,r,s,n){return Je.isFunction(s)?s.call(this,t,r):(n&&(t=r),Je.isString(t)?Je.isString(s)?-1!==t.indexOf(s):Je.isRegExp(s)?s.test(t):void 0:void 0)}let wt=class{constructor(e){e&&this.set(e)}set(e,t,r){const s=this;function n(e,t,r){const n=bt(t);if(!n)throw new Error("header name must be a non-empty string");const a=Je.findKey(s,n);(!a||void 0===s[a]||!0===r||void 0===r&&!1!==s[a])&&(s[a||t]=yt(e))}const a=(e,t)=>Je.forEach(e,(e,r)=>n(e,r,t));if(Je.isPlainObject(e)||e instanceof this.constructor)a(e,t);else if(Je.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))a((e=>{const t={};let r,s,n;return e&&e.split("\n").forEach(function(e){n=e.indexOf(":"),r=e.substring(0,n).trim().toLowerCase(),s=e.substring(n+1).trim(),!r||t[r]&&vt[r]||("set-cookie"===r?t[r]?t[r].push(s):t[r]=[s]:t[r]=t[r]?t[r]+", "+s:s)}),t})(e),t);else if(Je.isObject(e)&&Je.isIterable(e)){let r,s,n={};for(const t of e){if(!Je.isArray(t))throw TypeError("Object iterator must return a key-value pair");n[s=t[0]]=(r=n[s])?Je.isArray(r)?[...r,t[1]]:[r,t[1]]:t[1]}a(n,t)}else null!=e&&n(t,e,r);return this}get(e,t){if(e=bt(e)){const r=Je.findKey(this,e);if(r){const e=this[r];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=r.exec(e);)t[s[1]]=s[2];return t}(e);if(Je.isFunction(t))return t.call(this,e,r);if(Je.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=bt(e)){const r=Je.findKey(this,e);return!(!r||void 0===this[r]||t&&!Nt(0,this[r],r,t))}return!1}delete(e,t){const r=this;let s=!1;function n(e){if(e=bt(e)){const n=Je.findKey(r,e);!n||t&&!Nt(0,r[n],n,t)||(delete r[n],s=!0)}}return Je.isArray(e)?e.forEach(n):n(e),s}clear(e){const t=Object.keys(this);let r=t.length,s=!1;for(;r--;){const n=t[r];e&&!Nt(0,this[n],n,e,!0)||(delete this[n],s=!0)}return s}normalize(e){const t=this,r={};return Je.forEach(this,(s,n)=>{const a=Je.findKey(r,n);if(a)return t[a]=yt(s),void delete t[n];const i=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,r)=>t.toUpperCase()+r)}(n):String(n).trim();i!==n&&delete t[n],t[i]=yt(s),r[i]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return Je.forEach(this,(r,s)=>{null!=r&&!1!==r&&(t[s]=e&&Je.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const r=new this(e);return t.forEach(e=>r.set(e)),r}static accessor(e){const t=(this[jt]=this[jt]={accessors:{}}).accessors,r=this.prototype;function s(e){const s=bt(e);t[s]||(!function(e,t){const r=Je.toCamelCase(" "+t);["get","set","has"].forEach(s=>{Object.defineProperty(e,s+r,{value:function(e,r,n){return this[s].call(this,t,e,r,n)},configurable:!0})})}(r,e),t[s]=!0)}return Je.isArray(e)?e.forEach(s):s(e),this}};function _t(e,t){const r=this||gt,s=t||r,n=wt.from(s.headers);let a=s.data;return Je.forEach(e,function(e){a=e.call(r,a,n.normalize(),t?t.status:void 0)}),n.normalize(),a}function Ct(e){return!(!e||!e.__CANCEL__)}function St(e,t,r){Ge.call(this,null==e?"canceled":e,Ge.ERR_CANCELED,t,r),this.name="CanceledError"}function Et(e,t,r){const s=r.config.validateStatus;r.status&&s&&!s(r.status)?t(new Ge("Request failed with status code "+r.status,[Ge.ERR_BAD_REQUEST,Ge.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r)):e(r)}wt.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Je.reduceDescriptors(wt.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(e){this[r]=e}}}),Je.freezeMethods(wt),Je.inherits(St,Ge,{__CANCEL__:!0});const Tt=(e,t,r=3)=>{let s=0;const n=function(e,t){e=e||10;const r=new Array(e),s=new Array(e);let n,a=0,i=0;return t=void 0!==t?t:1e3,function(o){const l=Date.now(),d=s[i];n||(n=l),r[a]=o,s[a]=l;let c=i,u=0;for(;c!==a;)u+=r[c++],c%=e;if(a=(a+1)%e,a===i&&(i=(i+1)%e),l-n<t)return;const m=d&&l-d;return m?Math.round(1e3*u/m):void 0}}(50,250);return function(e,t){let r,s,n=0,a=1e3/t;const i=(t,a=Date.now())=>{n=a,r=null,s&&(clearTimeout(s),s=null),e(...t)};return[(...e)=>{const t=Date.now(),o=t-n;o>=a?i(e,t):(r=e,s||(s=setTimeout(()=>{s=null,i(r)},a-o)))},()=>r&&i(r)]}(r=>{const a=r.loaded,i=r.lengthComputable?r.total:void 0,o=a-s,l=n(o);s=a;e({loaded:a,total:i,progress:i?a/i:void 0,bytes:o,rate:l||void 0,estimated:l&&i&&a<=i?(i-a)/l:void 0,event:r,lengthComputable:null!=i,[t?"download":"upload"]:!0})},r)},kt=(e,t)=>{const r=null!=e;return[s=>t[0]({lengthComputable:r,total:e,loaded:s}),t[1]]},At=e=>(...t)=>Je.asap(()=>e(...t)),Rt=ft.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,ft.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(ft.origin),ft.navigator&&/(msie|trident)/i.test(ft.navigator.userAgent)):()=>!0,Ot=ft.hasStandardBrowserEnv?{write(e,t,r,s,n,a,i){if("undefined"==typeof document)return;const o=[`${e}=${encodeURIComponent(t)}`];Je.isNumber(r)&&o.push(`expires=${new Date(r).toUTCString()}`),Je.isString(s)&&o.push(`path=${s}`),Je.isString(n)&&o.push(`domain=${n}`),!0===a&&o.push("secure"),Je.isString(i)&&o.push(`SameSite=${i}`),document.cookie=o.join("; ")},read(e){if("undefined"==typeof document)return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read:()=>null,remove(){}};function Mt(e,t,r){let s=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t);return e&&(s||0==r)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const Dt=e=>e instanceof wt?{...e}:e;function Pt(e,t){t=t||{};const r={};function s(e,t,r,s){return Je.isPlainObject(e)&&Je.isPlainObject(t)?Je.merge.call({caseless:s},e,t):Je.isPlainObject(t)?Je.merge({},t):Je.isArray(t)?t.slice():t}function n(e,t,r,n){return Je.isUndefined(t)?Je.isUndefined(e)?void 0:s(void 0,e,0,n):s(e,t,0,n)}function a(e,t){if(!Je.isUndefined(t))return s(void 0,t)}function i(e,t){return Je.isUndefined(t)?Je.isUndefined(e)?void 0:s(void 0,e):s(void 0,t)}function o(r,n,a){return a in t?s(r,n):a in e?s(void 0,r):void 0}const l={url:a,method:a,data:a,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:o,headers:(e,t,r)=>n(Dt(e),Dt(t),0,!0)};return Je.forEach(Object.keys({...e,...t}),function(s){const a=l[s]||n,i=a(e[s],t[s],s);Je.isUndefined(i)&&a!==o||(r[s]=i)}),r}const Lt=e=>{const t=Pt({},e);let{data:r,withXSRFToken:s,xsrfHeaderName:n,xsrfCookieName:a,headers:i,auth:o}=t;if(t.headers=i=wt.from(i),t.url=it(Mt(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),o&&i.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),Je.isFormData(r))if(ft.hasStandardBrowserEnv||ft.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if(Je.isFunction(r.getHeaders)){const e=r.getHeaders(),t=["content-type","content-length"];Object.entries(e).forEach(([e,r])=>{t.includes(e.toLowerCase())&&i.set(e,r)})}if(ft.hasStandardBrowserEnv&&(s&&Je.isFunction(s)&&(s=s(t)),s||!1!==s&&Rt(t.url))){const e=n&&a&&Ot.read(a);e&&i.set(n,e)}return t},Ut="undefined"!=typeof XMLHttpRequest&&function(e){return new Promise(function(t,r){const s=Lt(e);let n=s.data;const a=wt.from(s.headers).normalize();let i,o,l,d,c,{responseType:u,onUploadProgress:m,onDownloadProgress:p}=s;function h(){d&&d(),c&&c(),s.cancelToken&&s.cancelToken.unsubscribe(i),s.signal&&s.signal.removeEventListener("abort",i)}let f=new XMLHttpRequest;function x(){if(!f)return;const s=wt.from("getAllResponseHeaders"in f&&f.getAllResponseHeaders());Et(function(e){t(e),h()},function(e){r(e),h()},{data:u&&"text"!==u&&"json"!==u?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:s,config:e,request:f}),f=null}f.open(s.method.toUpperCase(),s.url,!0),f.timeout=s.timeout,"onloadend"in f?f.onloadend=x:f.onreadystatechange=function(){f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))&&setTimeout(x)},f.onabort=function(){f&&(r(new Ge("Request aborted",Ge.ECONNABORTED,e,f)),f=null)},f.onerror=function(t){const s=new Ge(t&&t.message?t.message:"Network Error",Ge.ERR_NETWORK,e,f);s.event=t||null,r(s),f=null},f.ontimeout=function(){let t=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const n=s.transitional||lt;s.timeoutErrorMessage&&(t=s.timeoutErrorMessage),r(new Ge(t,n.clarifyTimeoutError?Ge.ETIMEDOUT:Ge.ECONNABORTED,e,f)),f=null},void 0===n&&a.setContentType(null),"setRequestHeader"in f&&Je.forEach(a.toJSON(),function(e,t){f.setRequestHeader(t,e)}),Je.isUndefined(s.withCredentials)||(f.withCredentials=!!s.withCredentials),u&&"json"!==u&&(f.responseType=s.responseType),p&&([l,c]=Tt(p,!0),f.addEventListener("progress",l)),m&&f.upload&&([o,d]=Tt(m),f.upload.addEventListener("progress",o),f.upload.addEventListener("loadend",d)),(s.cancelToken||s.signal)&&(i=t=>{f&&(r(!t||t.type?new St(null,e,f):t),f.abort(),f=null)},s.cancelToken&&s.cancelToken.subscribe(i),s.signal&&(s.signal.aborted?i():s.signal.addEventListener("abort",i)));const g=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(s.url);g&&-1===ft.protocols.indexOf(g)?r(new Ge("Unsupported protocol "+g+":",Ge.ERR_BAD_REQUEST,e)):f.send(n||null)})},It=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let r,s=new AbortController;const n=function(e){if(!r){r=!0,i();const t=e instanceof Error?e:this.reason;s.abort(t instanceof Ge?t:new St(t instanceof Error?t.message:t))}};let a=t&&setTimeout(()=>{a=null,n(new Ge(`timeout ${t} of ms exceeded`,Ge.ETIMEDOUT))},t);const i=()=>{e&&(a&&clearTimeout(a),a=null,e.forEach(e=>{e.unsubscribe?e.unsubscribe(n):e.removeEventListener("abort",n)}),e=null)};e.forEach(e=>e.addEventListener("abort",n));const{signal:o}=s;return o.unsubscribe=()=>Je.asap(i),o}},zt=function*(e,t){let r=e.byteLength;if(r<t)return void(yield e);let s,n=0;for(;n<r;)s=n+t,yield e.slice(n,s),n=s},Bt=async function*(e){if(e[Symbol.asyncIterator])return void(yield*e);const t=e.getReader();try{for(;;){const{done:e,value:r}=await t.read();if(e)break;yield r}}finally{await t.cancel()}},Ft=(e,t,r,s)=>{const n=async function*(e,t){for await(const r of Bt(e))yield*zt(r,t)}(e,t);let a,i=0,o=e=>{a||(a=!0,s&&s(e))};return new ReadableStream({async pull(e){try{const{done:t,value:s}=await n.next();if(t)return o(),void e.close();let a=s.byteLength;if(r){let e=i+=a;r(e)}e.enqueue(new Uint8Array(s))}catch(t){throw o(t),t}},cancel:e=>(o(e),n.return())},{highWaterMark:2})},{isFunction:qt}=Je,Wt=(({Request:e,Response:t})=>({Request:e,Response:t}))(Je.global),{ReadableStream:$t,TextEncoder:Vt}=Je.global,Ht=(e,...t)=>{try{return!!e(...t)}catch(r){return!1}},Jt=e=>{e=Je.merge.call({skipUndefined:!0},Wt,e);const{fetch:t,Request:r,Response:s}=e,n=t?qt(t):"function"==typeof fetch,a=qt(r),i=qt(s);if(!n)return!1;const o=n&&qt($t),l=n&&("function"==typeof Vt?(e=>t=>e.encode(t))(new Vt):async e=>new Uint8Array(await new r(e).arrayBuffer())),d=a&&o&&Ht(()=>{let e=!1;const t=new r(ft.origin,{body:new $t,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),c=i&&o&&Ht(()=>Je.isReadableStream(new s("").body)),u={stream:c&&(e=>e.body)};n&&["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!u[e]&&(u[e]=(t,r)=>{let s=t&&t[e];if(s)return s.call(t);throw new Ge(`Response type '${e}' is not supported`,Ge.ERR_NOT_SUPPORT,r)})});const m=async(e,t)=>{const s=Je.toFiniteNumber(e.getContentLength());return null==s?(async e=>{if(null==e)return 0;if(Je.isBlob(e))return e.size;if(Je.isSpecCompliantForm(e)){const t=new r(ft.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return Je.isArrayBufferView(e)||Je.isArrayBuffer(e)?e.byteLength:(Je.isURLSearchParams(e)&&(e+=""),Je.isString(e)?(await l(e)).byteLength:void 0)})(t):s};return async e=>{let{url:n,method:i,data:o,signal:l,cancelToken:p,timeout:h,onDownloadProgress:f,onUploadProgress:x,responseType:g,headers:v,withCredentials:j="same-origin",fetchOptions:b}=Lt(e),y=t||fetch;g=g?(g+"").toLowerCase():"text";let N=It([l,p&&p.toAbortSignal()],h),w=null;const _=N&&N.unsubscribe&&(()=>{N.unsubscribe()});let C;try{if(x&&d&&"get"!==i&&"head"!==i&&0!==(C=await m(v,o))){let e,t=new r(n,{method:"POST",body:o,duplex:"half"});if(Je.isFormData(o)&&(e=t.headers.get("content-type"))&&v.setContentType(e),t.body){const[e,r]=kt(C,Tt(At(x)));o=Ft(t.body,65536,e,r)}}Je.isString(j)||(j=j?"include":"omit");const t=a&&"credentials"in r.prototype,l={...b,signal:N,method:i.toUpperCase(),headers:v.normalize().toJSON(),body:o,duplex:"half",credentials:t?j:void 0};w=a&&new r(n,l);let p=await(a?y(w,b):y(n,l));const h=c&&("stream"===g||"response"===g);if(c&&(f||h&&_)){const e={};["status","statusText","headers"].forEach(t=>{e[t]=p[t]});const t=Je.toFiniteNumber(p.headers.get("content-length")),[r,n]=f&&kt(t,Tt(At(f),!0))||[];p=new s(Ft(p.body,65536,r,()=>{n&&n(),_&&_()}),e)}g=g||"text";let S=await u[Je.findKey(u,g)||"text"](p,e);return!h&&_&&_(),await new Promise((t,r)=>{Et(t,r,{data:S,headers:wt.from(p.headers),status:p.status,statusText:p.statusText,config:e,request:w})})}catch(S){if(_&&_(),S&&"TypeError"===S.name&&/Load failed|fetch/i.test(S.message))throw Object.assign(new Ge("Network Error",Ge.ERR_NETWORK,e,w),{cause:S.cause||S});throw Ge.from(S,S&&S.code,e,w)}}},Gt=new Map,Yt=e=>{let t=e&&e.env||{};const{fetch:r,Request:s,Response:n}=t,a=[s,n,r];let i,o,l=a.length,d=Gt;for(;l--;)i=a[l],o=d.get(i),void 0===o&&d.set(i,o=l?new Map:Jt(t)),d=o;return o};Yt();const Qt={http:null,xhr:Ut,fetch:{get:Yt}};Je.forEach(Qt,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(r){}Object.defineProperty(e,"adapterName",{value:t})}});const Xt=e=>`- ${e}`,Kt=e=>Je.isFunction(e)||null===e||!1===e;const Zt={getAdapter:function(e,t){e=Je.isArray(e)?e:[e];const{length:r}=e;let s,n;const a={};for(let i=0;i<r;i++){let r;if(s=e[i],n=s,!Kt(s)&&(n=Qt[(r=String(s)).toLowerCase()],void 0===n))throw new Ge(`Unknown adapter '${r}'`);if(n&&(Je.isFunction(n)||(n=n.get(t))))break;a[r||"#"+i]=n}if(!n){const e=Object.entries(a).map(([e,t])=>`adapter ${e} `+(!1===t?"is not supported by the environment":"is not available in the build"));throw new Ge("There is no suitable adapter to dispatch the request "+(r?e.length>1?"since :\n"+e.map(Xt).join("\n"):" "+Xt(e[0]):"as no adapter specified"),"ERR_NOT_SUPPORT")}return n},adapters:Qt};function er(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new St(null,e)}function tr(e){er(e),e.headers=wt.from(e.headers),e.data=_t.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return Zt.getAdapter(e.adapter||gt.adapter,e)(e).then(function(t){return er(e),t.data=_t.call(e,e.transformResponse,t),t.headers=wt.from(t.headers),t},function(t){return Ct(t)||(er(e),t&&t.response&&(t.response.data=_t.call(e,e.transformResponse,t.response),t.response.headers=wt.from(t.response.headers))),Promise.reject(t)})}const rr="1.13.2",sr={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{sr[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const nr={};sr.transitional=function(e,t,r){return(s,n,a)=>{if(!1===e)throw new Ge(function(e,t){return"[Axios v"+rr+"] Transitional option '"+e+"'"+t+(r?". "+r:"")}(n," has been removed"+(t?" in "+t:"")),Ge.ERR_DEPRECATED);return t&&!nr[n]&&(nr[n]=!0),!e||e(s,n,a)}},sr.spelling=function(e){return(e,t)=>!0};const ar={assertOptions:function(e,t,r){if("object"!=typeof e)throw new Ge("options must be an object",Ge.ERR_BAD_OPTION_VALUE);const s=Object.keys(e);let n=s.length;for(;n-- >0;){const a=s[n],i=t[a];if(i){const t=e[a],r=void 0===t||i(t,a,e);if(!0!==r)throw new Ge("option "+a+" must be "+r,Ge.ERR_BAD_OPTION_VALUE);continue}if(!0!==r)throw new Ge("Unknown option "+a,Ge.ERR_BAD_OPTION)}},validators:sr},ir=ar.validators;let or=class{constructor(e){this.defaults=e||{},this.interceptors={request:new ot,response:new ot}}async request(e,t){try{return await this._request(e,t)}catch(r){if(r instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const t=e.stack?e.stack.replace(/^.+\n/,""):"";try{r.stack?t&&!String(r.stack).endsWith(t.replace(/^.+\n.+\n/,""))&&(r.stack+="\n"+t):r.stack=t}catch(s){}}throw r}}_request(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},t=Pt(this.defaults,t);const{transitional:r,paramsSerializer:s,headers:n}=t;void 0!==r&&ar.assertOptions(r,{silentJSONParsing:ir.transitional(ir.boolean),forcedJSONParsing:ir.transitional(ir.boolean),clarifyTimeoutError:ir.transitional(ir.boolean)},!1),null!=s&&(Je.isFunction(s)?t.paramsSerializer={serialize:s}:ar.assertOptions(s,{encode:ir.function,serialize:ir.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),ar.assertOptions(t,{baseUrl:ir.spelling("baseURL"),withXsrfToken:ir.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let a=n&&Je.merge(n.common,n[t.method]);n&&Je.forEach(["delete","get","head","post","put","patch","common"],e=>{delete n[e]}),t.headers=wt.concat(a,n);const i=[];let o=!0;this.interceptors.request.forEach(function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(o=o&&e.synchronous,i.unshift(e.fulfilled,e.rejected))});const l=[];let d;this.interceptors.response.forEach(function(e){l.push(e.fulfilled,e.rejected)});let c,u=0;if(!o){const e=[tr.bind(this),void 0];for(e.unshift(...i),e.push(...l),c=e.length,d=Promise.resolve(t);u<c;)d=d.then(e[u++],e[u++]);return d}c=i.length;let m=t;for(;u<c;){const e=i[u++],t=i[u++];try{m=e(m)}catch(p){t.call(this,p);break}}try{d=tr.call(this,m)}catch(p){return Promise.reject(p)}for(u=0,c=l.length;u<c;)d=d.then(l[u++],l[u++]);return d}getUri(e){return it(Mt((e=Pt(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}};Je.forEach(["delete","get","head","options"],function(e){or.prototype[e]=function(t,r){return this.request(Pt(r||{},{method:e,url:t,data:(r||{}).data}))}}),Je.forEach(["post","put","patch"],function(e){function t(t){return function(r,s,n){return this.request(Pt(n||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:r,data:s}))}}or.prototype[e]=t(),or.prototype[e+"Form"]=t(!0)});const lr={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(lr).forEach(([e,t])=>{lr[t]=e});const dr=function e(t){const r=new or(t),s=ae(or.prototype.request,r);return Je.extend(s,or.prototype,r,{allOwnKeys:!0}),Je.extend(s,r,null,{allOwnKeys:!0}),s.create=function(r){return e(Pt(t,r))},s}(gt);dr.Axios=or,dr.CanceledError=St,dr.CancelToken=class e{constructor(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(e){t=e});const r=this;this.promise.then(e=>{if(!r._listeners)return;let t=r._listeners.length;for(;t-- >0;)r._listeners[t](e);r._listeners=null}),this.promise.then=e=>{let t;const s=new Promise(e=>{r.subscribe(e),t=e}).then(e);return s.cancel=function(){r.unsubscribe(t)},s},e(function(e,s,n){r.reason||(r.reason=new St(e,s,n),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let t;return{token:new e(function(e){t=e}),cancel:t}}},dr.isCancel=Ct,dr.VERSION=rr,dr.toFormData=tt,dr.AxiosError=Ge,dr.Cancel=dr.CanceledError,dr.all=function(e){return Promise.all(e)},dr.spread=function(e){return function(t){return e.apply(null,t)}},dr.isAxiosError=function(e){return Je.isObject(e)&&!0===e.isAxiosError},dr.mergeConfig=Pt,dr.AxiosHeaders=wt,dr.formToJSON=e=>xt(Je.isHTMLForm(e)?new FormData(e):e),dr.getAdapter=Zt.getAdapter,dr.HttpStatusCode=lr,dr.default=dr;const{Axios:cr,AxiosError:ur,CanceledError:mr,isCancel:pr,CancelToken:hr,VERSION:fr,all:xr,Cancel:gr,isAxiosError:vr,spread:jr,toFormData:br,AxiosHeaders:yr,HttpStatusCode:Nr,formToJSON:wr,getAdapter:_r,mergeConfig:Cr}=dr,Sr=e.createContext(),Er=()=>{const t=e.useContext(Sr);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t},Tr=({children:t})=>{const[r,s]=e.useState(null),[n,a]=e.useState(!0);e.useEffect(()=>{if(!("true"===sessionStorage.getItem("forceLoggedOut"))&&window.DJANGO_USER&&window.DJANGO_USER.isAuthenticated)return s({username:window.DJANGO_USER.username}),void a(!1);const e=localStorage.getItem("access_token");e&&(dr.defaults.headers.common.Authorization=`Bearer ${e}`,dr.get("/api/users/me/").then(e=>{const t=e.data,r=Array.isArray(t.permissions)?t.permissions:t.permissions||[];s({id:t.id,username:t.username,email:t.email,is_staff:t.is_staff,is_superuser:t.is_superuser,is_active:t.is_active,permissions:r})}).catch(()=>{dr.get("/api/users/").then(e=>{const t=Array.isArray(e.data)?e.data:e.data.results||[];if(t.length>0){const e=t[0];s({id:e.id,username:e.username,email:e.email,is_staff:e.is_staff,is_superuser:e.is_superuser,is_active:e.is_active,permissions:e.permissions||[]})}else s({username:"User"})}).catch(()=>{s({username:"User"})})}),sessionStorage.removeItem("forceLoggedOut")),a(!1)},[]);const i={user:r,login:async(e,t)=>{var r,n;try{const r=await dr.post("/api/auth/token/",{username:e,password:t}),{access:n,refresh:o}=r.data;localStorage.setItem("access_token",n),localStorage.setItem("refresh_token",o),dr.defaults.headers.common.Authorization=`Bearer ${n}`;try{const e=(await dr.get("/api/users/me/")).data,t=Array.isArray(e.permissions)?e.permissions:e.permissions||[];s({id:e.id,username:e.username,email:e.email,is_staff:e.is_staff,is_superuser:e.is_superuser,is_active:e.is_active,permissions:t})}catch(a){try{const t=await dr.get("/api/users/"),r=(Array.isArray(t.data)?t.data:t.data.results||[]).find(t=>t.username===e);s(r?{id:r.id,username:r.username,email:r.email,is_staff:r.is_staff,is_superuser:r.is_superuser,is_active:r.is_active}:{username:e})}catch(i){s({username:e})}}return sessionStorage.removeItem("forceLoggedOut"),ne.success("Connexion russie"),{success:!0}}catch(o){const e=(null==(n=null==(r=o.response)?void 0:r.data)?void 0:n.detail)||"Erreur de connexion";return ne.error(e),{success:!1,error:e}}},logout:()=>{localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),delete dr.defaults.headers.common.Authorization,s(null),sessionStorage.setItem("forceLoggedOut","true"),window.DJANGO_USER&&(window.DJANGO_USER.isAuthenticated=!1,window.DJANGO_USER.username=""),ne.info("Dconnexion russie"),window.location.replace("/login")},loading:n,isAuthenticated:!!r};return S.jsx(Sr.Provider,{value:i,children:t})},kr=()=>{var e;const{logout:t,user:r}=Er(),i=s(),o=e=>i.pathname===e,l=(e,t="peut_voir")=>{if(null==r?void 0:r.is_superuser)return!0;if(!(null==r?void 0:r.permissions))return!1;if(Array.isArray(r.permissions)){const s=r.permissions.find(t=>t.fonctionnalite===e);return!!s&&s[t]}return!1};return S.jsxs("div",{className:"layout",children:[S.jsx("header",{className:"main-header",children:S.jsxs("div",{className:"header-content",children:[S.jsx("div",{className:"header-left",children:S.jsxs("div",{className:"header-brand",children:[S.jsx("img",{src:"/images/logocsig-Br6bYCQd.png",alt:"Logo CSIG",className:"header-logo"}),S.jsx("h1",{className:"header-title",children:"Suivi Dpense CSIG"})]})}),S.jsxs("div",{className:"header-right",children:[S.jsxs("span",{className:"header-welcome",children:["BIENVENUE, ",(null==(e=null==r?void 0:r.username)?void 0:e.toUpperCase())||"UTILISATEUR","."]}),S.jsx(n,{to:"/dashboard",className:"header-link",children:"VOIR LE SITE"}),S.jsx("button",{onClick:t,className:"header-link header-button",children:"DCONNEXION"})]})]})}),S.jsxs("div",{className:"layout-body",children:[S.jsxs("aside",{className:"sidebar",children:[S.jsx("div",{className:"sidebar-search",children:S.jsx("input",{type:"text",placeholder:"crivez ici pour filtrer...",className:"sidebar-filter-input"})}),S.jsxs("div",{className:"sidebar-section",children:[S.jsx("div",{className:"sidebar-section-header",children:"GESTION DES DPENSES"}),S.jsxs("ul",{className:"sidebar-menu",children:[l("dashboard")&&S.jsx("li",{children:S.jsx(n,{to:"/dashboard",className:"sidebar-item "+(o("/dashboard")?"active":""),children:"Accueil"})}),l("operations")&&S.jsx("li",{children:S.jsx(n,{to:"/operations",className:"sidebar-item "+(o("/operations")?"active":""),children:"Oprations"})}),l("previsions")&&S.jsx("li",{children:S.jsx(n,{to:"/previsions",className:"sidebar-item "+(o("/previsions")?"active":""),children:"Prvisions"})}),l("imputations")&&S.jsx("li",{children:S.jsx(n,{to:"/imputations",className:"sidebar-item "+(o("/imputations")?"active":""),children:"Imputations"})}),l("rapports")&&S.jsx("li",{children:S.jsx(n,{to:"/rapports",className:"sidebar-item "+(o("/rapports")?"active":""),children:"Rapports"})}),l("categories")&&S.jsx("li",{children:S.jsx(n,{to:"/categories",className:"sidebar-item "+(o("/categories")?"active":""),children:"Catgories"})})]})]}),((null==r?void 0:r.is_superuser)||l("utilisateurs"))&&S.jsxs("div",{className:"sidebar-section",children:[S.jsx("div",{className:"sidebar-section-header",children:"ADMINISTRATION"}),S.jsx("ul",{className:"sidebar-menu",children:l("utilisateurs")&&S.jsx("li",{children:S.jsx(n,{to:"/utilisateurs",className:"sidebar-item "+(o("/utilisateurs")?"active":""),children:"Utilisateurs"})})})]}),(l("restauration_commandes")||l("restauration_menus")||l("restauration_plats")||l("tableau_bord_cantine")||l("operations"))&&S.jsxs("div",{className:"sidebar-section",children:[S.jsx("div",{className:"sidebar-section-header",children:"RESTAURATION / CANTINE"}),S.jsxs("ul",{className:"sidebar-menu",children:[l("restauration_commandes")&&S.jsx("li",{children:S.jsx(n,{to:"/restauration/commandes",className:"sidebar-item "+(o("/restauration/commandes")?"active":""),children:"Commander"})}),l("operations")&&S.jsx("li",{children:S.jsx(n,{to:"/restauration/extras",className:"sidebar-item "+(o("/restauration/extras")?"active":""),children:" Extras (Visiteurs/Stagiaires)"})}),l("restauration_menus")&&S.jsx("li",{children:S.jsx(n,{to:"/restauration/menus",className:"sidebar-item "+(o("/restauration/menus")?"active":""),children:"Menus"})}),l("restauration_plats")&&S.jsx("li",{children:S.jsx(n,{to:"/restauration/plats",className:"sidebar-item "+(o("/restauration/plats")?"active":""),children:"Plats"})}),l("tableau_bord_cantine")&&S.jsx("li",{children:S.jsx(n,{to:"/tableau-bord-cantine",className:"sidebar-item "+(o("/tableau-bord-cantine")?"active":""),children:"Tableau de Bord Cantine"})})]})]}),l("audit")&&S.jsxs("div",{className:"sidebar-section",children:[S.jsx("div",{className:"sidebar-section-header",children:"AUDIT ET TRAABILIT"}),S.jsx("ul",{className:"sidebar-menu",children:S.jsx("li",{children:S.jsx(n,{to:"/audit",className:"sidebar-item "+(o("/audit")?"active":""),children:"Journaux d'Audit"})})})]})]}),S.jsx("main",{className:"main-content",children:S.jsx(a,{})})]})]})},Ar=()=>{const{isAuthenticated:e,loading:t}=Er();return t?S.jsx("div",{className:"loading",children:S.jsx("div",{className:"spinner"})}):window.DJANGO_USER&&window.DJANGO_USER.isAuthenticated||e?S.jsx(kr,{children:S.jsx(a,{})}):S.jsx(i,{to:"/login",replace:!0})},Rr=()=>{const[t,r]=e.useState(""),[s,n]=e.useState(""),[a,i]=e.useState(!1),{login:l}=Er(),d=o();return S.jsx("div",{className:"login-container",children:S.jsxs("div",{className:"login-card",children:[S.jsx("h1",{children:"Gestion des Dpenses"}),S.jsx("p",{className:"login-subtitle",children:"Cit des Sciences et de l'Innovation"}),S.jsxs("form",{onSubmit:async e=>{e.preventDefault(),i(!0);(await l(t,s)).success&&d("/dashboard"),i(!1)},children:[S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Nom d'utilisateur"}),S.jsx("input",{type:"text",className:"form-input",value:t,onChange:e=>r(e.target.value),required:!0,autoFocus:!0})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Mot de passe"}),S.jsx("input",{type:"password",className:"form-input",value:s,onChange:e=>n(e.target.value),required:!0})]}),S.jsx("button",{type:"submit",className:"btn btn-primary",disabled:a,style:{width:"100%",marginTop:"1rem"},children:a?"Connexion...":"Se connecter"})]})]})})};function Or(e){return(Or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mr(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function Dr(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function Pr(e){Dr(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"===Or(e)&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):new Date(NaN)}var Lr={};function Ur(){return Lr}function Ir(e){if(Dr(1,arguments),!function(e){return Dr(1,arguments),e instanceof Date||"object"===Or(e)&&"[object Date]"===Object.prototype.toString.call(e)}(e)&&"number"!=typeof e)return!1;var t=Pr(e);return!isNaN(Number(t))}function zr(e,t){return Dr(2,arguments),function(e,t){Dr(2,arguments);var r=Pr(e).getTime(),s=Mr(t);return new Date(r+s)}(e,-Mr(t))}function Br(e){Dr(1,arguments);var t=Pr(e),r=t.getUTCDay(),s=(r<1?7:0)+r-1;return t.setUTCDate(t.getUTCDate()-s),t.setUTCHours(0,0,0,0),t}function Fr(e){Dr(1,arguments);var t=Pr(e),r=t.getUTCFullYear(),s=new Date(0);s.setUTCFullYear(r+1,0,4),s.setUTCHours(0,0,0,0);var n=Br(s),a=new Date(0);a.setUTCFullYear(r,0,4),a.setUTCHours(0,0,0,0);var i=Br(a);return t.getTime()>=n.getTime()?r+1:t.getTime()>=i.getTime()?r:r-1}function qr(e){Dr(1,arguments);var t=Pr(e),r=Br(t).getTime()-function(e){Dr(1,arguments);var t=Fr(e),r=new Date(0);return r.setUTCFullYear(t,0,4),r.setUTCHours(0,0,0,0),Br(r)}(t).getTime();return Math.round(r/6048e5)+1}function Wr(e,t){var r,s,n,a,i,o,l,d;Dr(1,arguments);var c=Ur(),u=Mr(null!==(r=null!==(s=null!==(n=null!==(a=null==t?void 0:t.weekStartsOn)&&void 0!==a?a:null==t||null===(i=t.locale)||void 0===i||null===(o=i.options)||void 0===o?void 0:o.weekStartsOn)&&void 0!==n?n:c.weekStartsOn)&&void 0!==s?s:null===(l=c.locale)||void 0===l||null===(d=l.options)||void 0===d?void 0:d.weekStartsOn)&&void 0!==r?r:0);if(!(u>=0&&u<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var m=Pr(e),p=m.getUTCDay(),h=(p<u?7:0)+p-u;return m.setUTCDate(m.getUTCDate()-h),m.setUTCHours(0,0,0,0),m}function $r(e,t){var r,s,n,a,i,o,l,d;Dr(1,arguments);var c=Pr(e),u=c.getUTCFullYear(),m=Ur(),p=Mr(null!==(r=null!==(s=null!==(n=null!==(a=null==t?void 0:t.firstWeekContainsDate)&&void 0!==a?a:null==t||null===(i=t.locale)||void 0===i||null===(o=i.options)||void 0===o?void 0:o.firstWeekContainsDate)&&void 0!==n?n:m.firstWeekContainsDate)&&void 0!==s?s:null===(l=m.locale)||void 0===l||null===(d=l.options)||void 0===d?void 0:d.firstWeekContainsDate)&&void 0!==r?r:1);if(!(p>=1&&p<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var h=new Date(0);h.setUTCFullYear(u+1,0,p),h.setUTCHours(0,0,0,0);var f=Wr(h,t),x=new Date(0);x.setUTCFullYear(u,0,p),x.setUTCHours(0,0,0,0);var g=Wr(x,t);return c.getTime()>=f.getTime()?u+1:c.getTime()>=g.getTime()?u:u-1}function Vr(e,t){Dr(1,arguments);var r=Pr(e),s=Wr(r,t).getTime()-function(e,t){var r,s,n,a,i,o,l,d;Dr(1,arguments);var c=Ur(),u=Mr(null!==(r=null!==(s=null!==(n=null!==(a=null==t?void 0:t.firstWeekContainsDate)&&void 0!==a?a:null==t||null===(i=t.locale)||void 0===i||null===(o=i.options)||void 0===o?void 0:o.firstWeekContainsDate)&&void 0!==n?n:c.firstWeekContainsDate)&&void 0!==s?s:null===(l=c.locale)||void 0===l||null===(d=l.options)||void 0===d?void 0:d.firstWeekContainsDate)&&void 0!==r?r:1),m=$r(e,t),p=new Date(0);return p.setUTCFullYear(m,0,u),p.setUTCHours(0,0,0,0),Wr(p,t)}(r,t).getTime();return Math.round(s/6048e5)+1}function Hr(e,t){for(var r=e<0?"-":"",s=Math.abs(e).toString();s.length<t;)s="0"+s;return r+s}var Jr=function(e,t){var r=e.getUTCFullYear(),s=r>0?r:1-r;return Hr("yy"===t?s%100:s,t.length)},Gr=function(e,t){var r=e.getUTCMonth();return"M"===t?String(r+1):Hr(r+1,2)},Yr=function(e,t){return Hr(e.getUTCDate(),t.length)},Qr=function(e,t){return Hr(e.getUTCHours()%12||12,t.length)},Xr=function(e,t){return Hr(e.getUTCHours(),t.length)},Kr=function(e,t){return Hr(e.getUTCMinutes(),t.length)},Zr=function(e,t){return Hr(e.getUTCSeconds(),t.length)},es=function(e,t){var r=t.length,s=e.getUTCMilliseconds();return Hr(Math.floor(s*Math.pow(10,r-3)),t.length)},ts="midnight",rs="noon",ss="morning",ns="afternoon",as="evening",is="night",os={G:function(e,t,r){var s=e.getUTCFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(s,{width:"abbreviated"});case"GGGGG":return r.era(s,{width:"narrow"});default:return r.era(s,{width:"wide"})}},y:function(e,t,r){if("yo"===t){var s=e.getUTCFullYear(),n=s>0?s:1-s;return r.ordinalNumber(n,{unit:"year"})}return Jr(e,t)},Y:function(e,t,r,s){var n=$r(e,s),a=n>0?n:1-n;return"YY"===t?Hr(a%100,2):"Yo"===t?r.ordinalNumber(a,{unit:"year"}):Hr(a,t.length)},R:function(e,t){return Hr(Fr(e),t.length)},u:function(e,t){return Hr(e.getUTCFullYear(),t.length)},Q:function(e,t,r){var s=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"Q":return String(s);case"QQ":return Hr(s,2);case"Qo":return r.ordinalNumber(s,{unit:"quarter"});case"QQQ":return r.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(s,{width:"narrow",context:"formatting"});default:return r.quarter(s,{width:"wide",context:"formatting"})}},q:function(e,t,r){var s=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"q":return String(s);case"qq":return Hr(s,2);case"qo":return r.ordinalNumber(s,{unit:"quarter"});case"qqq":return r.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(s,{width:"narrow",context:"standalone"});default:return r.quarter(s,{width:"wide",context:"standalone"})}},M:function(e,t,r){var s=e.getUTCMonth();switch(t){case"M":case"MM":return Gr(e,t);case"Mo":return r.ordinalNumber(s+1,{unit:"month"});case"MMM":return r.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(s,{width:"narrow",context:"formatting"});default:return r.month(s,{width:"wide",context:"formatting"})}},L:function(e,t,r){var s=e.getUTCMonth();switch(t){case"L":return String(s+1);case"LL":return Hr(s+1,2);case"Lo":return r.ordinalNumber(s+1,{unit:"month"});case"LLL":return r.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(s,{width:"narrow",context:"standalone"});default:return r.month(s,{width:"wide",context:"standalone"})}},w:function(e,t,r,s){var n=Vr(e,s);return"wo"===t?r.ordinalNumber(n,{unit:"week"}):Hr(n,t.length)},I:function(e,t,r){var s=qr(e);return"Io"===t?r.ordinalNumber(s,{unit:"week"}):Hr(s,t.length)},d:function(e,t,r){return"do"===t?r.ordinalNumber(e.getUTCDate(),{unit:"date"}):Yr(e,t)},D:function(e,t,r){var s=function(e){Dr(1,arguments);var t=Pr(e),r=t.getTime();t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0);var s=r-t.getTime();return Math.floor(s/864e5)+1}(e);return"Do"===t?r.ordinalNumber(s,{unit:"dayOfYear"}):Hr(s,t.length)},E:function(e,t,r){var s=e.getUTCDay();switch(t){case"E":case"EE":case"EEE":return r.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(s,{width:"short",context:"formatting"});default:return r.day(s,{width:"wide",context:"formatting"})}},e:function(e,t,r,s){var n=e.getUTCDay(),a=(n-s.weekStartsOn+8)%7||7;switch(t){case"e":return String(a);case"ee":return Hr(a,2);case"eo":return r.ordinalNumber(a,{unit:"day"});case"eee":return r.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(n,{width:"short",context:"formatting"});default:return r.day(n,{width:"wide",context:"formatting"})}},c:function(e,t,r,s){var n=e.getUTCDay(),a=(n-s.weekStartsOn+8)%7||7;switch(t){case"c":return String(a);case"cc":return Hr(a,t.length);case"co":return r.ordinalNumber(a,{unit:"day"});case"ccc":return r.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(n,{width:"narrow",context:"standalone"});case"cccccc":return r.day(n,{width:"short",context:"standalone"});default:return r.day(n,{width:"wide",context:"standalone"})}},i:function(e,t,r){var s=e.getUTCDay(),n=0===s?7:s;switch(t){case"i":return String(n);case"ii":return Hr(n,t.length);case"io":return r.ordinalNumber(n,{unit:"day"});case"iii":return r.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(s,{width:"short",context:"formatting"});default:return r.day(s,{width:"wide",context:"formatting"})}},a:function(e,t,r){var s=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(s,{width:"narrow",context:"formatting"});default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,t,r){var s,n=e.getUTCHours();switch(s=12===n?rs:0===n?ts:n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(s,{width:"narrow",context:"formatting"});default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,t,r){var s,n=e.getUTCHours();switch(s=n>=17?as:n>=12?ns:n>=4?ss:is,t){case"B":case"BB":case"BBB":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(s,{width:"narrow",context:"formatting"});default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,t,r){if("ho"===t){var s=e.getUTCHours()%12;return 0===s&&(s=12),r.ordinalNumber(s,{unit:"hour"})}return Qr(e,t)},H:function(e,t,r){return"Ho"===t?r.ordinalNumber(e.getUTCHours(),{unit:"hour"}):Xr(e,t)},K:function(e,t,r){var s=e.getUTCHours()%12;return"Ko"===t?r.ordinalNumber(s,{unit:"hour"}):Hr(s,t.length)},k:function(e,t,r){var s=e.getUTCHours();return 0===s&&(s=24),"ko"===t?r.ordinalNumber(s,{unit:"hour"}):Hr(s,t.length)},m:function(e,t,r){return"mo"===t?r.ordinalNumber(e.getUTCMinutes(),{unit:"minute"}):Kr(e,t)},s:function(e,t,r){return"so"===t?r.ordinalNumber(e.getUTCSeconds(),{unit:"second"}):Zr(e,t)},S:function(e,t){return es(e,t)},X:function(e,t,r,s){var n=(s._originalDate||e).getTimezoneOffset();if(0===n)return"Z";switch(t){case"X":return ds(n);case"XXXX":case"XX":return cs(n);default:return cs(n,":")}},x:function(e,t,r,s){var n=(s._originalDate||e).getTimezoneOffset();switch(t){case"x":return ds(n);case"xxxx":case"xx":return cs(n);default:return cs(n,":")}},O:function(e,t,r,s){var n=(s._originalDate||e).getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+ls(n,":");default:return"GMT"+cs(n,":")}},z:function(e,t,r,s){var n=(s._originalDate||e).getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+ls(n,":");default:return"GMT"+cs(n,":")}},t:function(e,t,r,s){var n=s._originalDate||e;return Hr(Math.floor(n.getTime()/1e3),t.length)},T:function(e,t,r,s){return Hr((s._originalDate||e).getTime(),t.length)}};function ls(e,t){var r=e>0?"-":"+",s=Math.abs(e),n=Math.floor(s/60),a=s%60;if(0===a)return r+String(n);var i=t;return r+String(n)+i+Hr(a,2)}function ds(e,t){return e%60==0?(e>0?"-":"+")+Hr(Math.abs(e)/60,2):cs(e,t)}function cs(e,t){var r=t||"",s=e>0?"-":"+",n=Math.abs(e);return s+Hr(Math.floor(n/60),2)+r+Hr(n%60,2)}var us=function(e,t){switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},ms=function(e,t){switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},ps={p:ms,P:function(e,t){var r,s=e.match(/(P+)(p+)?/)||[],n=s[1],a=s[2];if(!a)return us(e,t);switch(n){case"P":r=t.dateTime({width:"short"});break;case"PP":r=t.dateTime({width:"medium"});break;case"PPP":r=t.dateTime({width:"long"});break;default:r=t.dateTime({width:"full"})}return r.replace("{{date}}",us(n,t)).replace("{{time}}",ms(a,t))}},hs=["D","DD"],fs=["YY","YYYY"];function xs(e,t,r){if("YYYY"===e)throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("YY"===e)throw new RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("D"===e)throw new RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("DD"===e)throw new RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var gs={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function vs(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}var js={date:vs({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:vs({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:vs({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},bs={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function ys(e){return function(t,r){var s;if("formatting"===(null!=r&&r.context?String(r.context):"standalone")&&e.formattingValues){var n=e.defaultFormattingWidth||e.defaultWidth,a=null!=r&&r.width?String(r.width):n;s=e.formattingValues[a]||e.formattingValues[n]}else{var i=e.defaultWidth,o=null!=r&&r.width?String(r.width):e.defaultWidth;s=e.values[o]||e.values[i]}return s[e.argumentCallback?e.argumentCallback(t):t]}}function Ns(e){return function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=r.width,n=s&&e.matchPatterns[s]||e.matchPatterns[e.defaultMatchWidth],a=t.match(n);if(!a)return null;var i,o=a[0],l=s&&e.parsePatterns[s]||e.parsePatterns[e.defaultParseWidth],d=Array.isArray(l)?function(e,t){for(var r=0;r<e.length;r++)if(t(e[r]))return r;return}(l,function(e){return e.test(o)}):function(e,t){for(var r in e)if(e.hasOwnProperty(r)&&t(e[r]))return r;return}(l,function(e){return e.test(o)});return i=e.valueCallback?e.valueCallback(d):d,{value:i=r.valueCallback?r.valueCallback(i):i,rest:t.slice(o.length)}}}function ws(e){return function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=t.match(e.matchPattern);if(!s)return null;var n=s[0],a=t.match(e.parsePattern);if(!a)return null;var i=e.valueCallback?e.valueCallback(a[0]):a[0];return{value:i=r.valueCallback?r.valueCallback(i):i,rest:t.slice(n.length)}}}var _s={code:"en-US",formatDistance:function(e,t,r){var s,n=gs[e];return s="string"==typeof n?n:1===t?n.one:n.other.replace("{{count}}",t.toString()),null!=r&&r.addSuffix?r.comparison&&r.comparison>0?"in "+s:s+" ago":s},formatLong:js,formatRelative:function(e,t,r,s){return bs[e]},localize:{ordinalNumber:function(e,t){var r=Number(e),s=r%100;if(s>20||s<10)switch(s%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},era:ys({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:ys({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:ys({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:ys({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:ys({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:ws({matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:function(e){return parseInt(e,10)}}),era:Ns({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:Ns({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:Ns({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:Ns({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:Ns({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}},Cs=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Ss=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Es=/^'([^]*?)'?$/,Ts=/''/g,ks=/[a-zA-Z]/;function As(e,t,r){var s,n,a,i,o,l,d,c,u,m,p,h,f,x,g,v,j,b;Dr(2,arguments);var y=String(t),N=Ur(),w=null!==(s=null!==(n=null==r?void 0:r.locale)&&void 0!==n?n:N.locale)&&void 0!==s?s:_s,_=Mr(null!==(a=null!==(i=null!==(o=null!==(l=null==r?void 0:r.firstWeekContainsDate)&&void 0!==l?l:null==r||null===(d=r.locale)||void 0===d||null===(c=d.options)||void 0===c?void 0:c.firstWeekContainsDate)&&void 0!==o?o:N.firstWeekContainsDate)&&void 0!==i?i:null===(u=N.locale)||void 0===u||null===(m=u.options)||void 0===m?void 0:m.firstWeekContainsDate)&&void 0!==a?a:1);if(!(_>=1&&_<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var C=Mr(null!==(p=null!==(h=null!==(f=null!==(x=null==r?void 0:r.weekStartsOn)&&void 0!==x?x:null==r||null===(g=r.locale)||void 0===g||null===(v=g.options)||void 0===v?void 0:v.weekStartsOn)&&void 0!==f?f:N.weekStartsOn)&&void 0!==h?h:null===(j=N.locale)||void 0===j||null===(b=j.options)||void 0===b?void 0:b.weekStartsOn)&&void 0!==p?p:0);if(!(C>=0&&C<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!w.localize)throw new RangeError("locale must contain localize property");if(!w.formatLong)throw new RangeError("locale must contain formatLong property");var S=Pr(e);if(!Ir(S))throw new RangeError("Invalid time value");var E=function(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}(S),T=zr(S,E),k={firstWeekContainsDate:_,weekStartsOn:C,locale:w,_originalDate:S},A=y.match(Ss).map(function(e){var t=e[0];return"p"===t||"P"===t?(0,ps[t])(e,w.formatLong):e}).join("").match(Cs).map(function(s){if("''"===s)return"'";var n=s[0];if("'"===n)return function(e){var t=e.match(Es);if(!t)return e;return t[1].replace(Ts,"'")}(s);var a=os[n];if(a)return null!=r&&r.useAdditionalWeekYearTokens||!function(e){return-1!==fs.indexOf(e)}(s)||xs(s,t,String(e)),null!=r&&r.useAdditionalDayOfYearTokens||!function(e){return-1!==hs.indexOf(e)}(s)||xs(s,t,String(e)),a(T,s,w.localize,k);if(n.match(ks))throw new RangeError("Format string contains an unescaped latin alphabet character `"+n+"`");return s}).join("");return A}var Rs={lessThanXSeconds:{one:"moins dune seconde",other:"moins de {{count}} secondes"},xSeconds:{one:"1 seconde",other:"{{count}} secondes"},halfAMinute:"30 secondes",lessThanXMinutes:{one:"moins dune minute",other:"moins de {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"environ 1 heure",other:"environ {{count}} heures"},xHours:{one:"1 heure",other:"{{count}} heures"},xDays:{one:"1 jour",other:"{{count}} jours"},aboutXWeeks:{one:"environ 1 semaine",other:"environ {{count}} semaines"},xWeeks:{one:"1 semaine",other:"{{count}} semaines"},aboutXMonths:{one:"environ 1 mois",other:"environ {{count}} mois"},xMonths:{one:"1 mois",other:"{{count}} mois"},aboutXYears:{one:"environ 1 an",other:"environ {{count}} ans"},xYears:{one:"1 an",other:"{{count}} ans"},overXYears:{one:"plus dun an",other:"plus de {{count}} ans"},almostXYears:{one:"presquun an",other:"presque {{count}} ans"}},Os={date:vs({formats:{full:"EEEE d MMMM y",long:"d MMMM y",medium:"d MMM y",short:"dd/MM/y"},defaultWidth:"full"}),time:vs({formats:{full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},defaultWidth:"full"}),dateTime:vs({formats:{full:"{{date}} '' {{time}}",long:"{{date}} '' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},Ms={lastWeek:"eeee 'dernier ' p",yesterday:"'hier ' p",today:"'aujourdhui ' p",tomorrow:"'demain ' p'",nextWeek:"eeee 'prochain ' p",other:"P"},Ds={code:"fr",formatDistance:function(e,t,r){var s,n=Rs[e];return s="string"==typeof n?n:1===t?n.one:n.other.replace("{{count}}",String(t)),null!=r&&r.addSuffix?r.comparison&&r.comparison>0?"dans "+s:"il y a "+s:s},formatLong:Os,formatRelative:function(e,t,r,s){return Ms[e]},localize:{ordinalNumber:function(e,t){var r=Number(e),s=null==t?void 0:t.unit;if(0===r)return"0";return r+(1===r?s&&["year","week","hour","minute","second"].includes(s)?"re":"er":"me")},era:ys({values:{narrow:["av. J.-C","ap. J.-C"],abbreviated:["av. J.-C","ap. J.-C"],wide:["avant Jsus-Christ","aprs Jsus-Christ"]},defaultWidth:"wide"}),quarter:ys({values:{narrow:["T1","T2","T3","T4"],abbreviated:["1er trim.","2me trim.","3me trim.","4me trim."],wide:["1er trimestre","2me trimestre","3me trimestre","4me trimestre"]},defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:ys({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["janv.","fvr.","mars","avr.","mai","juin","juil.","aot","sept.","oct.","nov.","dc."],wide:["janvier","fvrier","mars","avril","mai","juin","juillet","aot","septembre","octobre","novembre","dcembre"]},defaultWidth:"wide"}),day:ys({values:{narrow:["D","L","M","M","J","V","S"],short:["di","lu","ma","me","je","ve","sa"],abbreviated:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],wide:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]},defaultWidth:"wide"}),dayPeriod:ys({values:{narrow:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"mat.",afternoon:"ap.m.",evening:"soir",night:"mat."},abbreviated:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"matin",afternoon:"aprs-midi",evening:"soir",night:"matin"},wide:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"du matin",afternoon:"de laprs-midi",evening:"du soir",night:"du matin"}},defaultWidth:"wide"})},match:{ordinalNumber:ws({matchPattern:/^(\d+)(ime|re|me|er|e)?/i,parsePattern:/\d+/i,valueCallback:function(e){return parseInt(e)}}),era:Ns({matchPatterns:{narrow:/^(av\.J\.C|ap\.J\.C|ap\.J\.-C)/i,abbreviated:/^(av\.J\.-C|av\.J-C|apr\.J\.-C|apr\.J-C|ap\.J-C)/i,wide:/^(avant Jsus-Christ|aprs Jsus-Christ)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^av/i,/^ap/i]},defaultParseWidth:"any"}),quarter:Ns({matchPatterns:{narrow:/^T?[1234]/i,abbreviated:/^[1234](er|me|e)? trim\.?/i,wide:/^[1234](er|me|e)? trimestre/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:Ns({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(janv|fvr|mars|avr|mai|juin|juill|juil|aot|sept|oct|nov|dc)\.?/i,wide:/^(janvier|fvrier|mars|avril|mai|juin|juillet|aot|septembre|octobre|novembre|dcembre)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^av/i,/^ma/i,/^juin/i,/^juil/i,/^ao/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:Ns({matchPatterns:{narrow:/^[lmjvsd]/i,short:/^(di|lu|ma|me|je|ve|sa)/i,abbreviated:/^(dim|lun|mar|mer|jeu|ven|sam)\.?/i,wide:/^(dimanche|lundi|mardi|mercredi|jeudi|vendredi|samedi)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^di/i,/^lu/i,/^ma/i,/^me/i,/^je/i,/^ve/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:Ns({matchPatterns:{narrow:/^(a|p|minuit|midi|mat\.?|ap\.?m\.?|soir|nuit)/i,any:/^([ap]\.?\s?m\.?|du matin|de l'aprs[-\s]midi|du soir|de la nuit)/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^min/i,noon:/^mid/i,morning:/mat/i,afternoon:/ap/i,evening:/soir/i,night:/nuit/i}},defaultParseWidth:"any"})},options:{weekStartsOn:1,firstWeekContainsDate:4}};const Ps=e=>((e,t=!0)=>{if(null==e||""===e||isNaN(e))return t?"0,00 GNF":"0,00";const r=("string"==typeof e?parseFloat(e):e).toLocaleString("fr-FR",{minimumFractionDigits:2,maximumFractionDigits:2});return t?`${r} GNF`:r})(e,!0),Ls=()=>{var e,t,r,s;const a=As(new Date,"yyyy-MM"),i=function(e){Dr(1,arguments);var t=Pr(e);return t.setDate(1),t.setHours(0,0,0,0),t}(new Date);!function(e){Dr(1,arguments);var t=Pr(e),r=t.getMonth();t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999)}(new Date);const{data:o,isLoading:l,error:d}=m(["rapport",a],async()=>(await dr.get(`/api/rapports/mensuel/?mois=${a}`)).data,{enabled:!!a,retry:1,onError:e=>{}}),{data:c,error:u}=m(["operations-recentes"],async()=>(await dr.get("/api/operations/?ordering=-date_operation&page_size=5")).data,{retry:1,onError:e=>{}});if(l)return S.jsx("div",{className:"loading",children:S.jsx("div",{className:"spinner"})});const p=e=>new Date(e.getFullYear(),e.getMonth()+1,0).getDate(),h={total_depenses:0,total_prevu:0,ecart_global:0,moyenne_journaliere:0,nombre_operations:0,nombre_jours:p(new Date),categories:[]},f=o||h;return S.jsxs("div",{className:"dashboard",children:[S.jsxs("div",{className:"breadcrumbs",children:[S.jsx("span",{children:"Accueil"}),S.jsx("span",{className:"breadcrumb-separator",children:""}),S.jsx("span",{className:"breadcrumb-current",children:"Tableau de bord"})]}),S.jsxs("div",{className:"dashboard-header",children:[S.jsx("h1",{children:"Tableau de bord"}),S.jsx("p",{className:"page-subtitle",children:As(i,"MMMM yyyy",{locale:Ds})})]}),d&&S.jsxs("div",{className:"card",style:{backgroundColor:"#fff3cd",border:"1px solid #ffc107",padding:"1.5rem",marginBottom:"1.5rem"},children:[S.jsx("h3",{style:{color:"#856404",marginTop:0,marginBottom:"0.5rem"},children:" Erreur lors du chargement du rapport"}),S.jsxs("p",{style:{color:"#856404",margin:"0.5rem 0"},children:[S.jsx("strong",{children:"Code HTTP:"})," ",(null==(e=d.response)?void 0:e.status)||"N/A"]}),401===(null==(t=d.response)?void 0:t.status)?S.jsxs("div",{style:{marginTop:"1rem"},children:[S.jsx("p",{style:{color:"#dc3545",fontWeight:"bold",marginBottom:"0.5rem"},children:" Erreur d'authentification"}),S.jsx("p",{style:{color:"#856404",margin:"0.5rem 0"},children:"Vous devez vous connecter pour accder aux donnes."}),S.jsx(n,{to:"/login",style:{display:"inline-block",marginTop:"0.5rem",padding:"0.5rem 1rem",backgroundColor:"#366092",color:"white",textDecoration:"none",borderRadius:"6px",fontWeight:"600"},children:"Se connecter"})]}):S.jsxs("div",{style:{marginTop:"1rem"},children:[S.jsxs("p",{style:{color:"#856404",margin:"0.5rem 0"},children:[S.jsx("strong",{children:"Message:"})," ",(null==(s=null==(r=d.response)?void 0:r.data)?void 0:s.detail)||d.message||"Erreur inconnue"]}),S.jsx("p",{style:{color:"#856404",marginTop:"0.5rem",fontSize:"0.875rem"},children:"Vrifiez que le serveur backend Django est dmarr sur http://localhost:8000"})]})]}),S.jsxs("div",{className:"stats-grid",children:[S.jsxs("div",{className:"stat-card",children:[S.jsx("div",{className:"stat-label",children:"Total Dpenses"}),S.jsx("div",{className:"stat-value",children:Ps(f.total_depenses||0)})]}),S.jsxs("div",{className:"stat-card stat-card-prevision",children:[S.jsx("div",{className:"stat-label",children:"Total Prvu"}),S.jsx("div",{className:"stat-value",children:Ps(f.total_prevu||0)}),f.total_prevu>0&&S.jsxs("div",{className:"stat-details",children:[S.jsxs("div",{className:"stat-detail-item",children:[S.jsx("span",{className:"stat-detail-label",children:"Utilis:"}),S.jsxs("span",{className:"stat-detail-value",children:[((f.total_depenses||0)/f.total_prevu*100).toFixed(1),"%"]})]}),S.jsxs("div",{className:"stat-detail-item",children:[S.jsx("span",{className:"stat-detail-label",children:"Restant:"}),S.jsx("span",{className:"stat-detail-value "+(f.total_prevu-(f.total_depenses||0)<0?"negative":""),children:Ps(f.total_prevu-(f.total_depenses||0))})]})]}),S.jsx(n,{to:"/previsions",className:"stat-link",style:{display:"block",marginTop:"0.75rem",fontSize:"0.75rem",color:"#16a34a",textDecoration:"none",fontWeight:"500"},children:"Voir les prvisions "})]}),S.jsxs("div",{className:"stat-card",children:[S.jsx("div",{className:"stat-label",children:"cart Global"}),S.jsx("div",{className:"stat-value "+((f.ecart_global||0)<0?"negative":"positive"),children:Ps(f.ecart_global||0)})]}),S.jsxs("div",{className:"stat-card",children:[S.jsx("div",{className:"stat-label",children:"Moyenne Journalire"}),S.jsx("div",{className:"stat-value",children:Ps(f.moyenne_journaliere||0)})]}),S.jsxs("div",{className:"stat-card",children:[S.jsx("div",{className:"stat-label",children:"Nombre d'Oprations"}),S.jsx("div",{className:"stat-value",children:f.nombre_operations||0})]}),S.jsxs("div",{className:"stat-card",children:[S.jsx("div",{className:"stat-label",children:"Nombre de Jours"}),S.jsx("div",{className:"stat-value",children:f.nombre_jours||p(new Date)})]})]}),S.jsx("div",{className:"card",style:{marginTop:"1.5rem",border:"2px solid #28a745",backgroundColor:"#f8fff9"},children:S.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[S.jsxs("div",{children:[S.jsx("h2",{style:{margin:"0 0 0.5rem 0",color:"#28a745"},children:" Extras Restauration"}),S.jsx("p",{style:{margin:0,color:"#6c757d",fontSize:"0.9rem"},children:"Grer les oprations de restauration pour les visiteurs, stagiaires et activits"}),S.jsxs("p",{style:{margin:"0.5rem 0 0 0",color:"#495057",fontSize:"0.85rem"},children:[S.jsx("strong",{children:"Note:"})," Tous les montants sont automatiquement enregistrs dans la catgorie RESTAURATION"]})]}),S.jsx(n,{to:"/restauration/extras",className:"btn btn-success",style:{backgroundColor:"#28a745",borderColor:"#28a745",color:"white",padding:"0.75rem 1.5rem",textDecoration:"none",borderRadius:"6px",fontWeight:"600",whiteSpace:"nowrap"},children:" Grer les Extras"})]})}),f.categories&&f.categories.length>0?S.jsxs("div",{className:"card",children:[S.jsx("h2",{children:"Rsum par Catgorie"}),S.jsxs("table",{className:"table",children:[S.jsx("thead",{children:S.jsxs("tr",{children:[S.jsx("th",{children:"Catgorie"}),S.jsx("th",{children:"Total Dpens"}),S.jsx("th",{children:"Montant Prvu"}),S.jsx("th",{children:"cart"}),S.jsx("th",{children:"Oprations"})]})}),S.jsx("tbody",{children:f.categories.map(e=>S.jsxs("tr",{children:[S.jsxs("td",{children:[e.categorie_code," - ",e.categorie_nom]}),S.jsx("td",{children:Ps(e.total_depense)}),S.jsx("td",{children:Ps(e.montant_prevu)}),S.jsx("td",{className:e.ecart<0?"negative":"positive",children:Ps(e.ecart)}),S.jsx("td",{children:e.nombre_operations})]},e.categorie_code))})]})]}):S.jsxs("div",{className:"card",children:[S.jsx("h2",{children:"Rsum par Catgorie"}),S.jsxs("p",{style:{color:"var(--text-secondary)",textAlign:"center",padding:"2rem"},children:["Aucune donne disponible pour ce mois.",S.jsx("br",{}),S.jsx(n,{to:"/operations",style:{color:"var(--primary-color)",textDecoration:"none"},children:"Commencez par crer des oprations"})," ou",S.jsx(n,{to:"/previsions",style:{color:"var(--primary-color)",textDecoration:"none"},children:"dfinir des prvisions"}),"."]})]}),u?S.jsxs("div",{className:"card",children:[S.jsx("h2",{children:"Oprations Rcentes"}),S.jsx("p",{style:{color:"var(--text-secondary)",textAlign:"center",padding:"2rem"},children:"Erreur lors du chargement des oprations."})]}):c&&c.results&&c.results.length>0?S.jsxs("div",{className:"card",children:[S.jsx("h2",{children:"Oprations Rcentes"}),S.jsxs("table",{className:"table",children:[S.jsx("thead",{children:S.jsxs("tr",{children:[S.jsx("th",{children:"Date"}),S.jsx("th",{children:"Catgorie"}),S.jsx("th",{children:"Montant"}),S.jsx("th",{children:"Description"})]})}),S.jsx("tbody",{children:c.results.map(e=>S.jsxs("tr",{children:[S.jsx("td",{children:e.date_operation}),S.jsx("td",{children:e.categorie_code}),S.jsx("td",{children:Ps(e.montant_depense)}),S.jsx("td",{children:e.description||"-"})]},e.id))})]})]}):S.jsxs("div",{className:"card",children:[S.jsx("h2",{children:"Oprations Rcentes"}),S.jsxs("p",{style:{color:"var(--text-secondary)",textAlign:"center",padding:"2rem"},children:["Aucune opration enregistre.",S.jsx("br",{}),S.jsx(n,{to:"/operations",style:{color:"var(--primary-color)",textDecoration:"none"},children:"Crer une nouvelle opration"})]})]})]})},Us=({operation:t,onClose:r,onSuccess:s})=>{var n;const[a,i]=e.useState({date_operation:As(new Date,"yyyy-MM-dd"),categorie:"",sous_categorie:"",unites:"",prix_unitaire:"",description:""}),o=p(),{data:l,error:d,isLoading:c}=m("categories",async()=>(await dr.get("/api/categories/")).data,{retry:1,onError:e=>{}}),{data:u}=m(["sous-categories",a.categorie],async()=>{if(!a.categorie)return[];return(await dr.get(`/api/sous-categories/?categorie=${a.categorie}`)).data},{enabled:!!a.categorie});e.useEffect(()=>{t&&i({date_operation:t.date_operation,categorie:t.categorie,sous_categorie:t.sous_categorie||"",unites:t.unites,prix_unitaire:t.prix_unitaire,description:t.description||""})},[t]);const f=h(e=>t?dr.put(`/api/operations/${t.id}/`,e):dr.post("/api/operations/",e),{onSuccess:()=>{ne.success(t?"Opration modifie":"Opration cre"),o.invalidateQueries("operations"),null==s||s()},onError:e=>{var t,r;const s=(null==(r=null==(t=e.response)?void 0:t.data)?void 0:r.detail)||"Erreur lors de la sauvegarde";ne.error(s)}}),x=a.unites&&a.prix_unitaire?parseFloat(a.unites)*parseFloat(a.prix_unitaire):0;return S.jsx("div",{className:"modal-overlay",onClick:r,children:S.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[S.jsxs("div",{className:"modal-header",children:[S.jsxs("h2",{children:[t?"Modifier":"Nouvelle"," Opration"]}),S.jsx("button",{onClick:r,className:"modal-close",children:""})]}),S.jsxs("form",{onSubmit:e=>{e.preventDefault(),a.categorie?!a.unites||parseFloat(a.unites)<=0?ne.error("Le nombre d'units doit tre suprieur  0"):!a.prix_unitaire||parseFloat(a.prix_unitaire)<=0?ne.error("Le prix unitaire doit tre suprieur  0"):f.mutate(a):ne.error("Veuillez slectionner une catgorie")},children:[S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Date de l'opration *"}),S.jsx("input",{type:"date",className:"form-input",value:a.date_operation,onChange:e=>i({...a,date_operation:e.target.value}),required:!0})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Catgorie *"}),d?S.jsx("div",{style:{padding:"0.75rem",backgroundColor:"#fff3cd",border:"1px solid #ffc107",borderRadius:"4px",color:"#856404"},children:"Erreur lors du chargement des catgories. Vrifiez votre connexion et ressayez."}):S.jsxs("select",{className:"form-select",value:a.categorie,onChange:e=>i({...a,categorie:e.target.value,sous_categorie:""}),required:!0,disabled:c,children:[S.jsx("option",{value:"",children:c?"Chargement...":"Slectionner une catgorie"}),(null==(n=null==l?void 0:l.results)?void 0:n.map(e=>S.jsxs("option",{value:e.id,children:[e.code," - ",e.nom]},e.id)))||(null==l?void 0:l.map(e=>S.jsxs("option",{value:e.id,children:[e.code," - ",e.nom]},e.id)))]})]}),a.categorie&&u&&u.length>0&&S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Sous-catgorie"}),S.jsxs("select",{className:"form-select",value:a.sous_categorie,onChange:e=>i({...a,sous_categorie:e.target.value}),children:[S.jsx("option",{value:"",children:"Aucune"}),u.map(e=>S.jsx("option",{value:e.id,children:e.nom},e.id))]})]}),S.jsxs("div",{className:"form-row",children:[S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Units *"}),S.jsx("input",{type:"number",step:"0.01",min:"0.01",className:"form-input",value:a.unites,onChange:e=>i({...a,unites:e.target.value}),required:!0})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Prix Unitaire (GNF) *"}),S.jsx("input",{type:"number",step:"0.01",min:"0.01",className:"form-input",value:a.prix_unitaire,onChange:e=>i({...a,prix_unitaire:e.target.value}),required:!0})]})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Montant Total (calcul automatiquement)"}),S.jsx("div",{className:"calculated-amount",children:Ps(x)})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Description"}),S.jsx("textarea",{className:"form-textarea",value:a.description,onChange:e=>i({...a,description:e.target.value}),rows:3})]}),S.jsxs("div",{className:"modal-actions",children:[S.jsx("button",{type:"button",onClick:r,className:"btn btn-secondary",children:"Annuler"}),S.jsx("button",{type:"submit",className:"btn btn-primary",disabled:f.isLoading,children:f.isLoading?"Enregistrement...":"Enregistrer"})]})]})]})})},Is=()=>{var t,r,s,n;const[a,i]=e.useState(!1),[o,l]=e.useState(null),[d,c]=e.useState({date_debut:"",date_fin:"",categorie:""}),u=p(),{data:f,isLoading:x,error:g,refetch:v}=m(["operations",d],async()=>{const e=new URLSearchParams;d.date_debut&&e.append("date_operation_after",d.date_debut),d.date_fin&&e.append("date_operation_before",d.date_fin),d.categorie&&e.append("categorie",d.categorie);return(await dr.get(`/api/operations/?${e.toString()}`)).data},{retry:1,onError:e=>{}}),j=h(e=>dr.delete(`/api/operations/${e}/`),{onSuccess:()=>{ne.success("Opration supprime"),u.invalidateQueries("operations")},onError:()=>ne.error("Erreur lors de la suppression")}),b=h(async()=>{const e=new URLSearchParams;d.date_debut&&e.append("date_debut",d.date_debut),d.date_fin&&e.append("date_fin",d.date_fin),d.categorie&&e.append("categorie",d.categorie);const t=await dr.get(`/api/operations/export_excel/?${e.toString()}`,{responseType:"blob"}),r=window.URL.createObjectURL(new Blob([t.data])),s=document.createElement("a");s.href=r,s.setAttribute("download",`operations_${As(new Date,"yyyy-MM-dd")}.xlsx`),document.body.appendChild(s),s.click(),s.remove()},{onSuccess:()=>ne.success("Export Excel russi"),onError:e=>{var t,r,s,n;const a=(null==(r=null==(t=e.response)?void 0:t.data)?void 0:r.error)||(null==(n=null==(s=e.response)?void 0:s.data)?void 0:n.detail)||"Erreur lors de l'export (vrifiez l'authentification et le serveur backend).";ne.error(a)}}),y=h(async()=>{const e=new URLSearchParams;d.date_debut&&e.append("date_debut",d.date_debut),d.date_fin&&e.append("date_fin",d.date_fin),d.categorie&&e.append("categorie",d.categorie);const t=await dr.get(`/api/operations/export_pdf/?${e.toString()}`,{responseType:"blob"}),r=window.URL.createObjectURL(new Blob([t.data])),s=document.createElement("a");s.href=r,s.setAttribute("download",`operations_${As(new Date,"yyyy-MM-dd")}.pdf`),document.body.appendChild(s),s.click(),s.remove()},{onSuccess:()=>ne.success("Export PDF russi"),onError:e=>{var t,r,s,n;const a=(null==(r=null==(t=e.response)?void 0:t.data)?void 0:r.error)||(null==(n=null==(s=e.response)?void 0:s.data)?void 0:n.detail)||"Erreur lors de l'export PDF (vrifiez l'authentification et le serveur backend).";ne.error(a)}}),N=()=>{i(!1),l(null)};return x?S.jsx("div",{className:"loading",children:S.jsx("div",{className:"spinner"})}):g?S.jsxs("div",{className:"operations",children:[S.jsx("div",{className:"page-header",children:S.jsx("h1",{children:"Oprations"})}),S.jsxs("div",{className:"card",style:{backgroundColor:"#fff3cd",border:"1px solid #ffc107",padding:"1.5rem"},children:[S.jsx("h3",{style:{color:"#856404",marginTop:0},children:" Erreur lors du chargement des oprations"}),S.jsxs("p",{style:{color:"#856404",margin:"0.5rem 0"},children:[S.jsx("strong",{children:"Message:"})," ",(null==(r=null==(t=g.response)?void 0:t.data)?void 0:r.detail)||g.message||"Erreur inconnue"]}),(null==(s=g.response)?void 0:s.status)&&S.jsxs("p",{style:{color:"#856404",margin:"0.5rem 0"},children:[S.jsx("strong",{children:"Code HTTP:"})," ",g.response.status]}),S.jsxs("div",{style:{marginTop:"1rem",padding:"1rem",backgroundColor:"#f8f9fa",borderRadius:"4px"},children:[S.jsx("p",{style:{color:"#495057",margin:"0 0 0.5rem 0",fontWeight:"bold"},children:"Solutions possibles:"}),S.jsxs("ul",{style:{color:"#495057",margin:0,paddingLeft:"1.5rem"},children:[S.jsxs("li",{children:["Vrifiez que le serveur Django est dmarr sur ",S.jsx("code",{children:"http://localhost:8000"})]}),S.jsx("li",{children:"Vrifiez que vous tes bien authentifi (connectez-vous si ncessaire)"}),S.jsx("li",{children:"Vrifiez la console du navigateur (F12) pour plus de dtails"}),401===(null==(n=g.response)?void 0:n.status)&&S.jsx("li",{style:{color:"#dc3545",fontWeight:"bold"},children:"Erreur d'authentification: Reconnectez-vous"})]})]}),S.jsx("button",{onClick:()=>v(),className:"btn btn-primary",style:{marginTop:"1rem"},children:"Ressayer"})]})]}):S.jsxs("div",{className:"operations",children:[S.jsxs("div",{className:"page-header",children:[S.jsx("h1",{children:"Oprations"}),S.jsxs("div",{className:"page-actions",children:[S.jsx("button",{type:"button",onClick:()=>b.mutate(),className:"btn btn-secondary",disabled:b.isLoading,children:b.isLoading?"Export en cours...":" Exporter Excel"}),S.jsx("button",{type:"button",onClick:()=>y.mutate(),className:"btn btn-secondary",disabled:y.isLoading,style:{marginLeft:"0.5rem"},children:y.isLoading?"Export en cours...":" Exporter PDF"}),S.jsx("button",{type:"button",onClick:()=>{l(null),i(!0)},className:"btn btn-primary",children:" Nouvelle Opration"})]})]}),S.jsxs("div",{className:"card",children:[S.jsx("h2",{children:"Filtres"}),S.jsxs("div",{className:"filters",children:[S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Date dbut"}),S.jsx("input",{type:"date",className:"form-input",value:d.date_debut,onChange:e=>c({...d,date_debut:e.target.value})})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Date fin"}),S.jsx("input",{type:"date",className:"form-input",value:d.date_fin,onChange:e=>c({...d,date_fin:e.target.value})})]}),S.jsx("div",{className:"form-group",children:S.jsx("button",{onClick:()=>c({date_debut:"",date_fin:"",categorie:""}),className:"btn btn-secondary",children:"Rinitialiser"})})]})]}),S.jsxs("div",{className:"card",children:[S.jsx("h2",{children:"Liste des Oprations"}),(null==f?void 0:f.results)&&f.results.length>0?S.jsxs("table",{className:"table",children:[S.jsx("thead",{children:S.jsxs("tr",{children:[S.jsx("th",{children:"Date"}),S.jsx("th",{children:"Catgorie"}),S.jsx("th",{children:"Sous-Catgorie"}),S.jsx("th",{children:"Units"}),S.jsx("th",{children:"Prix Unitaire"}),S.jsx("th",{children:"Montant"}),S.jsx("th",{children:"Description"}),S.jsx("th",{children:"Actions"})]})}),S.jsx("tbody",{children:f.results.map(e=>S.jsxs("tr",{children:[S.jsx("td",{children:e.date_operation}),S.jsxs("td",{children:[e.categorie_code," - ",e.categorie_nom]}),S.jsx("td",{children:e.sous_categorie_nom||"-"}),S.jsx("td",{children:parseFloat(e.unites).toFixed(2)}),S.jsx("td",{children:Ps(e.prix_unitaire)}),S.jsx("td",{children:S.jsx("strong",{children:Ps(e.montant_depense)})}),S.jsx("td",{children:e.description||"-"}),S.jsxs("td",{children:[S.jsx("button",{onClick:()=>(l(e),void i(!0)),className:"btn btn-secondary",style:{marginRight:"0.5rem",padding:"0.25rem 0.5rem",fontSize:"0.75rem"},children:""}),S.jsx("button",{onClick:()=>{window.confirm("Supprimer cette opration ?")&&j.mutate(e.id)},className:"btn btn-secondary",style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem"},children:""})]})]},e.id))})]}):S.jsxs("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-secondary)"},children:[S.jsx("p",{children:"Aucune opration trouve."}),S.jsx("p",{style:{marginTop:"0.5rem",fontSize:"0.875rem"},children:'Cliquez sur "Nouvelle Opration" pour crer votre premire opration.'})]})]}),a&&S.jsx(Us,{operation:o,onClose:N,onSuccess:()=>{N(),v()}})]})},zs=({prevision:t,onClose:r,onSuccess:s})=>{var n;const[a,i]=e.useState({mois:As(new Date,"yyyy-MM"),categorie:"",sous_categorie:"",montant_prevu:"",statut:"draft"}),o=p(),{data:l,error:d,isLoading:c}=m("categories",async()=>(await dr.get("/api/categories/")).data,{retry:1,onError:e=>{}}),{data:u}=m(["sous-categories",a.categorie],async()=>{if(!a.categorie)return[];return(await dr.get(`/api/sous-categories/?categorie=${a.categorie}`)).data},{enabled:!!a.categorie});e.useEffect(()=>{t&&i({mois:As(new Date(t.mois),"yyyy-MM"),categorie:t.categorie,sous_categorie:t.sous_categorie||"",montant_prevu:t.montant_prevu,statut:t.statut||"draft"})},[t]);const f=h(e=>{const r=new Date(e.mois+"-01"),s={...e,mois:As(r,"yyyy-MM-dd")};return t?dr.put(`/api/previsions/${t.id}/`,s):dr.post("/api/previsions/",s)},{onSuccess:()=>{ne.success(t?"Prvision modifie":"Prvision cre"),o.invalidateQueries("previsions"),null==s||s()},onError:e=>{var t,r,s,n;const a=(null==(r=null==(t=e.response)?void 0:t.data)?void 0:r.detail)||(null==(n=null==(s=e.response)?void 0:s.data)?void 0:n.error)||"Erreur lors de la sauvegarde";ne.error(a)}});return S.jsx("div",{className:"modal-overlay",onClick:r,children:S.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[S.jsxs("div",{className:"modal-header",children:[S.jsxs("h2",{children:[t?"Modifier":"Nouvelle"," Prvision"]}),S.jsx("button",{onClick:r,className:"modal-close",children:""})]}),S.jsxs("form",{onSubmit:e=>{e.preventDefault(),a.categorie?!a.montant_prevu||parseFloat(a.montant_prevu)<=0?ne.error("Le montant prvu doit tre suprieur  0"):f.mutate(a):ne.error("Veuillez slectionner une catgorie")},children:[S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Mois *"}),S.jsx("input",{type:"month",className:"form-input",value:a.mois,onChange:e=>i({...a,mois:e.target.value}),required:!0})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Catgorie *"}),d?S.jsx("div",{style:{padding:"0.75rem",backgroundColor:"#fff3cd",border:"1px solid #ffc107",borderRadius:"4px",color:"#856404"},children:"Erreur lors du chargement des catgories. Vrifiez votre connexion et ressayez."}):S.jsxs("select",{className:"form-select",value:a.categorie,onChange:e=>i({...a,categorie:e.target.value,sous_categorie:""}),required:!0,disabled:c,children:[S.jsx("option",{value:"",children:c?"Chargement...":"Slectionner une catgorie"}),(null==(n=null==l?void 0:l.results)?void 0:n.map(e=>S.jsxs("option",{value:e.id,children:[e.code," - ",e.nom]},e.id)))||(null==l?void 0:l.map(e=>S.jsxs("option",{value:e.id,children:[e.code," - ",e.nom]},e.id)))]})]}),a.categorie&&u&&u.length>0&&S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Sous-catgorie"}),S.jsxs("select",{className:"form-select",value:a.sous_categorie,onChange:e=>i({...a,sous_categorie:e.target.value}),children:[S.jsx("option",{value:"",children:"Aucune"}),u.map(e=>S.jsx("option",{value:e.id,children:e.nom},e.id))]})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Montant Prvu (GNF) *"}),S.jsx("input",{type:"number",step:"0.01",min:"0.01",className:"form-input",value:a.montant_prevu,onChange:e=>i({...a,montant_prevu:e.target.value}),required:!0})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Statut"}),S.jsxs("select",{className:"form-select",value:a.statut,onChange:e=>i({...a,statut:e.target.value}),children:[S.jsx("option",{value:"draft",children:"Brouillon"}),S.jsx("option",{value:"validated",children:"Valide"}),S.jsx("option",{value:"closed",children:"Clture"})]})]}),S.jsxs("div",{className:"modal-actions",children:[S.jsx("button",{type:"button",onClick:r,className:"btn btn-secondary",children:"Annuler"}),S.jsx("button",{type:"submit",className:"btn btn-primary",disabled:f.isLoading,children:f.isLoading?"Enregistrement...":"Enregistrer"})]})]})]})})},Bs=()=>{var t;const[r,s]=e.useState(!1),[n,a]=e.useState(null),[i,o]=e.useState({mois:As(new Date,"yyyy-MM"),statut:""}),l=p(),{data:d,isLoading:c}=m(["previsions",i],async()=>{const e=new URLSearchParams;if(i.mois){const t=new Date(i.mois+"-01");e.append("mois",As(t,"yyyy-MM-dd"))}i.statut&&e.append("statut",i.statut);return(await dr.get(`/api/previsions/?${e.toString()}`)).data}),{data:u}=m("categories",async()=>(await dr.get("/api/categories/")).data),f=h(e=>dr.delete(`/api/previsions/${e}/`),{onSuccess:()=>{ne.success("Prvision supprime"),l.invalidateQueries("previsions")},onError:()=>ne.error("Erreur lors de la suppression")});return S.jsxs("div",{className:"previsions",children:[S.jsxs("div",{className:"page-header",children:[S.jsx("h1",{children:"Prvisions"}),S.jsx("div",{className:"page-actions",children:S.jsx("button",{type:"button",onClick:()=>{a(null),s(!0)},className:"btn btn-primary",children:" Nouvelle Prvision"})})]}),S.jsxs("div",{className:"card",children:[S.jsx("h2",{children:"Filtres"}),S.jsxs("div",{className:"filters",children:[S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Mois"}),S.jsx("input",{type:"month",className:"form-input",value:i.mois,onChange:e=>o({...i,mois:e.target.value})})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Statut"}),S.jsxs("select",{className:"form-select",value:i.statut,onChange:e=>o({...i,statut:e.target.value}),children:[S.jsx("option",{value:"",children:"Tous"}),S.jsx("option",{value:"draft",children:"Brouillon"}),S.jsx("option",{value:"validated",children:"Valide"}),S.jsx("option",{value:"closed",children:"Clture"})]})]})]})]}),c?S.jsx("div",{className:"loading",children:S.jsx("div",{className:"spinner"})}):S.jsxs("div",{className:"card",children:[S.jsx("h2",{children:"Liste des Prvisions"}),S.jsxs("table",{className:"table",children:[S.jsx("thead",{children:S.jsxs("tr",{children:[S.jsx("th",{children:"Mois"}),S.jsx("th",{children:"Catgorie"}),S.jsx("th",{children:"Sous-Catgorie"}),S.jsx("th",{children:"Montant Prvu"}),S.jsx("th",{children:"Montant Imput"}),S.jsx("th",{children:"Solde Restant"}),S.jsx("th",{children:"Statut"}),S.jsx("th",{children:"Actions"})]})}),S.jsx("tbody",{children:null==(t=null==d?void 0:d.results)?void 0:t.map(e=>S.jsxs("tr",{children:[S.jsx("td",{children:As(new Date(e.mois),"MM/yyyy")}),S.jsxs("td",{children:[e.categorie_code," - ",e.categorie_nom]}),S.jsx("td",{children:e.sous_categorie_nom||"-"}),S.jsx("td",{children:Ps(e.montant_prevu)}),S.jsx("td",{children:Ps(e.montant_impute)}),S.jsx("td",{className:e.solde_restant<0?"negative":"",children:Ps(e.solde_restant)}),S.jsx("td",{children:S.jsx("span",{className:"badge badge-"+("validated"===e.statut?"success":"closed"===e.statut?"warning":"secondary"),children:"validated"===e.statut?"Valide":"closed"===e.statut?"Clture":"Brouillon"})}),S.jsx("td",{children:S.jsx("button",{onClick:()=>{window.confirm("Supprimer cette prvision ?")&&f.mutate(e.id)},className:"btn btn-secondary",style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem"},children:""})})]},e.id))})]})]}),r&&S.jsx(zs,{prevision:n,onClose:()=>{s(!1),a(null)},onSuccess:()=>{s(!1),a(null),l.invalidateQueries("previsions")}})]})},Fs=()=>{const[t,r]=e.useState(As(new Date,"yyyy-MM")),{data:s,isLoading:n}=m(["rapport",t],async()=>(await dr.get(`/api/rapports/mensuel/?mois=${t}`)).data,{enabled:!!t});return n?S.jsx("div",{className:"loading",children:S.jsx("div",{className:"spinner"})}):S.jsxs("div",{className:"rapports",children:[S.jsxs("div",{className:"page-header",children:[S.jsx("h1",{children:"Rapports Mensuels"}),S.jsxs("div",{className:"page-actions",children:[S.jsx("input",{type:"month",className:"form-input",value:t,onChange:e=>r(e.target.value),style:{width:"auto",marginRight:"1rem"}}),S.jsx("button",{onClick:async()=>{try{const e=await dr.get(`/api/rapports/export_pdf/?mois=${t}`,{responseType:"blob"}),r=window.URL.createObjectURL(new Blob([e.data])),s=document.createElement("a");s.href=r,s.setAttribute("download",`rapport_${t}.pdf`),document.body.appendChild(s),s.click(),s.remove(),ne.success("Export PDF russi")}catch(e){ne.error("Erreur lors de l'export PDF")}},className:"btn btn-secondary",children:" Exporter PDF"}),S.jsx("button",{onClick:async()=>{try{const e=await dr.get(`/api/rapports/export_excel/?mois=${t}`,{responseType:"blob"}),r=window.URL.createObjectURL(new Blob([e.data])),s=document.createElement("a");s.href=r,s.setAttribute("download",`rapport_${t}.xlsx`),document.body.appendChild(s),s.click(),s.remove(),ne.success("Export Excel russi")}catch(e){ne.error("Erreur lors de l'export Excel")}},className:"btn btn-success",children:" Exporter Excel"})]})]}),s&&S.jsxs(S.Fragment,{children:[S.jsxs("div",{className:"stats-grid",children:[S.jsxs("div",{className:"stat-card",children:[S.jsx("div",{className:"stat-label",children:"Total Dpenses"}),S.jsx("div",{className:"stat-value",children:Ps(s.total_depenses)})]}),S.jsxs("div",{className:"stat-card",children:[S.jsx("div",{className:"stat-label",children:"Total Prvu"}),S.jsx("div",{className:"stat-value",children:Ps(s.total_prevu)})]}),S.jsxs("div",{className:"stat-card",children:[S.jsx("div",{className:"stat-label",children:"cart Global"}),S.jsx("div",{className:"stat-value "+(s.ecart_global<0?"negative":"positive"),children:Ps(s.ecart_global)})]}),S.jsxs("div",{className:"stat-card",children:[S.jsx("div",{className:"stat-label",children:"Moyenne Journalire"}),S.jsx("div",{className:"stat-value",children:Ps(s.moyenne_journaliere)})]}),S.jsxs("div",{className:"stat-card",children:[S.jsx("div",{className:"stat-label",children:"Nombre d'Oprations"}),S.jsx("div",{className:"stat-value",children:s.nombre_operations})]}),S.jsxs("div",{className:"stat-card",children:[S.jsx("div",{className:"stat-label",children:"Nombre de Jours"}),S.jsx("div",{className:"stat-value",children:s.nombre_jours})]})]}),S.jsxs("div",{className:"card",children:[S.jsx("h2",{children:"Dtails par Catgorie"}),S.jsxs("table",{className:"table",children:[S.jsx("thead",{children:S.jsxs("tr",{children:[S.jsx("th",{children:"Catgorie"}),S.jsx("th",{children:"Total Dpens"}),S.jsx("th",{children:"Montant Prvu"}),S.jsx("th",{children:"cart"}),S.jsx("th",{children:"Nombre d'Oprations"})]})}),S.jsx("tbody",{children:s.categories.map(e=>S.jsxs("tr",{children:[S.jsxs("td",{children:[e.categorie_code," - ",e.categorie_nom]}),S.jsx("td",{children:Ps(e.total_depense)}),S.jsx("td",{children:Ps(e.montant_prevu)}),S.jsx("td",{className:e.ecart<0?"negative":"positive",children:Ps(e.ecart)}),S.jsx("td",{children:e.nombre_operations})]},e.categorie_code))})]})]})]})]})},qs=()=>{var e,t,r;const{data:s,isLoading:n,error:a}=m("imputations",async()=>(await dr.get("/api/imputations/")).data,{retry:1,onError:e=>{}});return n?S.jsx("div",{className:"loading",children:S.jsx("div",{className:"spinner"})}):a?S.jsxs("div",{className:"imputations",children:[S.jsx("h1",{children:"Imputations"}),S.jsxs("div",{className:"card",style:{backgroundColor:"#fff3cd",border:"1px solid #ffc107",padding:"1.5rem"},children:[S.jsx("h3",{style:{color:"#856404",marginTop:0},children:" Erreur lors du chargement des imputations"}),S.jsxs("p",{style:{color:"#856404",margin:"0.5rem 0"},children:[S.jsx("strong",{children:"Message:"})," ",(null==(t=null==(e=a.response)?void 0:e.data)?void 0:t.detail)||a.message||"Erreur inconnue"]}),401===(null==(r=a.response)?void 0:r.status)&&S.jsx("p",{style:{color:"#dc3545",fontWeight:"bold",marginTop:"1rem"},children:"Erreur d'authentification: Reconnectez-vous"})]})]}):S.jsxs("div",{className:"imputations",children:[S.jsx("h1",{children:"Imputations"}),S.jsxs("div",{className:"card",children:[S.jsx("h2",{children:"Liste des Imputations"}),(null==s?void 0:s.results)&&s.results.length>0?S.jsxs("table",{className:"table",children:[S.jsx("thead",{children:S.jsxs("tr",{children:[S.jsx("th",{children:"Opration"}),S.jsx("th",{children:"Date Opration"}),S.jsx("th",{children:"Prvision"}),S.jsx("th",{children:"Mois Prvision"}),S.jsx("th",{children:"Montant Imput"}),S.jsx("th",{children:"Cr le"})]})}),S.jsx("tbody",{children:s.results.map(e=>S.jsxs("tr",{children:[S.jsxs("td",{children:["#",e.operation]}),S.jsx("td",{children:e.operation_date}),S.jsx("td",{children:e.prevision_categorie}),S.jsx("td",{children:e.prevision_mois}),S.jsx("td",{children:Ps(e.montant_impute)}),S.jsx("td",{children:new Date(e.created_at).toLocaleDateString("fr-FR")})]},e.id))})]}):S.jsxs("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-secondary)"},children:[S.jsx("p",{style:{fontSize:"1.1rem",marginBottom:"1rem"},children:"Aucune imputation trouve."}),S.jsxs("div",{style:{backgroundColor:"#e7f3ff",padding:"1rem",borderRadius:"4px",marginTop:"1rem"},children:[S.jsx("p",{style:{margin:"0.5rem 0",fontSize:"0.9rem"},children:S.jsx("strong",{children:" Comment crer des imputations ?"})}),S.jsxs("ol",{style:{textAlign:"left",display:"inline-block",margin:"0.5rem 0",paddingLeft:"1.5rem"},children:[S.jsxs("li",{style:{marginBottom:"0.5rem"},children:["Crez d'abord une ",S.jsx("strong",{children:"prvision"})," pour le mois et la catgorie souhaits"]}),S.jsxs("li",{style:{marginBottom:"0.5rem"},children:["Ensuite, crez une ",S.jsx("strong",{children:"opration"})," avec la mme catgorie et le mme mois"]}),S.jsxs("li",{children:["L'",S.jsx("strong",{children:"imputation"})," sera cre automatiquement entre l'opration et la prvision"]})]})]})]})]})]})},Ws=()=>{var t,r;const{user:s}=Er(),n=p(),[a,i]=e.useState(!1),[o,l]=e.useState(!1),[d,c]=e.useState(null),[u,f]=e.useState(null),[x,g]=e.useState({code:"",nom:"",description:""}),[v,j]=e.useState({categorie:"",nom:"",description:""}),{data:b,isLoading:y,error:N}=m("categories",async()=>{try{return(await dr.get("/api/categories/")).data}catch(e){throw e}},{enabled:!!s,retry:1,onError:e=>{var t;401===(null==(t=e.response)?void 0:t.status)?ne.error("Vous devez tre connect pour voir les catgories"):ne.error(`Erreur lors du chargement des catgories: ${e.message}`)}}),{data:w,isLoading:_,error:C}=m("sous-categories",async()=>{try{return(await dr.get("/api/sous-categories/")).data}catch(e){throw e}},{enabled:!!s,retry:1,onError:e=>{var t;401===(null==(t=e.response)?void 0:t.status)?ne.error("Vous devez tre connect pour voir les sous-catgories"):ne.error(`Erreur lors du chargement des sous-catgories: ${e.message}`)}}),E=h(e=>d?dr.put(`/api/categories/${d.id}/`,e):dr.post("/api/categories/",e),{onSuccess:()=>{ne.success(d?"Catgorie modifie":"Catgorie cre"),n.invalidateQueries("categories"),R()},onError:e=>{var t,r,s,n,a;const i=(null==(r=null==(t=e.response)?void 0:t.data)?void 0:r.detail)||(null==(a=null==(n=null==(s=e.response)?void 0:s.data)?void 0:n.code)?void 0:a[0])||"Erreur lors de la sauvegarde";ne.error(i)}}),T=h(e=>dr.delete(`/api/categories/${e}/`),{onSuccess:()=>{ne.success("Catgorie supprime"),n.invalidateQueries("categories"),n.invalidateQueries("sous-categories")},onError:e=>{var t,r;const s=(null==(r=null==(t=e.response)?void 0:t.data)?void 0:r.detail)||"Erreur lors de la suppression";ne.error(s)}}),k=h(e=>u?dr.put(`/api/sous-categories/${u.id}/`,e):dr.post("/api/sous-categories/",e),{onSuccess:()=>{ne.success(u?"Sous-catgorie modifie":"Sous-catgorie cre"),n.invalidateQueries("sous-categories"),O()},onError:e=>{var t,r,s,n,a;const i=(null==(r=null==(t=e.response)?void 0:t.data)?void 0:r.detail)||(null==(a=null==(n=null==(s=e.response)?void 0:s.data)?void 0:n.nom)?void 0:a[0])||"Erreur lors de la sauvegarde";ne.error(i)}}),A=h(e=>dr.delete(`/api/sous-categories/${e}/`),{onSuccess:()=>{ne.success("Sous-catgorie supprime"),n.invalidateQueries("sous-categories")},onError:e=>{var t,r;const s=(null==(r=null==(t=e.response)?void 0:t.data)?void 0:r.detail)||"Erreur lors de la suppression";ne.error(s)}}),R=()=>{i(!1),c(null),g({code:"",nom:"",description:""})},O=()=>{l(!1),f(null),j({categorie:"",nom:"",description:""})};return y||_?S.jsxs("div",{className:"categories",children:[S.jsxs("div",{className:"breadcrumbs",children:[S.jsx("span",{children:"Accueil"}),S.jsx("span",{className:"breadcrumb-separator",children:""}),S.jsx("span",{className:"breadcrumb-current",children:"Catgories"})]}),S.jsx("div",{className:"page-header",children:S.jsx("h1",{children:" Catgories et Sous-Catgories"})}),S.jsx("div",{className:"loading",children:S.jsx("div",{className:"spinner"})})]}):N||C?S.jsxs("div",{className:"categories",children:[S.jsxs("div",{className:"breadcrumbs",children:[S.jsx("span",{children:"Accueil"}),S.jsx("span",{className:"breadcrumb-separator",children:""}),S.jsx("span",{className:"breadcrumb-current",children:"Catgories"})]}),S.jsx("div",{className:"page-header",children:S.jsx("h1",{children:" Catgories et Sous-Catgories"})}),S.jsx("div",{className:"card",style:{padding:"2rem",textAlign:"center"},children:S.jsxs("p",{style:{color:"#dc3545",fontSize:"1.1rem"},children:["Erreur lors du chargement des donnes.",401===(null==(t=null==N?void 0:N.response)?void 0:t.status)||401===(null==(r=null==C?void 0:C.response)?void 0:r.status)?S.jsx("span",{children:" Veuillez vous connecter."}):S.jsx("span",{children:" Veuillez ressayer plus tard."})]})})]}):S.jsxs("div",{className:"categories",children:[S.jsxs("div",{className:"breadcrumbs",children:[S.jsx("span",{children:"Accueil"}),S.jsx("span",{className:"breadcrumb-separator",children:""}),S.jsx("span",{className:"breadcrumb-current",children:"Catgories"})]}),S.jsx("div",{className:"page-header",children:S.jsx("h1",{children:" Catgories et Sous-Catgories"})}),S.jsxs("div",{className:"card",children:[S.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[S.jsx("h2",{children:"Catgories"}),S.jsx("button",{onClick:()=>i(!0),className:"btn btn-primary",style:{padding:"0.5rem 1rem",fontSize:"0.9rem"},children:" Nouvelle Catgorie"})]}),b&&b.length>0?S.jsxs("table",{className:"table",children:[S.jsx("thead",{children:S.jsxs("tr",{children:[S.jsx("th",{children:"Code"}),S.jsx("th",{children:"Nom"}),S.jsx("th",{children:"Description"}),S.jsx("th",{style:{width:"120px"},children:"Actions"})]})}),S.jsx("tbody",{children:b.map(e=>S.jsxs("tr",{children:[S.jsx("td",{children:S.jsx("strong",{children:e.code})}),S.jsx("td",{children:e.nom}),S.jsx("td",{children:e.description||"-"}),S.jsxs("td",{children:[S.jsx("button",{onClick:()=>{return c(t=e),g({code:t.code,nom:t.nom,description:t.description||""}),void i(!0);var t},className:"btn btn-sm btn-secondary",style:{marginRight:"0.5rem"},children:""}),S.jsx("button",{onClick:()=>{window.confirm(`tes-vous sr de vouloir supprimer la catgorie "${e.nom}" ?`)&&T.mutate(e.id)},className:"btn btn-sm btn-danger",children:""})]})]},e.id))})]}):S.jsx("p",{style:{padding:"1rem",textAlign:"center",color:"#666"},children:"Aucune catgorie trouve."})]}),S.jsxs("div",{className:"card",children:[S.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[S.jsx("h2",{children:"Sous-Catgories"}),S.jsx("button",{onClick:()=>l(!0),className:"btn btn-primary",style:{padding:"0.5rem 1rem",fontSize:"0.9rem"},children:" Nouvelle Sous-Catgorie"})]}),w&&(w.results||w).length>0?S.jsxs("table",{className:"table",children:[S.jsx("thead",{children:S.jsxs("tr",{children:[S.jsx("th",{children:"Catgorie"}),S.jsx("th",{children:"Nom"}),S.jsx("th",{children:"Description"}),S.jsx("th",{style:{width:"120px"},children:"Actions"})]})}),S.jsx("tbody",{children:(w.results||w).map(e=>S.jsxs("tr",{children:[S.jsxs("td",{children:[e.categorie_code," - ",e.categorie_nom]}),S.jsx("td",{children:e.nom}),S.jsx("td",{children:e.description||"-"}),S.jsxs("td",{children:[S.jsx("button",{onClick:()=>(e=>{f(e);const t=e.categorie_id||e.categorie;j({categorie:t,nom:e.nom,description:e.description||""}),l(!0)})(e),className:"btn btn-sm btn-secondary",style:{marginRight:"0.5rem"},children:""}),S.jsx("button",{onClick:()=>{window.confirm(`tes-vous sr de vouloir supprimer la sous-catgorie "${e.nom}" ?`)&&A.mutate(e.id)},className:"btn btn-sm btn-danger",children:""})]})]},e.id))})]}):S.jsx("p",{style:{padding:"1rem",textAlign:"center",color:"#666"},children:"Aucune sous-catgorie trouve."})]}),a&&S.jsx("div",{className:"modal-overlay",onClick:R,children:S.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[S.jsxs("div",{className:"modal-header",children:[S.jsxs("h2",{children:[d?"Modifier":"Nouvelle"," Catgorie"]}),S.jsx("button",{onClick:R,className:"modal-close",children:""})]}),S.jsxs("form",{onSubmit:e=>{e.preventDefault(),x.code&&x.nom?E.mutate(x):ne.error("Le code et le nom sont obligatoires")},children:[S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Code *"}),S.jsx("input",{type:"text",className:"form-input",value:x.code,onChange:e=>g({...x,code:e.target.value.toUpperCase()}),required:!0,placeholder:"Ex: REST, TRANS, etc."})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Nom *"}),S.jsx("input",{type:"text",className:"form-input",value:x.nom,onChange:e=>g({...x,nom:e.target.value}),required:!0,placeholder:"Ex: Restauration, Transport, etc."})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Description"}),S.jsx("textarea",{className:"form-input",value:x.description,onChange:e=>g({...x,description:e.target.value}),rows:"3",placeholder:"Description optionnelle de la catgorie"})]}),S.jsxs("div",{className:"form-actions",children:[S.jsx("button",{type:"button",onClick:R,className:"btn btn-secondary",children:"Annuler"}),S.jsx("button",{type:"submit",className:"btn btn-primary",disabled:E.isLoading,children:E.isLoading?"Enregistrement...":d?"Modifier":"Crer"})]})]})]})}),o&&S.jsx("div",{className:"modal-overlay",onClick:O,children:S.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[S.jsxs("div",{className:"modal-header",children:[S.jsxs("h2",{children:[u?"Modifier":"Nouvelle"," Sous-Catgorie"]}),S.jsx("button",{onClick:O,className:"modal-close",children:""})]}),S.jsxs("form",{onSubmit:e=>{e.preventDefault(),v.categorie&&v.nom?k.mutate(v):ne.error("La catgorie et le nom sont obligatoires")},children:[S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Catgorie *"}),S.jsxs("select",{className:"form-select",value:v.categorie,onChange:e=>j({...v,categorie:e.target.value}),required:!0,disabled:!b||0===b.length,children:[S.jsx("option",{value:"",children:b&&b.length>0?"Slectionner une catgorie":"Aucune catgorie disponible"}),null==b?void 0:b.map(e=>S.jsxs("option",{value:e.id,children:[e.code," - ",e.nom]},e.id))]})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Nom *"}),S.jsx("input",{type:"text",className:"form-input",value:v.nom,onChange:e=>j({...v,nom:e.target.value}),required:!0,placeholder:"Ex: Djeuner, Dner, etc."})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Description"}),S.jsx("textarea",{className:"form-input",value:v.description,onChange:e=>j({...v,description:e.target.value}),rows:"3",placeholder:"Description optionnelle de la sous-catgorie"})]}),S.jsxs("div",{className:"form-actions",children:[S.jsx("button",{type:"button",onClick:O,className:"btn btn-secondary",children:"Annuler"}),S.jsx("button",{type:"submit",className:"btn btn-primary",disabled:k.isLoading,children:k.isLoading?"Enregistrement...":u?"Modifier":"Crer"})]})]})]})})]})},$s=()=>{var t,r,s,n,a;const[i,o]=e.useState({action:"",date_debut:"",date_fin:"",model_name:""}),{data:l,isLoading:d,error:c}=m(["audit-logs",i],async()=>{const e=new URLSearchParams;i.action&&e.append("action",i.action),i.date_debut&&e.append("timestamp_after",i.date_debut),i.date_fin&&e.append("timestamp_before",i.date_fin),i.model_name&&e.append("model_name",i.model_name);try{return(await dr.get(`/api/audit/?${e.toString()}`)).data}catch(t){throw t}},{retry:1,onError:e=>{}}),u=e=>({create:"Cration",update:"Modification",delete:"Suppression",validate:"Validation",export:"Export",import:"Import"}[e]||e),p=h(async()=>{const e=new URLSearchParams;i.action&&e.append("action",i.action),i.date_debut&&e.append("timestamp_after",i.date_debut),i.date_fin&&e.append("timestamp_before",i.date_fin),i.model_name&&e.append("model_name",i.model_name);const t=await dr.get(`/api/audit/export_excel/?${e.toString()}`,{responseType:"blob"}),r=window.URL.createObjectURL(new Blob([t.data])),s=document.createElement("a");s.href=r;const n=`journaux_audit_${As(new Date,"yyyy-MM-dd")}.xlsx`;s.setAttribute("download",n),document.body.appendChild(s),s.click(),s.remove(),window.URL.revokeObjectURL(r)},{onSuccess:()=>{ne.success("Export Excel russi")},onError:e=>{var t,r,s,n;const a=(null==(r=null==(t=e.response)?void 0:t.data)?void 0:r.error)||(null==(n=null==(s=e.response)?void 0:s.data)?void 0:n.detail)||"Erreur lors de l'export Excel";ne.error(a)}}),f=h(async()=>{const e=new URLSearchParams;i.action&&e.append("action",i.action),i.date_debut&&e.append("timestamp_after",i.date_debut),i.date_fin&&e.append("timestamp_before",i.date_fin),i.model_name&&e.append("model_name",i.model_name);const t=await dr.get(`/api/audit/export_pdf/?${e.toString()}`,{responseType:"blob"}),r=window.URL.createObjectURL(new Blob([t.data])),s=document.createElement("a");s.href=r;const n=`journaux_audit_${As(new Date,"yyyy-MM-dd")}.pdf`;s.setAttribute("download",n),document.body.appendChild(s),s.click(),s.remove(),window.URL.revokeObjectURL(r)},{onSuccess:()=>{ne.success("Export PDF russi")},onError:e=>{var t,r,s,n;const a=(null==(r=null==(t=e.response)?void 0:t.data)?void 0:r.error)||(null==(n=null==(s=e.response)?void 0:s.data)?void 0:n.detail)||"Erreur lors de l'export PDF";ne.error(a)}});if(d)return S.jsx("div",{className:"loading",children:S.jsx("div",{className:"spinner"})});if(c){const e=(null==(r=null==(t=c.response)?void 0:t.data)?void 0:r.detail)||(null==(n=null==(s=c.response)?void 0:s.data)?void 0:n.message)||c.message||"Erreur inconnue",i=null==(a=c.response)?void 0:a.status;return S.jsxs("div",{className:"audit",children:[S.jsxs("div",{className:"breadcrumbs",children:[S.jsx("span",{children:"Accueil"}),S.jsx("span",{className:"breadcrumb-separator",children:""}),S.jsx("span",{className:"breadcrumb-current",children:"Audit et Traabilit"}),S.jsx("span",{className:"breadcrumb-separator",children:""}),S.jsx("span",{className:"breadcrumb-current",children:"Journaux d'Audit"})]}),S.jsxs("div",{className:"card",style:{backgroundColor:"#fff3cd",border:"1px solid #ffc107",padding:"1.5rem"},children:[S.jsx("h3",{style:{color:"#856404",marginTop:0},children:" Erreur lors du chargement des journaux d'audit"}),S.jsxs("p",{style:{color:"#856404",margin:"0.5rem 0"},children:[S.jsx("strong",{children:"Message:"})," ",e]}),i&&S.jsxs("p",{style:{color:"#856404",margin:"0.5rem 0"},children:[S.jsx("strong",{children:"Code HTTP:"})," ",i]}),S.jsxs("div",{style:{marginTop:"1rem",padding:"1rem",backgroundColor:"#f8f9fa",borderRadius:"4px"},children:[S.jsx("p",{style:{color:"#495057",margin:"0 0 0.5rem 0",fontWeight:"bold"},children:"Solutions possibles:"}),S.jsxs("ul",{style:{color:"#495057",margin:0,paddingLeft:"1.5rem"},children:[S.jsxs("li",{children:["Vrifiez que le serveur Django est dmarr sur ",S.jsx("code",{children:"http://localhost:8000"})]}),S.jsx("li",{children:"Vrifiez que vous tes bien authentifi (connectez-vous si ncessaire)"}),S.jsx("li",{children:"Vrifiez la console du navigateur (F12) pour plus de dtails"}),401===i&&S.jsx("li",{style:{color:"#dc3545",fontWeight:"bold"},children:"Erreur d'authentification: Reconnectez-vous"}),404===i&&S.jsx("li",{style:{color:"#dc3545",fontWeight:"bold"},children:"Endpoint non trouv: Vrifiez que l'API audit est bien configure"})]})]})]})]})}return S.jsxs("div",{className:"audit",children:[S.jsxs("div",{className:"breadcrumbs",children:[S.jsx("span",{children:"Accueil"}),S.jsx("span",{className:"breadcrumb-separator",children:""}),S.jsx("span",{className:"breadcrumb-current",children:"Audit et Traabilit"}),S.jsx("span",{className:"breadcrumb-separator",children:""}),S.jsx("span",{className:"breadcrumb-current",children:"Journaux d'Audit"})]}),S.jsx("div",{className:"page-header",children:S.jsx("h1",{children:"Slectionnez l'objet Journal d'Audit  afficher"})}),S.jsxs("div",{className:"card",children:[S.jsx("h2",{children:"Filtres"}),S.jsxs("div",{className:"filters-grid",children:[S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Par action"}),S.jsxs("select",{className:"form-select",value:i.action,onChange:e=>o({...i,action:e.target.value}),children:[S.jsx("option",{value:"",children:"Tous"}),S.jsx("option",{value:"create",children:"Cration"}),S.jsx("option",{value:"update",children:"Modification"}),S.jsx("option",{value:"delete",children:"Suppression"}),S.jsx("option",{value:"validate",children:"Validation"}),S.jsx("option",{value:"export",children:"Export"}),S.jsx("option",{value:"import",children:"Import"})]})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Par timestamp"}),S.jsxs("select",{className:"form-select",value:"",onChange:e=>{const t=new Date,r=e.target.value;if("today"===r)o({...i,date_debut:As(t,"yyyy-MM-dd"),date_fin:As(t,"yyyy-MM-dd")});else if("week"===r){const e=new Date(t);e.setDate(t.getDate()-7),o({...i,date_debut:As(e,"yyyy-MM-dd"),date_fin:As(t,"yyyy-MM-dd")})}else if("month"===r){const e=new Date(t.getFullYear(),t.getMonth(),1);o({...i,date_debut:As(e,"yyyy-MM-dd"),date_fin:As(t,"yyyy-MM-dd")})}else if("year"===r){const e=new Date(t.getFullYear(),0,1);o({...i,date_debut:As(e,"yyyy-MM-dd"),date_fin:As(t,"yyyy-MM-dd")})}else o({...i,date_debut:"",date_fin:""})},children:[S.jsx("option",{value:"",children:"Toutes les dates"}),S.jsx("option",{value:"today",children:"Aujourd'hui"}),S.jsx("option",{value:"week",children:"7 derniers jours"}),S.jsx("option",{value:"month",children:"Ce mois-ci"}),S.jsx("option",{value:"year",children:"Cette anne"})]})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Par model name"}),S.jsxs("select",{className:"form-select",value:i.model_name,onChange:e=>o({...i,model_name:e.target.value}),children:[S.jsx("option",{value:"",children:"Tous"}),S.jsx("option",{value:"Operation",children:"Operation"}),S.jsx("option",{value:"Prevision",children:"Prevision"}),S.jsx("option",{value:"Imputation",children:"Imputation"}),S.jsx("option",{value:"Categorie",children:"Categorie"}),S.jsx("option",{value:"SousCategorie",children:"SousCategorie"})]})]}),S.jsx("div",{className:"form-group",children:S.jsx("button",{onClick:()=>o({action:"",date_debut:"",date_fin:"",model_name:""}),className:"btn btn-secondary",children:"Rinitialiser"})})]})]}),S.jsxs("div",{className:"card",children:[S.jsxs("div",{className:"audit-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[S.jsxs("h2",{children:[(null==l?void 0:l.count)||0," Journaux d'Audit"]}),S.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[S.jsx("button",{onClick:()=>f.mutate(),className:"btn btn-secondary",disabled:f.isLoading,style:{padding:"0.5rem 1rem",fontSize:"0.9rem"},children:f.isLoading?" Export en cours...":" Exporter PDF"}),S.jsx("button",{onClick:()=>p.mutate(),className:"btn btn-primary",disabled:p.isLoading,style:{padding:"0.5rem 1rem",fontSize:"0.9rem"},children:p.isLoading?" Export en cours...":" Exporter Excel"})]})]}),l&&l.results&&l.results.length>0?S.jsxs("table",{className:"table",children:[S.jsx("thead",{children:S.jsxs("tr",{children:[S.jsx("th",{children:"Timestamp"}),S.jsx("th",{children:"Action"}),S.jsx("th",{children:"Utilisateur"}),S.jsx("th",{children:"Modle"}),S.jsx("th",{children:"Objet"}),S.jsx("th",{children:"IP"})]})}),S.jsx("tbody",{children:l.results.map(e=>{return S.jsxs("tr",{children:[S.jsx("td",{children:As(new Date(e.timestamp),"dd/MM/yyyy HH:mm:ss",{locale:Ds})}),S.jsx("td",{children:S.jsx("span",{className:`badge badge-${t=e.action,{create:"success",update:"warning",delete:"danger",validate:"info",export:"secondary",import:"secondary"}[t]||"secondary"}`,children:u(e.action)})}),S.jsx("td",{children:e.user||"-"}),S.jsx("td",{children:e.model_name||"-"}),S.jsx("td",{children:e.object_repr||"-"}),S.jsx("td",{children:e.ip_address||"-"})]},e.id);var t})})]}):S.jsx("p",{style:{color:"var(--text-secondary)",textAlign:"center",padding:"2rem"},children:"Aucun journal d'audit trouv."})]})]})},Vs=()=>{var t,r;const{user:s}=Er(),n=p(),[a,i]=e.useState(!1),[o,l]=e.useState(null),[d,c]=e.useState({username:"",email:"",first_name:"",last_name:"",password:"",is_staff:!1,is_superuser:!1,is_active:!0,permissions:{}}),u=[{code:"dashboard",label:"Tableau de bord",section:"GESTION DES DPENSES"},{code:"operations",label:"Oprations",section:"GESTION DES DPENSES"},{code:"previsions",label:"Prvisions",section:"GESTION DES DPENSES"},{code:"imputations",label:"Imputations",section:"GESTION DES DPENSES"},{code:"rapports",label:"Rapports",section:"GESTION DES DPENSES"},{code:"categories",label:"Catgories",section:"GESTION DES DPENSES"},{code:"utilisateurs",label:"Utilisateurs",section:"ADMINISTRATION"},{code:"audit",label:"Audit",section:"AUDIT ET TRAABILIT"},{code:"restauration_commandes",label:"Commander (Restauration)",section:"RESTAURATION / CANTINE"},{code:"restauration_valider_commandes",label:"Valider les Commandes (Restauration)",section:"RESTAURATION / CANTINE"},{code:"restauration_menus",label:"Menus (Restauration)",section:"RESTAURATION / CANTINE"},{code:"restauration_plats",label:"Plats (Restauration)",section:"RESTAURATION / CANTINE"},{code:"tableau_bord_cantine",label:"Tableau de Bord Cantine",section:"RESTAURATION / CANTINE"}],{data:f,isLoading:x,error:g}=m("users",async()=>{try{return(await dr.get("/api/users/")).data}catch(e){throw e}},{enabled:!!s&&s.is_superuser,retry:1,onError:e=>{var t,r;401===(null==(t=e.response)?void 0:t.status)?ne.error("Vous devez tre connect pour voir les utilisateurs"):403===(null==(r=e.response)?void 0:r.status)?ne.error("Vous n'avez pas les permissions ncessaires"):ne.error(`Erreur lors du chargement des utilisateurs: ${e.message}`)}}),v=h(e=>o?dr.put(`/api/users/${o.id}/`,e):dr.post("/api/users/",e),{onSuccess:()=>{ne.success(o?"Utilisateur modifi":"Utilisateur cr"),o&&ne.info("L'utilisateur devra se reconnecter pour voir ses nouvelles permissions."),n.invalidateQueries("users"),b()},onError:e=>{var t,r,s,n,a,i,o,l;const d=(null==(r=null==(t=e.response)?void 0:t.data)?void 0:r.detail)||(null==(a=null==(n=null==(s=e.response)?void 0:s.data)?void 0:n.username)?void 0:a[0])||(null==(l=null==(o=null==(i=e.response)?void 0:i.data)?void 0:o.email)?void 0:l[0])||"Erreur lors de la sauvegarde";ne.error(d)}}),j=h(e=>dr.delete(`/api/users/${e}/`),{onSuccess:()=>{ne.success("Utilisateur supprim"),n.invalidateQueries("users")},onError:e=>{var t,r;const s=(null==(r=null==(t=e.response)?void 0:t.data)?void 0:r.detail)||"Erreur lors de la suppression";ne.error(s)}}),b=()=>{i(!1),l(null),c({username:"",email:"",first_name:"",last_name:"",password:"",is_staff:!1,is_superuser:!1,is_active:!0,permissions:{}})},y=(e,t,r)=>{c(s=>({...s,permissions:{...s.permissions,[e]:{...s.permissions[e]||{peut_voir:!0,peut_creer:!1,peut_modifier:!1,peut_supprimer:!1},[t]:r}}}))},N=(e,t)=>{var r;return(null==(r=d.permissions[e])?void 0:r[t])??"peut_voir"===t};return x?S.jsxs("div",{className:"utilisateurs",children:[S.jsxs("div",{className:"breadcrumbs",children:[S.jsx("span",{children:"Accueil"}),S.jsx("span",{className:"breadcrumb-separator",children:""}),S.jsx("span",{className:"breadcrumb-current",children:"Utilisateurs"})]}),S.jsx("div",{className:"page-header",children:S.jsx("h1",{children:" Gestion des Utilisateurs"})}),S.jsx("div",{className:"loading",children:S.jsx("div",{className:"spinner"})})]}):g?S.jsxs("div",{className:"utilisateurs",children:[S.jsxs("div",{className:"breadcrumbs",children:[S.jsx("span",{children:"Accueil"}),S.jsx("span",{className:"breadcrumb-separator",children:""}),S.jsx("span",{className:"breadcrumb-current",children:"Utilisateurs"})]}),S.jsx("div",{className:"page-header",children:S.jsx("h1",{children:" Gestion des Utilisateurs"})}),S.jsx("div",{className:"card",style:{padding:"2rem",textAlign:"center"},children:S.jsxs("p",{style:{color:"#dc3545",fontSize:"1.1rem"},children:["Erreur lors du chargement des donnes.",401===(null==(t=g.response)?void 0:t.status)?S.jsx("span",{children:" Veuillez vous connecter."}):403===(null==(r=g.response)?void 0:r.status)?S.jsx("span",{children:" Vous n'avez pas les permissions ncessaires pour accder  cette page."}):S.jsx("span",{children:" Veuillez ressayer plus tard."})]})})]}):s&&s.is_superuser?S.jsxs("div",{className:"utilisateurs",children:[S.jsxs("div",{className:"breadcrumbs",children:[S.jsx("span",{children:"Accueil"}),S.jsx("span",{className:"breadcrumb-separator",children:""}),S.jsx("span",{className:"breadcrumb-current",children:"Utilisateurs"})]}),S.jsx("div",{className:"page-header",children:S.jsx("h1",{children:" Gestion des Utilisateurs"})}),S.jsxs("div",{className:"card",children:[S.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[S.jsxs("h2",{children:["Liste des Utilisateurs",f&&(Array.isArray(f)?f:f.results||[]).length>0&&S.jsxs("span",{style:{fontSize:"0.9rem",fontWeight:"normal",color:"#666",marginLeft:"0.5rem"},children:["(",(Array.isArray(f)?f:f.results||[]).length," utilisateur",(Array.isArray(f)?f:f.results||[]).length>1?"s":"",")"]})]}),S.jsx("button",{onClick:()=>i(!0),className:"btn btn-primary",style:{padding:"0.5rem 1rem",fontSize:"0.9rem"},children:" Nouvel Utilisateur"})]}),(()=>{const e=f?Array.isArray(f)?f:f.results||[]:[];return e.length>0?S.jsxs("table",{className:"table",children:[S.jsx("thead",{children:S.jsxs("tr",{children:[S.jsx("th",{children:"Nom d'utilisateur"}),S.jsx("th",{children:"Email"}),S.jsx("th",{children:"Nom complet"}),S.jsx("th",{children:"Staff"}),S.jsx("th",{children:"Superuser"}),S.jsx("th",{children:"Actif"}),S.jsx("th",{style:{width:"120px"},children:"Actions"})]})}),S.jsx("tbody",{children:e.map(e=>S.jsxs("tr",{children:[S.jsx("td",{children:S.jsx("strong",{children:e.username})}),S.jsx("td",{children:e.email||"-"}),S.jsx("td",{children:e.first_name&&e.last_name?`${e.first_name} ${e.last_name}`:"-"}),S.jsx("td",{children:S.jsx("span",{className:"badge "+(e.is_staff?"badge-success":"badge-secondary"),children:e.is_staff?"Oui":"Non"})}),S.jsx("td",{children:S.jsx("span",{className:"badge "+(e.is_superuser?"badge-danger":"badge-secondary"),children:e.is_superuser?"Oui":"Non"})}),S.jsx("td",{children:S.jsx("span",{className:"badge "+(e.is_active?"badge-success":"badge-danger"),children:e.is_active?"Actif":"Inactif"})}),S.jsxs("td",{children:[S.jsx("button",{onClick:()=>(e=>{l(e);const t={};e.permissions&&Array.isArray(e.permissions)&&e.permissions.forEach(e=>{t[e.fonctionnalite]={peut_voir:e.peut_voir,peut_creer:e.peut_creer,peut_modifier:e.peut_modifier,peut_supprimer:e.peut_supprimer}}),c({username:e.username,email:e.email||"",first_name:e.first_name||"",last_name:e.last_name||"",password:"",is_staff:e.is_staff||!1,is_superuser:e.is_superuser||!1,is_active:void 0===e.is_active||e.is_active,permissions:t}),i(!0)})(e),className:"btn btn-sm btn-secondary",style:{marginRight:"0.5rem"},children:""}),S.jsx("button",{onClick:()=>{window.confirm(`tes-vous sr de vouloir supprimer l'utilisateur "${e.username}" ?`)&&j.mutate(e.id)},className:"btn btn-sm btn-danger",disabled:e.id===(null==s?void 0:s.id),children:""})]})]},e.id))})]}):S.jsx("p",{style:{padding:"1rem",textAlign:"center",color:"#666"},children:"Aucun utilisateur trouv."})})()]}),a&&S.jsx("div",{className:"modal-overlay",onClick:b,children:S.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[S.jsxs("div",{className:"modal-header",children:[S.jsxs("h2",{children:[o?"Modifier":"Nouvel"," Utilisateur"]}),S.jsx("button",{onClick:b,className:"modal-close",children:""})]}),S.jsxs("form",{onSubmit:e=>{if(e.preventDefault(),!d.username)return void ne.error("Le nom d'utilisateur est obligatoire");const t={...d};o&&!t.password&&delete t.password;const r=Object.keys(t.permissions||{}).map(e=>({fonctionnalite:e,...t.permissions[e]}));t.permissions_data=r,delete t.permissions,v.mutate(t)},children:[S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Nom d'utilisateur *"}),S.jsx("input",{type:"text",className:"form-input",value:d.username,onChange:e=>c({...d,username:e.target.value}),required:!0,disabled:!!o,placeholder:"Ex: jdupont"})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Email"}),S.jsx("input",{type:"email",className:"form-input",value:d.email,onChange:e=>c({...d,email:e.target.value}),placeholder:"Ex: jdupont@example.com"})]}),S.jsxs("div",{className:"form-row",children:[S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Prnom"}),S.jsx("input",{type:"text",className:"form-input",value:d.first_name,onChange:e=>c({...d,first_name:e.target.value}),placeholder:"Ex: Jean"})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Nom"}),S.jsx("input",{type:"text",className:"form-input",value:d.last_name,onChange:e=>c({...d,last_name:e.target.value}),placeholder:"Ex: Dupont"})]})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:o?"Nouveau mot de passe (laisser vide pour ne pas changer)":"Mot de passe *"}),S.jsx("input",{type:"password",className:"form-input",value:d.password,onChange:e=>c({...d,password:e.target.value}),required:!o,placeholder:o?"Laisser vide pour ne pas changer":"Mot de passe"}),!o&&S.jsx("small",{style:{color:"#666",fontSize:"0.875rem"},children:"Si non renseign, le mot de passe sera identique au nom d'utilisateur"})]}),S.jsxs("div",{style:{padding:"1rem",backgroundColor:"#f8f9fa",borderRadius:"6px",marginBottom:"1rem",border:"1px solid #dee2e6"},children:[S.jsx("h3",{style:{marginTop:0,marginBottom:"0.75rem",fontSize:"1rem",color:"#333"},children:" Privilges et Permissions"}),S.jsx("div",{className:"form-group",style:{marginBottom:"0.75rem"},children:S.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"0.5rem",cursor:"pointer"},children:[S.jsx("input",{type:"checkbox",checked:d.is_staff,onChange:e=>c({...d,is_staff:e.target.checked}),style:{marginTop:"0.25rem"}}),S.jsxs("div",{children:[S.jsx("strong",{children:"Accs au panneau d'administration (Staff)"}),S.jsx("div",{style:{fontSize:"0.875rem",color:"#666",marginTop:"0.25rem"},children:"Permet d'accder  l'interface d'administration Django et aux fonctionnalits avances"})]})]})}),S.jsx("div",{className:"form-group",style:{marginBottom:"0.75rem"},children:S.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"0.5rem",cursor:"pointer"},children:[S.jsx("input",{type:"checkbox",checked:d.is_superuser,onChange:e=>{const t=e.target.checked;c({...d,is_superuser:t,is_staff:!!t||d.is_staff})},style:{marginTop:"0.25rem"}}),S.jsxs("div",{children:[S.jsx("strong",{children:"Superutilisateur (tous les privilges)"}),S.jsx("div",{style:{fontSize:"0.875rem",color:"#666",marginTop:"0.25rem"},children:"Accs complet : peut crer/modifier/supprimer des utilisateurs, grer toutes les donnes, accder  toutes les fonctionnalits"})]})]})}),S.jsx("div",{className:"form-group",children:S.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"0.5rem",cursor:"pointer"},children:[S.jsx("input",{type:"checkbox",checked:d.is_active,onChange:e=>c({...d,is_active:e.target.checked}),style:{marginTop:"0.25rem"}}),S.jsxs("div",{children:[S.jsx("strong",{children:"Compte actif"}),S.jsx("div",{style:{fontSize:"0.875rem",color:"#666",marginTop:"0.25rem"},children:"Si dsactiv, l'utilisateur ne pourra plus se connecter au systme"})]})]})})]}),S.jsxs("div",{style:{padding:"1rem",backgroundColor:"#f8f9fa",borderRadius:"6px",marginBottom:"1rem",border:"1px solid #dee2e6"},children:[S.jsx("h3",{style:{marginTop:0,marginBottom:"1rem",fontSize:"1rem",color:"#333"},children:" Permissions par Fonctionnalit"}),S.jsx("p",{style:{fontSize:"0.875rem",color:"#666",marginBottom:"1rem"},children:"Dfinissez les permissions pour chaque fonctionnalit du menu. Les superusers ont automatiquement tous les accs."}),["GESTION DES DPENSES","ADMINISTRATION","RESTAURATION / CANTINE","AUDIT ET TRAABILIT"].map(e=>S.jsxs("div",{style:{marginBottom:"1.5rem"},children:[S.jsx("h4",{style:{fontSize:"0.9rem",fontWeight:"600",color:"#495057",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid #dee2e6"},children:e}),u.filter(t=>t.section===e).map(e=>S.jsxs("div",{style:{marginBottom:"1rem",padding:"0.75rem",backgroundColor:"#fff",borderRadius:"4px",border:"1px solid #e9ecef"},children:[S.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[S.jsx("strong",{style:{fontSize:"0.9rem"},children:e.label}),S.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[S.jsx("input",{type:"checkbox",checked:N(e.code,"peut_voir"),onChange:t=>y(e.code,"peut_voir",t.target.checked),disabled:d.is_superuser}),S.jsx("span",{style:{fontSize:"0.875rem"},children:"Voir"})]})]}),N(e.code,"peut_voir")&&!d.is_superuser&&S.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"0.75rem",marginTop:"0.5rem"},children:[S.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",fontSize:"0.875rem"},children:[S.jsx("input",{type:"checkbox",checked:N(e.code,"peut_creer"),onChange:t=>y(e.code,"peut_creer",t.target.checked)}),S.jsx("span",{children:"Crer"})]}),S.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",fontSize:"0.875rem"},children:[S.jsx("input",{type:"checkbox",checked:N(e.code,"peut_modifier"),onChange:t=>y(e.code,"peut_modifier",t.target.checked)}),S.jsx("span",{children:"Modifier"})]}),S.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",fontSize:"0.875rem"},children:[S.jsx("input",{type:"checkbox",checked:N(e.code,"peut_supprimer"),onChange:t=>y(e.code,"peut_supprimer",t.target.checked)}),S.jsx("span",{children:"Supprimer"})]})]})]},e.code))]},e))]}),S.jsxs("div",{className:"form-actions",children:[S.jsx("button",{type:"button",onClick:b,className:"btn btn-secondary",children:"Annuler"}),S.jsx("button",{type:"submit",className:"btn btn-primary",disabled:v.isLoading,children:v.isLoading?"Enregistrement...":o?"Modifier":"Crer"})]})]})]})})]}):S.jsxs("div",{className:"utilisateurs",children:[S.jsxs("div",{className:"breadcrumbs",children:[S.jsx("span",{children:"Accueil"}),S.jsx("span",{className:"breadcrumb-separator",children:""}),S.jsx("span",{className:"breadcrumb-current",children:"Utilisateurs"})]}),S.jsx("div",{className:"page-header",children:S.jsx("h1",{children:" Gestion des Utilisateurs"})}),S.jsx("div",{className:"card",style:{padding:"2rem",textAlign:"center"},children:S.jsx("p",{style:{color:"#dc3545",fontSize:"1.1rem"},children:" Accs refus. Seuls les administrateurs peuvent grer les utilisateurs."})})]})},Hs=()=>{const[t,r]=e.useState(!1),[s,n]=e.useState(null),[a,i]=e.useState({nom:"",description:"",categorie_restau:"Dejeuner",prix_standard:"",actif:!0}),o=p(),{data:l,isLoading:d,error:c}=m("plats",async()=>(await dr.get("/api/restauration/plats/")).data,{retry:1,onError:e=>{var t,r,s;ne.error(`Erreur: ${null==(t=e.response)?void 0:t.status} - ${(null==(s=null==(r=e.response)?void 0:r.data)?void 0:s.detail)||e.message}`)}}),u=h(e=>s?dr.put(`/api/restauration/plats/${s.id}/`,e):dr.post("/api/restauration/plats/",e),{onSuccess:()=>{ne.success(s?"Plat modifi":"Plat cr"),o.invalidateQueries("plats"),x()},onError:e=>{var t,r;const s=(null==(r=null==(t=e.response)?void 0:t.data)?void 0:r.detail)||"Erreur lors de la sauvegarde";ne.error(s)}}),f=h(e=>dr.delete(`/api/restauration/plats/${e}/`),{onSuccess:()=>{ne.success("Plat supprim"),o.invalidateQueries("plats")},onError:()=>ne.error("Erreur lors de la suppression")}),x=()=>{r(!1),n(null),i({nom:"",description:"",categorie_restau:"Dejeuner",prix_standard:"",actif:!0})};return d?S.jsx("div",{className:"loading",children:S.jsx("div",{className:"spinner"})}):c?S.jsxs("div",{className:"restauration-plats",children:[S.jsx("div",{className:"page-header",children:S.jsx("h1",{children:"Gestion des Plats"})}),S.jsx("div",{className:"card",style:{backgroundColor:"#fff3cd",border:"1px solid #ffc107",padding:"1.5rem"},children:S.jsx("p",{style:{color:"#856404",margin:0},children:" Erreur lors du chargement des plats. Vrifiez que le serveur backend est dmarr."})})]}):S.jsxs("div",{className:"restauration-plats",children:[S.jsxs("div",{className:"breadcrumbs",children:[S.jsx("span",{children:"Accueil"}),S.jsx("span",{className:"breadcrumb-separator",children:""}),S.jsx("span",{children:"Restauration"}),S.jsx("span",{className:"breadcrumb-separator",children:""}),S.jsx("span",{className:"breadcrumb-current",children:"Gestion des Plats"})]}),S.jsxs("div",{className:"page-header",children:[S.jsx("h1",{children:"Gestion des Plats"}),S.jsx("button",{type:"button",onClick:()=>{n(null),r(!0)},className:"btn btn-primary",children:" Nouveau Plat"})]}),(null==l?void 0:l.results)&&l.results.length>0?S.jsxs("div",{className:"card",children:[S.jsx("h2",{children:"Liste des Plats"}),S.jsxs("table",{className:"table",children:[S.jsx("thead",{children:S.jsxs("tr",{children:[S.jsx("th",{children:"Nom"}),S.jsx("th",{children:"Catgorie"}),S.jsx("th",{children:"Prix Standard"}),S.jsx("th",{children:"Statut"}),S.jsx("th",{children:"Actions"})]})}),S.jsx("tbody",{children:l.results.map(e=>S.jsxs("tr",{children:[S.jsx("td",{children:S.jsx("strong",{children:e.nom})}),S.jsx("td",{children:e.categorie_restau_display}),S.jsx("td",{children:Ps(e.prix_standard)}),S.jsx("td",{children:S.jsx("span",{className:"badge "+(e.actif?"badge-success":"badge-secondary"),children:e.actif?"Actif":"Inactif"})}),S.jsxs("td",{children:[S.jsx("button",{onClick:()=>(e=>{n(e),i({nom:e.nom,description:e.description||"",categorie_restau:e.categorie_restau,prix_standard:e.prix_standard,actif:e.actif}),r(!0)})(e),className:"btn btn-secondary",style:{marginRight:"0.5rem",padding:"0.25rem 0.5rem",fontSize:"0.75rem"},children:""}),S.jsx("button",{onClick:()=>{window.confirm("Supprimer ce plat ?")&&f.mutate(e.id)},className:"btn btn-secondary",style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem"},children:""})]})]},e.id))})]})]}):S.jsx("div",{className:"card",children:S.jsxs("p",{style:{textAlign:"center",padding:"2rem",color:"var(--text-secondary)"},children:["Aucun plat enregistr.",S.jsx("br",{}),S.jsx("button",{onClick:()=>{n(null),r(!0)},className:"btn btn-primary",style:{marginTop:"1rem"},children:"Crer le premier plat"})]})}),t&&S.jsx("div",{className:"modal-overlay",onClick:x,children:S.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[S.jsxs("div",{className:"modal-header",children:[S.jsxs("h2",{children:[s?"Modifier":"Nouveau"," Plat"]}),S.jsx("button",{onClick:x,className:"modal-close",children:""})]}),S.jsxs("form",{onSubmit:e=>{e.preventDefault(),u.mutate(a)},children:[S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Nom du plat *"}),S.jsx("input",{type:"text",className:"form-input",value:a.nom,onChange:e=>i({...a,nom:e.target.value}),required:!0})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Description"}),S.jsx("textarea",{className:"form-textarea",value:a.description,onChange:e=>i({...a,description:e.target.value}),rows:3})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Catgorie *"}),S.jsxs("select",{className:"form-select",value:a.categorie_restau,onChange:e=>i({...a,categorie_restau:e.target.value}),required:!0,children:[S.jsx("option",{value:"PetitDej",children:"Petit-djeuner"}),S.jsx("option",{value:"Dejeuner",children:"Djeuner"}),S.jsx("option",{value:"Diner",children:"Dner"}),S.jsx("option",{value:"Snack",children:"Collation"})]})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Prix Standard (GNF) *"}),S.jsx("input",{type:"number",step:"0.01",min:"0.01",className:"form-input",value:a.prix_standard,onChange:e=>i({...a,prix_standard:e.target.value}),required:!0})]}),S.jsx("div",{className:"form-group",children:S.jsxs("label",{className:"form-label",children:[S.jsx("input",{type:"checkbox",checked:a.actif,onChange:e=>i({...a,actif:e.target.checked})})," ","Actif"]})}),S.jsxs("div",{className:"modal-actions",children:[S.jsx("button",{type:"button",onClick:x,className:"btn btn-secondary",children:"Annuler"}),S.jsx("button",{type:"submit",className:"btn btn-primary",disabled:u.isLoading,children:u.isLoading?"Enregistrement...":"Enregistrer"})]})]})]})})]})},Js=()=>{var t;const[r,s]=e.useState(As(new Date,"yyyy-MM-dd")),[n,a]=e.useState(!1),[i,o]=e.useState({plat_id:"",prix_jour:"",stock_max:"",ordre:0}),l=p(),{data:d,isLoading:c,refetch:u}=m(["menus",r],async()=>{var e,t;try{const e=(await dr.get(`/api/restauration/menus/?date_menu=${r}`)).data;return e.results?e.results:Array.isArray(e)?e:[]}catch(s){if(404===(null==(e=s.response)?void 0:e.status)||400===(null==(t=s.response)?void 0:t.status))return[];throw s}},{retry:1}),{data:f}=m("plats",async()=>(await dr.get("/api/restauration/plats/?actif=true")).data),x=h(e=>dr.post(`/api/restauration/menus/${e}/publier/`),{onSuccess:()=>{ne.success("Menu publi"),l.invalidateQueries("menus")},onError:()=>ne.error("Erreur lors de la publication")}),g=h(e=>dr.post("/api/restauration/menus/",{date_menu:e}),{onSuccess:()=>{ne.success("Menu cr"),u()},onError:e=>{var t,r;ne.error((null==(r=null==(t=e.response)?void 0:t.data)?void 0:r.detail)||"Erreur lors de la cration")}}),v=h(({menuId:e,platId:t,prix_jour:r,stock_max:s,ordre:n})=>dr.post(`/api/restauration/menus/${e}/ajouter_plat/`,{plat_id:t,prix_jour:r,stock_max:s||null,ordre:n}),{onSuccess:()=>{ne.success("Plat ajout au menu"),l.invalidateQueries("menus"),a(!1),o({plat_id:"",prix_jour:"",stock_max:"",ordre:0})},onError:e=>{var t,r;ne.error((null==(r=null==(t=e.response)?void 0:t.data)?void 0:r.error)||"Erreur lors de l'ajout")}}),j=h(({menuId:e,menuPlatId:t})=>dr.delete(`/api/restauration/menus/${e}/retirer_plat/`,{data:{menu_plat_id:t}}),{onSuccess:()=>{ne.success("Plat retir du menu"),l.invalidateQueries("menus")},onError:e=>{var t,r;ne.error((null==(r=null==(t=e.response)?void 0:t.data)?void 0:r.error)||"Erreur lors de la suppression")}}),b=()=>{g.mutate(r)};if(c)return S.jsx("div",{className:"loading",children:S.jsx("div",{className:"spinner"})});const y=Array.isArray(d)?d[0]:(null==(t=null==d?void 0:d.results)?void 0:t[0])||(null==d?void 0:d[0]);return S.jsxs("div",{className:"restauration-menus",children:[S.jsxs("div",{className:"breadcrumbs",children:[S.jsx("span",{children:"Accueil"}),S.jsx("span",{className:"breadcrumb-separator",children:""}),S.jsx("span",{children:"Restauration"}),S.jsx("span",{className:"breadcrumb-separator",children:""}),S.jsx("span",{className:"breadcrumb-current",children:"Gestion des Menus"})]}),S.jsxs("div",{className:"page-header",children:[S.jsx("h1",{children:"Gestion des Menus"}),S.jsxs("div",{className:"page-actions",children:[S.jsx("input",{type:"date",className:"form-input",value:r,onChange:e=>s(e.target.value),style:{width:"auto",marginRight:"1rem"}}),!y&&S.jsx("button",{onClick:b,className:"btn btn-primary",disabled:g.isLoading,children:g.isLoading?"Cration...":" Crer le Menu"}),y&&S.jsxs(S.Fragment,{children:[S.jsx("button",{onClick:()=>a(!0),className:"btn btn-secondary",style:{marginRight:"0.5rem"},children:" Ajouter un Plat"}),!y.est_publie&&S.jsx("button",{onClick:()=>x.mutate(y.id),className:"btn btn-primary",disabled:x.isLoading,children:x.isLoading?"Publication...":" Publier le Menu"})]})]})]}),y?S.jsxs("div",{className:"card",children:[S.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[S.jsxs("h2",{style:{margin:0},children:["Menu du ",As(new Date(y.date_menu),"dd MMMM yyyy",{locale:Ds})]}),y.est_publie?S.jsx("div",{className:"badge badge-success",children:" Menu publi"}):S.jsx("div",{className:"badge badge-warning",children:" Menu non publi"})]}),y.est_publie&&S.jsx("div",{style:{marginBottom:"1.5rem"},children:S.jsxs("div",{className:"card",style:{backgroundColor:"#e7f3ff",border:"2px solid #366092",padding:"1rem",marginTop:"1rem"},children:[S.jsx("h3",{style:{marginTop:0,color:"#366092"},children:" Lien Unique de Commande"}),S.jsxs("p",{style:{margin:"0.5rem 0",color:"#333"},children:[S.jsx("strong",{children:"Lien fixe  partager avec tous les travailleurs :"})," Ce lien affichera automatiquement le menu du jour lorsqu'il est publi."]}),S.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center",marginTop:"0.5rem",flexWrap:"wrap"},children:[S.jsx("input",{type:"text",readOnly:!0,value:`${window.location.origin}/commander/aujourdhui`,className:"form-input",style:{flex:1,minWidth:"300px",backgroundColor:"white",cursor:"text",fontWeight:"bold"},onClick:e=>e.target.select()}),S.jsx("button",{onClick:()=>{navigator.clipboard.writeText(`${window.location.origin}/commander/aujourdhui`),ne.success("Lien copi dans le presse-papier !")},className:"btn btn-primary",children:" Copier"}),S.jsx("a",{href:"/commander/aujourdhui",target:"_blank",rel:"noopener noreferrer",className:"btn btn-secondary",style:{textDecoration:"none"},children:" Ouvrir le lien"})]}),S.jsxs("p",{style:{marginTop:"0.5rem",fontSize:"0.9rem",color:"#666",fontStyle:"italic"},children:[" ",S.jsx("strong",{children:"Avantage :"})," Les travailleurs n'ont qu'un seul lien  retenir. Il affiche automatiquement le menu du jour lorsqu'il est publi."]})]})}),y.menu_plats&&y.menu_plats.length>0?S.jsxs("table",{className:"table",children:[S.jsx("thead",{children:S.jsxs("tr",{children:[S.jsx("th",{children:"Plat"}),S.jsx("th",{children:"Catgorie"}),S.jsx("th",{children:"Prix du Jour"}),S.jsx("th",{children:"Stock"}),S.jsx("th",{children:"Actions"})]})}),S.jsx("tbody",{children:y.menu_plats.map(e=>S.jsxs("tr",{children:[S.jsx("td",{children:S.jsx("strong",{children:e.plat.nom})}),S.jsx("td",{children:e.plat.categorie_restau_display}),S.jsx("td",{children:Ps(e.prix_jour)}),S.jsx("td",{children:null!==e.stock_max?S.jsxs("span",{children:[null!==e.stock_restant?e.stock_restant:e.stock_max," / ",e.stock_max]}):S.jsx("span",{className:"badge badge-secondary",children:"Illimit"})}),S.jsx("td",{children:S.jsx("div",{style:{display:"flex",gap:"0.25rem"},children:S.jsx("button",{onClick:()=>{return t=e.id,void(y&&window.confirm("tes-vous sr de vouloir retirer ce plat du menu ?")&&j.mutate({menuId:y.id,menuPlatId:t}));var t},className:"btn btn-danger",style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem"},disabled:j.isLoading,title:"Retirer ce plat du menu",children:" Retirer"})})})]},e.id))})]}):S.jsx("p",{style:{textAlign:"center",padding:"2rem",color:"var(--text-secondary)"},children:"Aucun plat dans ce menu."})]}):S.jsx("div",{className:"card",children:S.jsxs("p",{style:{textAlign:"center",padding:"2rem",color:"var(--text-secondary)"},children:["Aucun menu pour cette date.",S.jsx("br",{}),S.jsx("button",{onClick:b,className:"btn btn-primary",style:{marginTop:"1rem"},disabled:g.isLoading,children:g.isLoading?"Cration...":"Crer le Menu"})]})}),n&&y&&S.jsx("div",{className:"modal-overlay",onClick:()=>a(!1),children:S.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[S.jsxs("div",{className:"modal-header",children:[S.jsx("h2",{children:"Ajouter un Plat au Menu"}),S.jsx("button",{onClick:()=>a(!1),className:"modal-close",children:""})]}),S.jsxs("form",{onSubmit:e=>{e.preventDefault(),y?v.mutate({menuId:y.id,platId:i.plat_id,prix_jour:parseFloat(i.prix_jour),stock_max:i.stock_max?parseInt(i.stock_max):null,ordre:parseInt(i.ordre)||0}):ne.error("Crez d'abord un menu pour cette date")},children:[S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Plat *"}),S.jsxs("select",{className:"form-select",value:i.plat_id,onChange:e=>{var t;const r=(null==(t=null==f?void 0:f.results)?void 0:t.find(t=>t.id===parseInt(e.target.value)))||(null==f?void 0:f.find(t=>t.id===parseInt(e.target.value)));o({...i,plat_id:e.target.value,prix_jour:r?r.prix_standard:""})},required:!0,children:[S.jsx("option",{value:"",children:"Slectionner un plat"}),((null==f?void 0:f.results)||f||[]).filter(e=>!y||!y.menu_plats||!y.menu_plats.some(t=>t.plat.id===e.id)).map(e=>S.jsxs("option",{value:e.id,children:[e.nom," (",e.categorie_restau_display,") - ",Ps(e.prix_standard)]},e.id))]}),y&&y.menu_plats&&y.menu_plats.length>0&&S.jsx("p",{style:{fontSize:"0.85rem",color:"#666",marginTop:"0.25rem"},children:" Les plats dj dans le menu ne sont pas affichs dans cette liste."})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Prix du Jour (GNF) *"}),S.jsx("input",{type:"number",step:"0.01",min:"0.01",className:"form-input",value:i.prix_jour,onChange:e=>o({...i,prix_jour:e.target.value}),required:!0})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Stock Maximum (optionnel)"}),S.jsx("input",{type:"number",min:"1",className:"form-input",value:i.stock_max,onChange:e=>o({...i,stock_max:e.target.value}),placeholder:"Laisser vide pour illimit"})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Ordre d'affichage"}),S.jsx("input",{type:"number",min:"0",className:"form-input",value:i.ordre,onChange:e=>o({...i,ordre:e.target.value})})]}),S.jsxs("div",{className:"modal-actions",children:[S.jsx("button",{type:"button",onClick:()=>a(!1),className:"btn btn-secondary",children:"Annuler"}),S.jsx("button",{type:"submit",className:"btn btn-primary",disabled:v.isLoading,children:v.isLoading?"Ajout...":"Ajouter"})]})]})]})})]})},Gs=()=>{const[t,r]=e.useState(As(new Date,"yyyy-MM-dd")),[s,n]=e.useState([]),a=p(),i=o(),{user:l}=Er(),d=()=>{if(null==l?void 0:l.is_superuser)return!0;if(!(null==l?void 0:l.permissions))return!1;if(Array.isArray(l.permissions)){const e=l.permissions.find(e=>"restauration_valider_commandes"===e.fonctionnalite);return!!e&&e.peut_modifier}return!1},{data:c,refetch:u}=m(["menu",t],async()=>{var e,r;try{const e=(await dr.get(`/api/restauration/menus/?date_menu=${t}`)).data;let r=[];return e.results?r=e.results:Array.isArray(e)&&(r=e),r.find(e=>e.date_menu===t)||r[0]||null}catch(s){if(404===(null==(e=s.response)?void 0:e.status)||400===(null==(r=s.response)?void 0:r.status))return null;throw s}},{retry:1,enabled:!!t}),{data:f}=m(["commandes",t],async()=>{const e=await dr.get(`/api/restauration/commandes/?date_commande=${t}`),r=e.data.results||e.data;return Array.isArray(r)?r:r?[r]:[]},{retry:1,enabled:!!t}),x=f&&f.length>0&&f.find(e=>e.utilisateur===(null==l?void 0:l.id)||e.utilisateur_username===(null==l?void 0:l.username))||null,g=d()&&f?f.filter(e=>"brouillon"===e.etat&&e.utilisateur!==(null==l?void 0:l.id)&&e.utilisateur_username!==(null==l?void 0:l.username)):[],v=h(e=>dr.post("/api/restauration/commandes/creer_avec_lignes/",e),{onSuccess:()=>{ne.success("Commande cre"),a.invalidateQueries("commande"),n([])},onError:e=>{var t,r,s,n;const a=(null==(r=null==(t=e.response)?void 0:t.data)?void 0:r.error)||(null==(n=null==(s=e.response)?void 0:s.data)?void 0:n.details)||"Erreur lors de la cration";ne.error(a)}}),j=h(e=>dr.post(`/api/restauration/commandes/${e}/valider/`),{onSuccess:()=>{ne.success("Commande valide"),a.invalidateQueries("commande"),a.invalidateQueries("commandes")},onError:e=>{var t,r,s,n;const a=(null==(r=null==(t=e.response)?void 0:t.data)?void 0:r.error)||(null==(n=null==(s=e.response)?void 0:s.data)?void 0:n.detail)||"Erreur lors de la validation";ne.error(a)}}),b=()=>{const e=s.length>0?s[0]:null;if(!e)return 0;const t=e.menu_plat.prix_jour;return t>3e4?t-3e4:0},y=e=>{e?j.mutate(e):x&&"brouillon"===x.etat&&j.mutate(x.id)};return S.jsxs("div",{className:"restauration-commandes",children:[S.jsxs("div",{className:"breadcrumbs",children:[S.jsx("span",{children:"Accueil"}),S.jsx("span",{className:"breadcrumb-separator",children:""}),S.jsx("span",{children:"Restauration"}),S.jsx("span",{className:"breadcrumb-separator",children:""}),S.jsx("span",{className:"breadcrumb-current",children:"Commander"})]}),S.jsxs("div",{className:"page-header",children:[S.jsx("h1",{children:"Commander un Repas"}),S.jsx("input",{type:"date",className:"form-input",value:t,onChange:e=>r(e.target.value),style:{width:"auto"}})]}),x?S.jsxs("div",{className:"card",style:{marginBottom:"1.5rem"},children:[S.jsxs("h2",{children:["Ma Commande du ",As(new Date(x.date_commande),"dd/MM/yyyy")]}),S.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center",marginBottom:"1rem"},children:[S.jsx("span",{className:"badge badge-"+("validee"===x.etat?"success":"warning"),children:x.etat_display}),"brouillon"===x.etat&&d()&&S.jsx("button",{onClick:y,className:"btn btn-primary",disabled:j.isLoading,children:j.isLoading?"Validation...":" Valider la Commande"})]}),x.lignes&&x.lignes.length>0&&S.jsxs("table",{className:"table",children:[S.jsx("thead",{children:S.jsxs("tr",{children:[S.jsx("th",{children:"Plat"}),S.jsx("th",{children:"Quantit"}),S.jsx("th",{children:"Prix Unitaire"}),S.jsx("th",{children:"Total"})]})}),S.jsx("tbody",{children:x.lignes.map(e=>S.jsxs("tr",{children:[S.jsx("td",{children:e.plat_nom}),S.jsx("td",{children:e.quantite}),S.jsx("td",{children:Ps(e.prix_unitaire)}),S.jsx("td",{children:S.jsx("strong",{children:Ps(e.montant_ligne)})})]},e.id))}),S.jsxs("tfoot",{children:[S.jsxs("tr",{children:[S.jsx("td",{colSpan:"3",children:S.jsx("strong",{children:"Total Brut"})}),S.jsx("td",{children:S.jsx("strong",{children:Ps(x.montant_brut)})})]}),x.montant_subvention>0&&S.jsxs("tr",{children:[S.jsx("td",{colSpan:"3",children:S.jsx("strong",{children:"Subvention"})}),S.jsx("td",{children:S.jsxs("strong",{style:{color:"var(--success-color)"},children:["-",Ps(x.montant_subvention)]})})]}),S.jsxs("tr",{children:[S.jsx("td",{colSpan:"3",children:S.jsx("strong",{children:"Total Net"})}),S.jsx("td",{children:S.jsx("strong",{children:Ps(x.montant_net)})})]})]})]})]}):null,d()&&g.length>0&&S.jsxs("div",{className:"card",style:{marginBottom:"1.5rem",border:"2px solid #007bff"},children:[S.jsxs("h2",{style:{color:"#007bff",marginBottom:"1rem"},children:[" Commandes  Valider (",g.length,")"]}),S.jsxs("p",{style:{marginBottom:"1rem",color:"#666",fontSize:"0.9rem"},children:["Liste de toutes les commandes en brouillon pour le ",As(new Date(t),"dd/MM/yyyy")]}),S.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:g.map(e=>S.jsxs("div",{style:{padding:"1rem",backgroundColor:"#f8f9fa",borderRadius:"6px",border:"1px solid #dee2e6"},children:[S.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem"},children:[S.jsxs("div",{children:[S.jsxs("strong",{children:["Commande #",e.id]}),S.jsxs("span",{style:{marginLeft:"1rem",color:"#666",fontSize:"0.9rem"},children:["- ",S.jsx("strong",{style:{color:"#007bff"},children:e.utilisateur_nom||e.utilisateur_username||"Utilisateur inconnu"})]})]}),S.jsx("button",{onClick:()=>y(e.id),className:"btn btn-primary",disabled:j.isLoading,style:{padding:"0.5rem 1rem",fontSize:"0.9rem"},children:j.isLoading?"Validation...":" Valider"})]}),e.lignes&&e.lignes.length>0&&S.jsxs("table",{className:"table",style:{marginBottom:"0.5rem",fontSize:"0.9rem"},children:[S.jsx("thead",{children:S.jsxs("tr",{children:[S.jsx("th",{children:"Plat"}),S.jsx("th",{children:"Quantit"}),S.jsx("th",{children:"Prix Unitaire"}),S.jsx("th",{children:"Total"})]})}),S.jsx("tbody",{children:e.lignes.map(e=>S.jsxs("tr",{children:[S.jsx("td",{children:e.plat_nom}),S.jsx("td",{children:e.quantite}),S.jsx("td",{children:Ps(e.prix_unitaire)}),S.jsx("td",{children:S.jsx("strong",{children:Ps(e.montant_ligne)})})]},e.id))}),S.jsx("tfoot",{children:S.jsxs("tr",{children:[S.jsx("td",{colSpan:"3",children:S.jsx("strong",{children:"Total Net"})}),S.jsx("td",{children:S.jsx("strong",{children:Ps(e.montant_net)})})]})})]})]},e.id))})]}),c&&c.est_publie?S.jsxs("div",{className:"card",children:[S.jsxs("h2",{children:["Menu du ",As(new Date(c.date_menu),"dd MMMM yyyy",{locale:Ds})]}),S.jsxs("div",{style:{marginBottom:"1.5rem",padding:"1rem",backgroundColor:"#fee",border:"2px solid #dc3545",borderRadius:"6px"},children:[S.jsx("p",{style:{color:"#dc3545",marginBottom:"0.5rem",fontWeight:"bold",fontSize:"1rem"},children:" Important : Vous ne pouvez commander qu'un seul plat par commande."}),S.jsx("p",{style:{color:"#dc3545",margin:0,fontSize:"0.95rem",fontWeight:"500"},children:"Si le prix du plat dpasse 30 000 GNF, un supplment sera factur  la rception."})]}),c.menu_plats&&c.menu_plats.length>0?S.jsx("div",{className:"plats-grid",children:c.menu_plats.map(e=>{const t=s.find(t=>t.menu_plat_id===e.id),r=e.stock_restant,a=null===r||r>0;return S.jsxs("div",{className:"plat-card",children:[S.jsxs("div",{className:"plat-header",children:[S.jsx("h3",{children:e.plat.nom}),S.jsx("span",{className:"badge badge-primary",children:e.plat.categorie_restau_display})]}),e.plat.description&&S.jsx("p",{className:"plat-description",children:e.plat.description}),S.jsxs("div",{className:"plat-footer",children:[S.jsx("div",{className:"plat-prix",children:Ps(e.prix_jour)}),null!==r&&S.jsxs("div",{className:"plat-stock",children:["Stock: ",r]}),a?S.jsx("div",{className:"plat-actions",children:t?S.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",alignItems:"center"},children:[S.jsx("span",{className:"badge badge-success",style:{fontSize:"0.9rem",padding:"0.5rem 1rem"},children:" Slectionn"}),S.jsx("button",{onClick:()=>{n([])},className:"btn btn-secondary",style:{padding:"0.25rem 0.75rem",fontSize:"0.85rem"},children:"Retirer"})]}):S.jsx("button",{onClick:()=>(e=>{n([{menu_plat_id:e.id,quantite:1,menu_plat:e}])})(e),className:"btn btn-primary",disabled:null!==r&&r<=0||s.length>0,title:s.length>0?"Vous ne pouvez commander qu'un seul plat":"Slectionner ce plat",children:s.length>0?"Un seul plat autoris":"Slectionner"})}):S.jsx("span",{className:"badge badge-danger",children:"puis"}),e.prix_jour>3e4&&S.jsxs("div",{style:{marginTop:"0.5rem",padding:"0.5rem",backgroundColor:"#fff3cd",border:"1px solid #ffc107",borderRadius:"4px",fontSize:"0.85rem",color:"#856404",textAlign:"center"},children:[" Supplment: ",Ps(e.prix_jour-3e4),"  payer  la rception"]})]})]},e.id)})}):S.jsx("p",{style:{textAlign:"center",padding:"2rem",color:"var(--text-secondary)"},children:"Aucun plat disponible pour ce menu."}),s.length>0&&S.jsx("div",{className:"panier-fixed",children:S.jsxs("div",{className:"panier-content",children:[S.jsxs("div",{className:"panier-header",children:[S.jsx("h3",{children:"Votre Commande"}),S.jsx("button",{onClick:()=>n([]),className:"btn btn-secondary",style:{padding:"0.25rem 0.5rem"},children:"Retirer"})]}),S.jsx("div",{className:"panier-items",children:s.map(e=>{const t=e.menu_plat.prix_jour>3e4?e.menu_plat.prix_jour-3e4:0;return S.jsxs("div",{className:"panier-item",children:[S.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[S.jsx("span",{children:S.jsx("strong",{children:e.menu_plat.plat.nom})}),S.jsx("span",{children:Ps(e.menu_plat.prix_jour)})]}),t>0&&S.jsxs("div",{style:{padding:"0.5rem",backgroundColor:"#fff3cd",border:"1px solid #ffc107",borderRadius:"4px",fontSize:"0.85rem",color:"#856404"},children:[" ",S.jsx("strong",{children:"Supplment:"})," ",Ps(t),"  payer  la rception"]})]},e.menu_plat_id)})}),S.jsxs("div",{className:"panier-total",style:{padding:"1rem 0",borderTop:"2px solid var(--primary-color)"},children:[S.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[S.jsx("span",{children:S.jsx("strong",{children:"Prix du plat :"})}),S.jsx("span",{children:S.jsx("strong",{children:Ps(0===s.length?0:s[0].menu_plat.prix_jour)})})]}),b()>0&&S.jsxs("div",{style:{display:"flex",justifyContent:"space-between",paddingTop:"0.5rem",borderTop:"1px dashed #ccc",fontSize:"0.9rem",color:"#856404"},children:[S.jsx("span",{children:"Supplment  la rception :"}),S.jsx("span",{style:{fontWeight:"bold"},children:Ps(b())})]})]}),S.jsx("button",{onClick:()=>{if(0===s.length)return void ne.error("Votre panier est vide");const e=s.map(e=>({menu_plat_id:e.menu_plat_id.toString(),quantite:e.quantite.toString()}));v.mutate({date_commande:t,lignes:e})},className:"btn btn-primary",disabled:v.isLoading,style:{width:"100%",marginTop:"1rem"},children:v.isLoading?"Commande en cours...":"Commander"})]})})]}):S.jsx("div",{className:"card",children:S.jsx("div",{style:{textAlign:"center",padding:"2rem"},children:c?S.jsxs(S.Fragment,{children:[S.jsx("p",{style:{color:"#856404",marginBottom:"1rem",fontSize:"1.1rem"},children:" Le menu n'est pas encore publi."}),S.jsx("p",{style:{color:"var(--text-secondary)",marginBottom:"1.5rem"},children:"Le menu existe mais n'a pas t publi. Les employs ne peuvent pas encore commander."}),S.jsx("button",{onClick:()=>i("/restauration/menus"),className:"btn btn-primary",children:"Aller  la Gestion des Menus pour publier"})]}):S.jsxs(S.Fragment,{children:[S.jsx("p",{style:{color:"var(--text-secondary)",marginBottom:"1rem"},children:"Aucun menu disponible pour cette date."}),(null==l?void 0:l.is_staff)&&S.jsx("button",{onClick:()=>i("/restauration/menus"),className:"btn btn-primary",children:"Crer un Menu"})]})})})]})},Ys=()=>{const[t,r]=e.useState(!1),[s,n]=e.useState(null),[a,i]=e.useState({date_debut:"",date_fin:"",type_extra:""}),o=p(),{data:l,isLoading:d,error:c,refetch:u}=m(["extras-restauration",a],async()=>{const e=new URLSearchParams;a.date_debut&&e.append("date_operation_after",a.date_debut),a.date_fin&&e.append("date_operation_before",a.date_fin),a.type_extra&&e.append("type_extra",a.type_extra),e.append("ordering","-date_operation");return(await dr.get(`/api/restauration/extras/?${e.toString()}`)).data},{retry:1,onError:e=>{}}),f=h(e=>dr.delete(`/api/restauration/extras/${e}/`),{onSuccess:()=>{ne.success("Extra supprim"),o.invalidateQueries("extras-restauration")},onError:()=>ne.error("Erreur lors de la suppression")}),x=()=>{r(!1),n(null)};return d?S.jsx("div",{className:"loading",children:S.jsx("div",{className:"spinner"})}):S.jsxs("div",{className:"extras-restauration",children:[S.jsxs("div",{className:"breadcrumbs",children:[S.jsx("span",{children:"Accueil"}),S.jsx("span",{className:"breadcrumb-separator",children:""}),S.jsx("span",{className:"breadcrumb-current",children:"Extras Restauration"})]}),S.jsxs("div",{className:"page-header",children:[S.jsx("h1",{children:"Extras Restauration"}),S.jsx("p",{className:"page-subtitle",children:"Gestion des oprations pour visiteurs, stagiaires et activits"}),S.jsx("div",{className:"page-actions",children:S.jsx("button",{type:"button",onClick:()=>{n(null),r(!0)},className:"btn btn-primary",children:" Nouvel Extra"})})]}),S.jsxs("div",{className:"card",children:[S.jsx("h2",{children:"Filtres"}),S.jsxs("div",{className:"filters",children:[S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Date dbut"}),S.jsx("input",{type:"date",className:"form-input",value:a.date_debut,onChange:e=>i({...a,date_debut:e.target.value})})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Date fin"}),S.jsx("input",{type:"date",className:"form-input",value:a.date_fin,onChange:e=>i({...a,date_fin:e.target.value})})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Type"}),S.jsxs("select",{className:"form-input",value:a.type_extra,onChange:e=>i({...a,type_extra:e.target.value}),children:[S.jsx("option",{value:"",children:"Tous"}),S.jsx("option",{value:"visiteur",children:"Visiteur"}),S.jsx("option",{value:"stagiaire",children:"Stagiaire"}),S.jsx("option",{value:"activite",children:"Activit"})]})]}),S.jsx("div",{className:"form-group",children:S.jsx("button",{onClick:()=>i({date_debut:"",date_fin:"",type_extra:""}),className:"btn btn-secondary",children:"Rinitialiser"})})]})]}),S.jsxs("div",{className:"card",children:[S.jsx("h2",{children:"Liste des Extras"}),c?S.jsxs("div",{className:"alert alert-danger",children:["Erreur lors du chargement des extras: ",c.message]}):(null==l?void 0:l.results)&&l.results.length>0?S.jsxs("table",{className:"table",children:[S.jsx("thead",{children:S.jsxs("tr",{children:[S.jsx("th",{children:"Date"}),S.jsx("th",{children:"Type"}),S.jsx("th",{children:"Nom"}),S.jsx("th",{children:"Plat"}),S.jsx("th",{children:"Quantit"}),S.jsx("th",{children:"Prix unitaire"}),S.jsx("th",{children:"Montant"}),S.jsx("th",{children:"Actions"})]})}),S.jsx("tbody",{children:l.results.map(e=>S.jsxs("tr",{children:[S.jsx("td",{children:As(new Date(e.date_operation),"dd/MM/yyyy")}),S.jsx("td",{children:S.jsx("span",{className:"badge badge-"+("visiteur"===e.type_extra?"info":"stagiaire"===e.type_extra?"warning":"success"),children:e.type_extra_display})}),S.jsx("td",{children:e.nom_personne}),S.jsx("td",{children:e.plat_nom}),S.jsx("td",{children:parseFloat(e.quantite).toFixed(2)}),S.jsx("td",{children:Ps(e.prix_unitaire)}),S.jsx("td",{children:S.jsx("strong",{children:Ps(e.montant_total)})}),S.jsxs("td",{children:[S.jsx("button",{onClick:()=>(e=>{n(e),r(!0)})(e),className:"btn-icon",title:"Modifier",children:""}),S.jsx("button",{onClick:()=>{return t=e.id,void(window.confirm("tes-vous sr de vouloir supprimer cet extra ?")&&f.mutate(t));var t},className:"btn-icon",title:"Supprimer",children:""})]})]},e.id))})]}):S.jsx("p",{className:"text-muted",children:"Aucun extra trouv"})]}),t&&S.jsx(Qs,{extra:s,onClose:x,onSuccess:()=>{o.invalidateQueries("extras-restauration"),x()}})]})},Qs=({extra:t,onClose:r,onSuccess:s})=>{const[n,a]=e.useState({type_extra:(null==t?void 0:t.type_extra)||"visiteur",nom_personne:(null==t?void 0:t.nom_personne)||"",date_operation:(null==t?void 0:t.date_operation)||As(new Date,"yyyy-MM-dd"),plat_nom:(null==t?void 0:t.plat_nom)||"",quantite:(null==t?void 0:t.quantite)||"1",prix_unitaire:(null==t?void 0:t.prix_unitaire)||"",description:(null==t?void 0:t.description)||""}),i=h(e=>dr.post("/api/restauration/extras/",e),{onSuccess:()=>{ne.success("Extra cr avec succs"),s()},onError:e=>{var t,r,s,n,a;const i=(null==(r=null==(t=e.response)?void 0:t.data)?void 0:r.detail)||(null==(n=null==(s=e.response)?void 0:s.data)?void 0:n.message)||((null==(a=e.response)?void 0:a.data)&&"object"==typeof e.response.data?JSON.stringify(e.response.data):null)||e.message||"Erreur lors de la cration";ne.error(i)}}),o=h(e=>dr.put(`/api/restauration/extras/${t.id}/`,e),{onSuccess:()=>{ne.success("Extra modifi avec succs"),s()},onError:e=>{var t,r;ne.error((null==(r=null==(t=e.response)?void 0:t.data)?void 0:r.detail)||"Erreur lors de la modification")}});return S.jsx("div",{className:"modal-overlay",onClick:r,children:S.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[S.jsxs("div",{className:"modal-header",children:[S.jsx("h2",{children:t?"Modifier Extra":"Nouvel Extra"}),S.jsx("button",{className:"btn-close",onClick:r,children:""})]}),S.jsxs("form",{onSubmit:e=>{e.preventDefault();const r={...n,quantite:parseFloat(n.quantite),prix_unitaire:parseFloat(n.prix_unitaire)};t?o.mutate(r):i.mutate(r)},children:[S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Type *"}),S.jsxs("select",{className:"form-input",value:n.type_extra,onChange:e=>a({...n,type_extra:e.target.value}),required:!0,children:[S.jsx("option",{value:"visiteur",children:"Visiteur"}),S.jsx("option",{value:"stagiaire",children:"Stagiaire"}),S.jsx("option",{value:"activite",children:"Activit"})]})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Nom de la personne / Activit *"}),S.jsx("input",{type:"text",className:"form-input",value:n.nom_personne,onChange:e=>a({...n,nom_personne:e.target.value}),required:!0,placeholder:"Ex: Jean Dupont, Formation Python, etc."})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Date *"}),S.jsx("input",{type:"date",className:"form-input",value:n.date_operation,onChange:e=>a({...n,date_operation:e.target.value}),required:!0})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Nom du plat *"}),S.jsx("input",{type:"text",className:"form-input",value:n.plat_nom,onChange:e=>a({...n,plat_nom:e.target.value}),required:!0,placeholder:"Ex: Riz au gras, Poulet Yassa, etc."})]}),S.jsxs("div",{className:"form-row",children:[S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Quantit *"}),S.jsx("input",{type:"number",step:"0.01",min:"0.01",className:"form-input",value:n.quantite,onChange:e=>a({...n,quantite:e.target.value}),required:!0})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Prix unitaire (GNF) *"}),S.jsx("input",{type:"number",step:"0.01",min:"0.01",className:"form-input",value:n.prix_unitaire,onChange:e=>a({...n,prix_unitaire:e.target.value}),required:!0})]})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Montant total"}),S.jsx("div",{className:"form-input",style:{backgroundColor:"#f8f9fa",fontWeight:"bold"},children:Ps((parseFloat(n.quantite)||0)*(parseFloat(n.prix_unitaire)||0))})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:"Description"}),S.jsx("textarea",{className:"form-input",rows:"3",value:n.description,onChange:e=>a({...n,description:e.target.value}),placeholder:"Informations supplmentaires..."})]}),S.jsxs("div",{className:"modal-footer",children:[S.jsx("button",{type:"button",className:"btn btn-secondary",onClick:r,children:"Annuler"}),S.jsx("button",{type:"submit",className:"btn btn-primary",disabled:i.isLoading||o.isLoading,children:i.isLoading||o.isLoading?"Enregistrement...":t?"Modifier":"Crer"})]})]})]})})},Xs=()=>{var t,r,s;const{token:n}=l(),a=n||"aujourdhui",[i,o]=e.useState([]),[d,c]=e.useState({nom_employe:"",email_employe:""});p();const{data:u,isLoading:f,error:x}=m(["menu-public",a],async()=>(await dr.get(`/api/restauration/public/menu/${a}/`)).data,{retry:1,enabled:!0}),g=h(e=>dr.post(`/api/restauration/public/commander/${a}/`,e),{onSuccess:()=>{ne.success(" Commande cre avec succs ! Vous recevrez une confirmation par email si vous avez fourni votre adresse."),o([]),c({nom_employe:"",email_employe:""}),window.scrollTo({top:0,behavior:"smooth"})},onError:e=>{var t,r;const s=(null==(r=null==(t=e.response)?void 0:t.data)?void 0:r.error)||"Erreur lors de la cration";ne.error(s)}}),v=()=>{const e=i.length>0?i[0]:null;if(!e)return 0;const t=e.menu_plat.prix_jour;return t>3e4?t-3e4:0};if(f)return S.jsx("div",{className:"loading",children:S.jsx("div",{className:"spinner"})});if(x||!u){const e=(null==(r=null==(t=null==x?void 0:x.response)?void 0:t.data)?void 0:r.error)||(null==x?void 0:x.message)||"Menu non disponible",n=null==(s=null==x?void 0:x.response)?void 0:s.status,i="aujourdhui"===a;return S.jsx("div",{className:"commander-public",children:S.jsxs("div",{className:"card",style:{backgroundColor:"#fff3cd",border:"1px solid #ffc107",padding:"2rem",textAlign:"center",maxWidth:"600px",margin:"2rem auto"},children:[S.jsx("h2",{style:{color:"#856404",marginTop:0},children:" Menu non disponible"}),S.jsx("p",{style:{color:"#856404",marginBottom:"1rem"},children:e}),404===n&&i&&S.jsxs("p",{style:{color:"#666",fontSize:"0.9rem"},children:["Aucun menu n'a t publi pour aujourd'hui.",S.jsx("br",{}),"La responsable de la cantine doit publier le menu du jour pour que vous puissiez commander."]}),404===n&&!i&&S.jsxs("p",{style:{color:"#666",fontSize:"0.9rem"},children:["Le menu correspondant  ce lien n'existe pas ou n'est plus disponible.",S.jsx("br",{}),"Vrifiez que le lien est correct ou contactez l'administrateur."]}),n&&404!==n&&S.jsxs("p",{style:{color:"#666",fontSize:"0.9rem"},children:["Erreur ",n,": ",e]})]})})}return S.jsxs("div",{className:"commander-public",children:[S.jsx("div",{className:"public-header",children:S.jsxs("div",{style:{textAlign:"center"},children:[S.jsx("h1",{style:{margin:0,fontSize:"2.5rem"},children:" Commande de Repas"}),S.jsx("h2",{style:{margin:"0.5rem 0",fontSize:"1.5rem",fontWeight:"normal"},children:As(new Date(u.date_menu),"dd MMMM yyyy",{locale:Ds})}),S.jsx("p",{style:{color:"rgba(255,255,255,0.9)",marginTop:"1rem",fontSize:"1.1rem"},children:"Remplissez le formulaire ci-dessous pour commander votre repas"})]})}),S.jsxs("form",{onSubmit:e=>{if(e.preventDefault(),0===i.length)return void ne.error("Votre panier est vide");if(!d.nom_employe.trim())return void ne.error("Veuillez entrer votre nom");const t=i.map(e=>({menu_plat_id:e.menu_plat_id,quantite:e.quantite}));g.mutate({nom_employe:d.nom_employe,email_employe:d.email_employe,lignes:t})},children:[S.jsxs("div",{className:"card",style:{marginBottom:"1.5rem",border:"2px solid var(--primary-color)"},children:[S.jsx("h2",{style:{color:"var(--primary-color)",marginTop:0},children:" Vos Informations"}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:S.jsx("strong",{children:"Nom complet *"})}),S.jsx("input",{type:"text",className:"form-input",value:d.nom_employe,onChange:e=>c({...d,nom_employe:e.target.value}),required:!0,placeholder:"Ex: Oumar Diallo",style:{fontSize:"1rem",padding:"0.875rem"}})]}),S.jsxs("div",{className:"form-group",children:[S.jsx("label",{className:"form-label",children:S.jsx("strong",{children:"Email (optionnel)"})}),S.jsx("input",{type:"email",className:"form-input",value:d.email_employe,onChange:e=>c({...d,email_employe:e.target.value}),placeholder:"votre.email@example.com",style:{fontSize:"1rem",padding:"0.875rem"}})]})]}),u.menu_plats&&u.menu_plats.length>0?S.jsxs("div",{className:"card",children:[S.jsx("h2",{style:{color:"var(--primary-color)",marginTop:0},children:" Menu du Jour"}),S.jsxs("div",{style:{marginBottom:"1.5rem",padding:"1rem",backgroundColor:"#fee",border:"2px solid #dc3545",borderRadius:"6px"},children:[S.jsx("p",{style:{color:"#dc3545",marginBottom:"0.5rem",fontWeight:"bold",fontSize:"1rem"},children:" Important : Vous ne pouvez commander qu'un seul plat par commande."}),S.jsx("p",{style:{color:"#dc3545",margin:0,fontSize:"0.95rem",fontWeight:"500"},children:"Si le prix du plat dpasse 30 000 GNF, un supplment sera factur  la rception."})]}),S.jsx("div",{className:"plats-grid",children:u.menu_plats.map(e=>{const t=i.find(t=>t.menu_plat_id===e.id),r=e.stock_restant,s=null===r||r>0;return S.jsxs("div",{className:"plat-card",children:[S.jsxs("div",{className:"plat-header",children:[S.jsx("h3",{children:e.plat.nom}),S.jsx("span",{className:"badge badge-primary",children:e.plat.categorie_restau_display})]}),e.plat.description&&S.jsx("p",{className:"plat-description",children:e.plat.description}),S.jsxs("div",{className:"plat-footer",children:[S.jsx("div",{className:"plat-prix",children:Ps(e.prix_jour)}),null!==r&&S.jsxs("div",{className:"plat-stock",children:["Stock: ",r]}),s?S.jsx("div",{className:"plat-actions",children:t?S.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",alignItems:"center"},children:[S.jsx("span",{className:"badge badge-success",style:{fontSize:"0.9rem",padding:"0.5rem 1rem"},children:" Slectionn"}),S.jsx("button",{type:"button",onClick:()=>{o([])},className:"btn btn-secondary",style:{padding:"0.25rem 0.75rem",fontSize:"0.85rem"},children:"Retirer"})]}):S.jsx("button",{type:"button",onClick:()=>(e=>{o([{menu_plat_id:e.id,quantite:1,menu_plat:e}])})(e),className:"btn btn-primary",disabled:null!==r&&r<=0||i.length>0,title:i.length>0?"Vous ne pouvez commander qu'un seul plat":"Slectionner ce plat",children:i.length>0?"Un seul plat autoris":"Slectionner"})}):S.jsx("span",{className:"badge badge-danger",children:"puis"}),e.prix_jour>3e4&&S.jsxs("div",{style:{marginTop:"0.5rem",padding:"0.5rem",backgroundColor:"#fff3cd",border:"1px solid #ffc107",borderRadius:"4px",fontSize:"0.85rem",color:"#856404",textAlign:"center"},children:[" Supplment: ",Ps(e.prix_jour-3e4),"  payer  la rception"]})]})]},e.id)})})]}):S.jsx("div",{className:"card",children:S.jsx("p",{style:{textAlign:"center",padding:"2rem",color:"var(--text-secondary)"},children:"Aucun plat disponible pour ce menu."})}),i.length>0?S.jsxs("div",{className:"card panier-card",style:{position:"sticky",bottom:"1rem",border:"3px solid var(--primary-color)",boxShadow:"0 8px 24px rgba(54, 96, 146, 0.3)"},children:[S.jsx("h2",{style:{color:"var(--primary-color)",marginTop:0,display:"flex",alignItems:"center",gap:"0.5rem"},children:" Votre Commande"}),S.jsx("div",{className:"panier-items",children:i.map(e=>{const t=e.menu_plat.prix_jour>3e4?e.menu_plat.prix_jour-3e4:0;return S.jsxs("div",{className:"panier-item",children:[S.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",marginBottom:"0.5rem"},children:[S.jsx("span",{style:{flex:1},children:S.jsx("strong",{children:e.menu_plat.plat.nom})}),S.jsx("span",{style:{fontWeight:"bold",color:"var(--primary-color)"},children:Ps(e.menu_plat.prix_jour)})]}),t>0&&S.jsxs("div",{style:{padding:"0.75rem",backgroundColor:"#fff3cd",border:"2px solid #ffc107",borderRadius:"6px",marginTop:"0.5rem"},children:[S.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.25rem"},children:[S.jsx("span",{style:{fontSize:"1.2rem"},children:""}),S.jsx("strong",{style:{color:"#856404"},children:"Note importante :"})]}),S.jsxs("p",{style:{color:"#856404",margin:0,fontSize:"0.9rem",lineHeight:"1.5"},children:["Ce plat dpasse la prime de 30 000 GNF.",S.jsx("br",{}),S.jsxs("strong",{children:["Un supplment de ",Ps(t)," sera factur lors de la rception du plat."]})]})]})]},e.menu_plat_id)})}),S.jsxs("div",{className:"panier-total",style:{fontSize:"1.3rem",padding:"1.5rem 0",borderTop:"2px solid var(--primary-color)",marginTop:"1rem"},children:[S.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[S.jsx("span",{children:S.jsx("strong",{children:"Prix du plat :"})}),S.jsx("span",{style:{color:"var(--primary-color)"},children:S.jsx("strong",{children:Ps(0===i.length?0:i[0].menu_plat.prix_jour)})})]}),v()>0&&S.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"0.5rem",paddingTop:"0.5rem",borderTop:"1px dashed #ccc"},children:[S.jsx("span",{style:{fontSize:"0.9rem",color:"#856404"},children:"Supplment  payer  la rception :"}),S.jsx("span",{style:{color:"#856404",fontWeight:"bold"},children:Ps(v())})]})]}),S.jsx("button",{type:"submit",className:"btn btn-primary",disabled:g.isLoading,style:{width:"100%",marginTop:"1.5rem",padding:"1.25rem",fontSize:"1.2rem",fontWeight:"bold",textTransform:"uppercase",letterSpacing:"1px"},children:g.isLoading?" Envoi en cours...":" Valider ma Commande"})]}):S.jsx("div",{className:"card",style:{textAlign:"center",padding:"2rem",backgroundColor:"#f8f9fa",border:"2px dashed var(--border-color)"},children:S.jsx("p",{style:{color:"var(--text-secondary)",fontSize:"1.1rem",margin:0},children:" Slectionnez des plats ci-dessus pour commencer votre commande"})})]})]})},Ks=()=>{const[t,r]=e.useState(As(new Date,"yyyy-MM-dd")),s=p(),{data:n,isLoading:a}=m(["commandes-cantine",t],async()=>(await dr.get(`/api/restauration/commandes/?date_commande=${t}`)).data,{retry:1}),{data:i}=m(["facture",t],async()=>{var e;try{return(await dr.get(`/api/restauration/factures/${t}/`)).data}catch(r){if(404===(null==(e=r.response)?void 0:e.status))return null;throw r}},{retry:1}),o=h(e=>dr.post(`/api/restauration/factures/${e}/`),{onSuccess:e=>{ne.success(`Facture ${e.data.numero_facture} gnre avec succs`),s.invalidateQueries("facture"),s.invalidateQueries(["facture",t])},onError:e=>{var t,r;const s=(null==(r=null==(t=e.response)?void 0:t.data)?void 0:r.error)||e.message||"Erreur lors de la gnration";ne.error(`Erreur: ${s}`)}}),l=async()=>{var e,r;try{const e=localStorage.getItem("access_token")||sessionStorage.getItem("access_token"),r=await dr.get(`/api/restauration/factures/${t}/imprimer/`,{responseType:"blob",headers:e?{Authorization:`Bearer ${e}`}:{}}),s=new Blob([r.data],{type:"application/pdf"}),n=window.URL.createObjectURL(s),a=document.createElement("a");a.href=n,a.download=`facture_${t.replace(/-/g,"")}.pdf`,document.body.appendChild(a),a.click(),document.body.removeChild(a);window.open(n,"_blank")?setTimeout(()=>{window.URL.revokeObjectURL(n)},5e3):setTimeout(()=>window.URL.revokeObjectURL(n),2e3),ne.success("Facture tlcharge et ouverte pour impression")}catch(s){const t=(null==(r=null==(e=s.response)?void 0:e.data)?void 0:r.error)||s.message||"Erreur lors du tlchargement";ne.error(`Erreur: ${t}`)}},d=(null==n?void 0:n.results)||n||[],c={total:d.length,validees:d.filter(e=>"validee"===e.etat).length,brouillons:d.filter(e=>"brouillon"===e.etat).length,totalBrut:d.reduce((e,t)=>e+parseFloat(t.montant_brut||0),0),totalNet:d.reduce((e,t)=>e+parseFloat(t.montant_net||0),0),totalSubvention:d.reduce((e,t)=>e+parseFloat(t.montant_subvention||0),0)};return a?S.jsx("div",{className:"loading",children:S.jsx("div",{className:"spinner"})}):S.jsxs("div",{className:"tableau-bord-cantine",children:[S.jsxs("div",{className:"breadcrumbs",children:[S.jsx("span",{children:"Accueil"}),S.jsx("span",{className:"breadcrumb-separator",children:""}),S.jsx("span",{children:"Restauration"}),S.jsx("span",{className:"breadcrumb-separator",children:""}),S.jsx("span",{className:"breadcrumb-current",children:"Tableau de Bord Cantine"})]}),S.jsxs("div",{className:"page-header",children:[S.jsx("h1",{children:" Tableau de Bord - Gestion Cantine"}),S.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center",flexWrap:"wrap"},children:[S.jsx("input",{type:"date",className:"form-input",value:t,onChange:e=>r(e.target.value),style:{width:"auto"}}),i?S.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[S.jsxs("span",{className:"badge badge-success",style:{fontSize:"0.9rem",padding:"0.5rem 1rem"},children:[" Facture: ",i.numero_facture]}),S.jsx("button",{onClick:l,className:"btn btn-primary",style:{padding:"0.75rem 1.5rem",fontSize:"1rem"},children:" Tlcharger & Imprimer PDF"})]}):S.jsx("button",{onClick:()=>{o.mutate(t)},className:"btn btn-primary",disabled:o.isLoading||0===d.length,style:{padding:"0.75rem 1.5rem",fontSize:"1rem"},children:o.isLoading?" Gnration...":" Gnrer la Facture"})]})]}),i&&S.jsxs("div",{className:"card",style:{marginBottom:"1.5rem",backgroundColor:"#e7f3ff",border:"2px solid #366092",padding:"1.5rem"},children:[S.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[S.jsxs("h2",{style:{color:"#366092",marginTop:0,display:"flex",alignItems:"center",gap:"0.5rem"},children:[" Facture du ",As(new Date(i.date_facture),"dd MMMM yyyy",{locale:Ds})]}),S.jsx("button",{onClick:l,className:"btn btn-primary",style:{padding:"0.75rem 1.5rem",fontSize:"1rem"},children:" Tlcharger & Imprimer PDF"})]}),S.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:"1rem",padding:"1rem",backgroundColor:"white",borderRadius:"8px",border:"1px solid #366092"},children:[S.jsxs("div",{style:{padding:"0.75rem",backgroundColor:"#f8f9fa",borderRadius:"6px"},children:[S.jsx("div",{style:{fontSize:"0.85rem",color:"#666",marginBottom:"0.25rem"},children:"Numro"}),S.jsx("div",{style:{fontSize:"1.1rem",fontWeight:"bold",color:"#366092"},children:i.numero_facture})]}),S.jsxs("div",{style:{padding:"0.75rem",backgroundColor:"#f8f9fa",borderRadius:"6px"},children:[S.jsx("div",{style:{fontSize:"0.85rem",color:"#666",marginBottom:"0.25rem"},children:"Commandes"}),S.jsx("div",{style:{fontSize:"1.1rem",fontWeight:"bold",color:"#366092"},children:i.total_commandes})]}),S.jsxs("div",{style:{padding:"0.75rem",backgroundColor:"#f8f9fa",borderRadius:"6px"},children:[S.jsx("div",{style:{fontSize:"0.85rem",color:"#666",marginBottom:"0.25rem"},children:"Total Brut"}),S.jsx("div",{style:{fontSize:"1.1rem",fontWeight:"bold",color:"#366092"},children:Ps(parseFloat(i.total_brut))})]}),S.jsxs("div",{style:{padding:"0.75rem",backgroundColor:"#f8f9fa",borderRadius:"6px"},children:[S.jsx("div",{style:{fontSize:"0.85rem",color:"#666",marginBottom:"0.25rem"},children:"Total Subvention"}),S.jsx("div",{style:{fontSize:"1.1rem",fontWeight:"bold",color:"#10b981"},children:Ps(parseFloat(i.total_subvention))})]}),S.jsxs("div",{style:{padding:"0.75rem",backgroundColor:"#f8f9fa",borderRadius:"6px"},children:[S.jsx("div",{style:{fontSize:"0.85rem",color:"#666",marginBottom:"0.25rem"},children:"Total Net"}),S.jsx("div",{style:{fontSize:"1.1rem",fontWeight:"bold",color:"#366092"},children:Ps(parseFloat(i.total_net))})]}),S.jsxs("div",{style:{padding:"0.75rem",backgroundColor:"#fff3cd",borderRadius:"6px",border:"1px solid #ffc107"},children:[S.jsx("div",{style:{fontSize:"0.85rem",color:"#856404",marginBottom:"0.25rem"},children:"Total Supplments"}),S.jsx("div",{style:{fontSize:"1.1rem",fontWeight:"bold",color:"#856404"},children:Ps(parseFloat(i.total_supplement))})]})]})]}),S.jsxs("div",{className:"stats-grid",style:{marginBottom:"2rem"},children:[S.jsxs("div",{className:"stat-card",style:{background:"linear-gradient(135deg, #366092 0%, #2d4f7a 100%)",borderLeft:"4px solid #1e3a5f"},children:[S.jsx("div",{className:"stat-label",children:"Total Commandes"}),S.jsx("div",{className:"stat-value",children:c.total})]}),S.jsxs("div",{className:"stat-card",style:{background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",borderLeft:"4px solid #047857"},children:[S.jsx("div",{className:"stat-label",children:"Valides"}),S.jsx("div",{className:"stat-value",children:c.validees})]}),S.jsxs("div",{className:"stat-card",style:{background:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",borderLeft:"4px solid #b45309"},children:[S.jsx("div",{className:"stat-label",children:"En Brouillon"}),S.jsx("div",{className:"stat-value",children:c.brouillons})]}),S.jsxs("div",{className:"stat-card",style:{background:"linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)",borderLeft:"4px solid #6d28d9"},children:[S.jsx("div",{className:"stat-label",children:"Total Brut"}),S.jsx("div",{className:"stat-value",children:Ps(c.totalBrut)})]}),S.jsxs("div",{className:"stat-card",style:{background:"linear-gradient(135deg, #3abff8 0%, #0ea5e9 100%)",borderLeft:"4px solid #0284c7"},children:[S.jsx("div",{className:"stat-label",children:"Total Subvention"}),S.jsx("div",{className:"stat-value",children:Ps(c.totalSubvention)})]}),S.jsxs("div",{className:"stat-card",style:{background:"linear-gradient(135deg, #ec4899 0%, #db2777 100%)",borderLeft:"4px solid #be185d"},children:[S.jsx("div",{className:"stat-label",children:"Total Net"}),S.jsx("div",{className:"stat-value",children:Ps(c.totalNet)})]})]}),S.jsxs("div",{className:"card",children:[S.jsxs("h2",{children:["Commandes du ",As(new Date(t),"dd MMMM yyyy",{locale:Ds})]}),d.length>0?S.jsxs("table",{className:"table",children:[S.jsx("thead",{children:S.jsxs("tr",{children:[S.jsx("th",{children:"Employ"}),S.jsx("th",{children:"Date"}),S.jsx("th",{children:"tat"}),S.jsx("th",{children:"Nb Plats"}),S.jsx("th",{children:"Montant Brut"}),S.jsx("th",{children:"Subvention"}),S.jsx("th",{children:"Montant Net"}),S.jsx("th",{children:"Dtails"})]})}),S.jsx("tbody",{children:d.map(e=>S.jsxs("tr",{children:[S.jsx("td",{children:S.jsx("strong",{children:e.utilisateur_username||"Anonyme"})}),S.jsx("td",{children:As(new Date(e.date_commande),"dd/MM/yyyy")}),S.jsx("td",{children:S.jsx("span",{className:"badge badge-"+("validee"===e.etat?"success":"brouillon"===e.etat?"warning":"secondary"),children:e.etat_display})}),S.jsx("td",{children:e.lignes?e.lignes.reduce((e,t)=>e+t.quantite,0):0}),S.jsx("td",{children:Ps(e.montant_brut)}),S.jsx("td",{children:Ps(e.montant_subvention)}),S.jsx("td",{children:S.jsx("strong",{children:Ps(e.montant_net)})}),S.jsx("td",{children:e.lignes&&e.lignes.length>0&&S.jsxs("details",{children:[S.jsx("summary",{style:{cursor:"pointer",color:"var(--primary-color)"},children:"Voir dtails"}),S.jsx("ul",{style:{marginTop:"0.5rem",paddingLeft:"1.5rem"},children:e.lignes.map(e=>{const t=e.prix_unitaire>3e4?e.prix_unitaire-3e4:0;return S.jsxs("li",{style:{marginBottom:"0.5rem"},children:[S.jsxs("div",{children:[S.jsx("strong",{children:e.plat_nom})," x",e.quantite," = ",Ps(e.montant_ligne)]}),t>0&&S.jsxs("div",{style:{marginTop:"0.25rem",padding:"0.25rem 0.5rem",backgroundColor:"#fff3cd",border:"1px solid #ffc107",borderRadius:"4px",fontSize:"0.85rem",color:"#856404",display:"inline-block"},children:[" Supplment  facturer: ",Ps(t)]})]},e.id)})})]})})]},e.id))})]}):S.jsx("p",{style:{textAlign:"center",padding:"2rem",color:"var(--text-secondary)"},children:"Aucune commande pour cette date."})]})]})},Zs=new f({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:1}}});function en(){return S.jsx(x,{client:Zs,children:S.jsx(d,{children:S.jsxs(Tr,{children:[S.jsxs(c,{children:[S.jsx(u,{path:"/login",element:S.jsx(Rr,{})}),S.jsxs(u,{path:"/",element:S.jsx(Ar,{}),children:[S.jsx(u,{index:!0,element:S.jsx(i,{to:"/dashboard",replace:!0})}),S.jsx(u,{path:"dashboard",element:S.jsx(Ls,{})}),S.jsx(u,{path:"operations",element:S.jsx(Is,{})}),S.jsx(u,{path:"previsions",element:S.jsx(Bs,{})}),S.jsx(u,{path:"imputations",element:S.jsx(qs,{})}),S.jsx(u,{path:"rapports",element:S.jsx(Fs,{})}),S.jsx(u,{path:"categories",element:S.jsx(Ws,{})}),S.jsx(u,{path:"utilisateurs",element:S.jsx(Vs,{})}),S.jsx(u,{path:"audit",element:S.jsx($s,{})}),S.jsx(u,{path:"restauration/plats",element:S.jsx(Hs,{})}),S.jsx(u,{path:"restauration/menus",element:S.jsx(Js,{})}),S.jsx(u,{path:"restauration/commandes",element:S.jsx(Gs,{})}),S.jsx(u,{path:"restauration/extras",element:S.jsx(Ys,{})}),S.jsx(u,{path:"tableau-bord-cantine",element:S.jsx(Ks,{})})]}),S.jsx(u,{path:"commander/:token",element:S.jsx(Xs,{})}),S.jsx(u,{path:"commander",element:S.jsx(Xs,{})})]}),S.jsx(G,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0})]})})})}E.createRoot(document.getElementById("root")).render(S.jsx(r.StrictMode,{children:S.jsx(en,{})}));
