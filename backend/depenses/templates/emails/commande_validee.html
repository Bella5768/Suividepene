<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Confirmation de Commande</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }
        .header {
            background-color: #007bff;
            color: white;
            padding: 20px;
            text-align: center;
            border-radius: 5px 5px 0 0;
        }
        .content {
            background-color: #f8f9fa;
            padding: 20px;
            border: 1px solid #dee2e6;
        }
        .success-badge {
            background-color: #28a745;
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            display: inline-block;
            margin: 10px 0;
            font-weight: bold;
        }
        .commande-details {
            background-color: white;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
        .commande-details table {
            width: 100%;
            border-collapse: collapse;
        }
        .commande-details th,
        .commande-details td {
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid #dee2e6;
        }
        .commande-details th {
            background-color: #f8f9fa;
            font-weight: bold;
        }
        .total {
            font-size: 1.2em;
            font-weight: bold;
            color: #007bff;
            margin-top: 10px;
        }
        .footer {
            text-align: center;
            padding: 20px;
            color: #666;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>CSIG - Confirmation de Commande</h1>
    </div>
    
    <div class="content">
        <p>Bonjour <strong>{{ nom_employe }}</strong>,</p>
        
        <p>Nous vous confirmons que votre commande de restauration a été <span class="success-badge">VALIDÉE</span> avec succès.</p>
        
        <div class="commande-details">
            <h3>Détails de votre commande</h3>
            <table>
                <tr>
                    <th>Date de commande</th>
                    <td>{{ date_commande }}</td>
                </tr>
                <tr>
                    <th>Numéro de commande</th>
                    <td>#{{ commande_id }}</td>
                </tr>
                <tr>
                    <th>Statut</th>
                    <td><strong>Validée</strong></td>
                </tr>
            </table>
            
            <h4 style="margin-top: 20px;">Plats commandés :</h4>
            <table>
                <thead>
                    <tr>
                        <th>Plat</th>
                        <th>Quantité</th>
                        {% if a_supplement %}
                        <th>Prix unitaire</th>
                        <th>Supplément (> 30 000 GNF)</th>
                        {% else %}
                        <th>Prix unitaire</th>
                        <th>Total</th>
                        {% endif %}
                    </tr>
                </thead>
                <tbody>
                    {% for ligne in lignes %}
                    <tr>
                        <td>{{ ligne.plat_nom }}</td>
                        <td>{{ ligne.quantite }}</td>
                        {% if ligne.depasse_30000 %}
                        <td>{{ ligne.prix_unitaire }} GNF</td>
                        <td><strong>{{ ligne.supplement }} GNF</strong></td>
                        {% else %}
                        <td>{{ ligne.prix_unitaire }} GNF</td>
                        <td>{{ ligne.montant_ligne }} GNF</td>
                        {% endif %}
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            
            <div class="total">
                {% if a_plats_simples and a_supplement %}
                {# Cas mixte : plats simples + plats avec supplément #}
                <p>Total plats (≤ 30 000 GNF) : {{ total_plats_simple }} GNF</p>
                <p>Total suppléments (> 30 000 GNF) : {{ total_supplement }} GNF</p>
                <p style="color: #28a745; font-size: 1.3em; margin-top: 10px;">
                    <strong>Total Net à payer : {{ montant_net_a_payer }} GNF</strong>
                </p>
                {% elif a_supplement %}
                {# Seulement des plats avec supplément #}
                <p style="color: #28a745; font-size: 1.3em;">
                    <strong>Total Net à payer : {{ montant_net_a_payer }} GNF</strong>
                </p>
                <p style="font-size: 0.9em; color: #666; margin-top: 5px;">
                    (Supplément pour plat dépassant 30 000 GNF)
                </p>
                {% else %}
                {# Seulement des plats simples (≤ 30 000 GNF) - Pas de "net à payer" #}
                <p style="color: #28a745; font-size: 1.1em; margin-top: 10px;">
                    <strong>Votre commande est prise en charge par l'établissement.</strong>
                </p>
                {% endif %}
            </div>
        </div>
        
        <p style="margin-top: 20px;">
            <strong>Important :</strong> Votre commande a été enregistrée et sera préparée pour le {{ date_commande }}.
        </p>
        
        {% if a_supplement %}
        <p style="background-color: #e7f3ff; padding: 10px; border-radius: 5px; border-left: 4px solid #007bff; margin-top: 15px;">
            <strong>Information :</strong> Pour les plats depassant 30 000 GNF, seul le supplement (montant au-dela de 30 000 GNF) est facture. Le montant de base (30 000 GNF) est pris en charge par l'etablissement.
        </p>
        {% endif %}
        
        <p>Merci de votre confiance !</p>
        
        <p>Cordialement,<br>
        <strong>L'équipe CSIG</strong></p>
    </div>
    
    <div class="footer">
        <p>Cet email a été envoyé automatiquement. Merci de ne pas y répondre.</p>
        <p>Cité des Sciences et de l'Innovation</p>
    </div>
</body>
</html>

